<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
     <head>
         <title>XAP 8.0 Documentation : The GigaSpaces Agent</title>
<link rel="stylesheet" href="styles/site.css" type="text/css" />
         <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
		 <style>
.back-to {
	color: #666666;
	font-weight: bold;
}	 
a.back-to:link, a.back-to:visited, a.back-to:hover, a.back-to:active  {
	color: #666666;
}	 
		 </style>
     </head>

     <body>
<table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
<tr>
<td valign="top" class="pagebody">
<div class="pageheader">
<span class="back-to">XAP 8.0 Documentation > <a href="index.html">Back to Table of Contents</a></span><br>
<h1>The GigaSpaces Agent</h1>
</div>
<br>

<script type='text/javascript'>//<![CDATA[
function debug() { }
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/browser.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/behaviour.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/memory.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/cloak.js'>//<![CDATA[
// ]]></script><script type='text/javascript'>//<![CDATA[
Cloak.closeHTML = "<img src=\'/wiki/download/resources/net.customware.confluence.plugin.composition:toggle-cloak/img/navigate_down_10.gif\'/>";
Cloak.openHTML = "<img src=\'/wiki/download/resources/net.customware.confluence.plugin.composition:toggle-cloak/img/navigate_right_10.gif\'/>";
Cloak.toggleZone = true;
Cloak.memoryDuration = 0;
Cloak.memoryPrefix = "contentId:53903650";
Cloak.memoryPath = "/wiki/";
// ]]></script><style type='text/css'>
.cloakToggle { /* Definition for state toggling image */
cursor:hand;
cursor:pointer;
}
</style><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/transitions.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/deck.js'>//<![CDATA[
// ]]></script><link rel='stylesheet' type='text/css'  href='/wiki/styles/main-action.css?pluginCompleteKey=net.customware.confluence.plugin.composition:composition-setup&stylesheetName=deck&spaceKey=XAP8'/><script type='text/javascript'>//<![CDATA[
Deck.memoryDuration = 0;
Deck.memoryPrefix = "contentId:53903650";
Deck.memoryPath = "/wiki/";
// ]]></script>


<div style="border-style:solid; border-color:#3C78B5; border-width:thin; padding-left:20px; padding-bottom:20px; padding-top:20px; padding-right:20px; background-color:#D8E4F1"> 

<p><b>Section Summary:</b>  A process manager that manages Service Grid processes such as GSM, GSC and LUS </p>
</div>

<h1><a name="TheGigaSpacesAgent-Overview"></a>Overview</h1>

<p>The GigaSpaces Agent (GSA) acts as a process manager that can spawn and manage Service Grid processes (Operating System level processes) such as <a href="The GigaSpaces Manager.html" title="The GigaSpaces Manager">The GigaSpaces Manager</a>, <a href="The GigaSpaces Container.html" title="The GigaSpaces Container">The GigaSpaces Container</a>, and <a href="The Lookup Service.html" title="The Lookup Service">The Lookup Service</a>.</p>

<p>Usually, a single GSA is run per machine (on a lookup group or lookup locator level, see more in  <a href="The Lookup Service.html" title="The Lookup Service">The Lookup Service</a>). The GSA allows to spawn a <a href="The GigaSpaces Manager.html" title="The GigaSpaces Manager">GigaSpaces Manager</a>, <a href="The GigaSpaces Container.html" title="The GigaSpaces Container">GigaSpaces Container</a>, <a href="The Lookup Service.html" title="The Lookup Service">Lookup Service</a>, and custom processes. Once spawned, the GSA assigns a unique id for it and manages its lifecycle. The GSA will restart the process if it exits, or if a specific console output has been encountered (for example, OutOfMemoryError).</p>

<p>The GSA exposes the ability to start, restart, and kill a process either using the <a href="Administration and Monitoring API.html" title="Administration and Monitoring API">Administration and Monitoring API</a> or the GigaSpaces UI.</p>

<p><img class="emoticon" src="images/icons/emoticons/lightbulb_on.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> Although <a href="The GigaSpaces Manager.html" title="The GigaSpaces Manager">The GigaSpaces Manager</a>, <a href="The GigaSpaces Container.html" title="The GigaSpaces Container">The GigaSpaces Container</a>, and <a href="The Lookup Service.html" title="The Lookup Service">The Lookup Service</a> can be started on their own using their respective scripts, it is preferable that they will be started using the GSA thus allowing to easily monitor and manage them.</p>

<h1><a name="TheGigaSpacesAgent-ProcessManagement"></a>Process Management</h1>

<p>The GSA manages Operating System processes. There are two types of process management, local and global.</p>

<p>Local processes simply start the process type (for example, a <a href="The GigaSpaces Container.html" title="The GigaSpaces Container">GigaSpaces Container</a>) without taking into account any other process types running by different GSAs.</p>

<p>Global processes take into account the number of process types (<a href="The GigaSpaces Manager.html" title="The GigaSpaces Manager">GigaSpaces Manager</a> for example) that are currently running by other GSAs (within the same lookup groups or lookup locators). It will automatically try and run at least X number of processes <b>across</b> all the different GSAs (with a maximum of 1 process type per GSA). If a GSA running a process type that is managed globally fails, another GSA will identify the failure and start it in order to maintain at least X number of global process types.</p>

<h1><a name="TheGigaSpacesAgent-StartingtheGSA"></a>Starting the GSA</h1>

<p>In order to start the GSA, the <tt>&lt;GSHOME&gt;/bin/gs-agent.(sh/bat)</tt> can be used. The GSA, by default, will start 2 local <a href="The GigaSpaces Container.html" title="The GigaSpaces Container">GigaSpaces Container</a>s, and manage 2 global <a href="The GigaSpaces Manager.html" title="The GigaSpaces Manager">GigaSpaces Manager</a>s and 2 global <a href="The Lookup Service.html" title="The Lookup Service">Lookup Service</a>s.</p>

<h1><a name="TheGigaSpacesAgent-ConfiguringtheGSA"></a>Configuring the GSA</h1>

<p>JVM parameters (system properties, heap settings etc.) that are shared between all components are best set using the <tt>EXT_JAVA_OPTIONS</tt> environment variable. However, starting from 7.1.1, specific GSA JVM parameters can be easily passed using <tt>GSA_JAVA_OPTIONS</tt> that will be appended to <tt>EXT_JAVA_OPTIONS</tt>. If <tt>GSA_JAVA_OPTIONS</tt> is not defined, the system will behave as in 7.1.0. As a good practice, one can add all components' environment variables ( <tt>GSA_JAVA_OPTIONS</tt>, <tt>GSM_JAVA_OPTIONS</tt>, <tt>GSC_JAVA_OPTIONS</tt>, <tt>LUS_JAVA_OPTIONS</tt>) within the GSA script, or in a wrapper script and the values will be passed to corresponding components.</p>


<div class="panel" style="background-color: #FFFFFF;border-color: #3C78B5;border-style: solid;border-width: 1px;"><div class="panelContent" style="background-color: #FFFFFF;">
<h5><a name="TheGigaSpacesAgent-Linux"></a>Linux</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">#Wrapper Script
export GSA_JAVA_OPTIONS=-Xmx256m
export GSC_JAVA_OPTIONS=-Xmx2048m
export GSM_JAVA_OPTIONS=-Xmx1024m
export LUS_JAVA_OPTIONS=-Xmx1024m


#call gs-agent.sh
. ./gs-agent.sh</pre>
</div></div>



<h5><a name="TheGigaSpacesAgent-Windows"></a>Windows</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">@rem Wrapper Script
@set GSA_JAVA_OPTIONS=-Xmx256m
@set GSC_JAVA_OPTIONS=-Xmx2048m
@set GSM_JAVA_OPTIONS=-Xmx1024m
@set LUS_JAVA_OPTIONS=-Xmx1024m

@rem call gs-agent.bat
call gs-agent.bat</pre>
</div></div>
</div></div>



<h1><a name="TheGigaSpacesAgent-GSAScriptParameters"></a>GSA Script Parameters</h1>

<p>GSA parameters include controlling how many local process the GSA will spawn on startup (per process type), and the number of globally managed process the GSA will maintain (in cooperation with other GSAs) (per process type).</p>

<p>By default, the GSA is started with 2 local <a href="The GigaSpaces Container.html" title="The GigaSpaces Container">GigaSpaces Container</a>s, and manage 2 global <a href="The GigaSpaces Manager.html" title="The GigaSpaces Manager">GigaSpaces Manager</a> and 2 global <a href="The Lookup Service.html" title="The Lookup Service">Lookup Service</a>. This is the equivalent of starting the GSA with the following parameters:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">gs-agent.(sh/bat) gsa.gsc 2 gsa.global.gsm 2 gsa.global.lus 2</pre>
</div></div>

<p>In order to, for example, start 3 local GSCs, 2 global GSMs, and no global LUS, the following command can be used:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">gs-agent.(sh/bat) gsa.gsc 3 gsa.global.gsm 2 gsa.global.lus 0</pre>
</div></div>

<p>In general, the <tt>gsa.[process type]</tt> followed by a number controls the number of local processes of the specific process type that will be spawned by the GSA. The <tt>gsa.global.[process type]</tt> following by a number controls the number of globally managed processes of the specific process type.</p>

<h1><a name="TheGigaSpacesAgent-ProcessTypeConfiguration"></a>Process Type Configuration</h1>

<p>GSA manages different process types. Each process type is defined within the <tt>&lt;GSHOME&gt;\config\gsa</tt> directory in an xml file that identifies the process type by its name. </p>
<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>You can change the default location of the GSA configuration files using the <tt>com.gigaspaces.grid.gsa.config-directory</tt> system property.</td></tr></table></div>
<p>The following are the process types that come out of the box:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>Processes Type</th>
<th class='confluenceTh'>Description</th>
<th class='confluenceTh'>XML config file name</th>
<th class='confluenceTh'>Properties file name</th>
</tr>
<tr>
<td class='confluenceTd'>gsc</td>
<td class='confluenceTd'>Defines a <a href="The GigaSpaces Container.html" title="The GigaSpaces Container">GigaSpaces Container</a></td>
<td class='confluenceTd'>gsc.xml</td>
<td class='confluenceTd'>gsc.properties</td>
</tr>
<tr>
<td class='confluenceTd'>gsm</td>
<td class='confluenceTd'>Defines a <a href="The GigaSpaces Manager.html" title="The GigaSpaces Manager">GigaSpaces Manager</a></td>
<td class='confluenceTd'>gsm.xml</td>
<td class='confluenceTd'>gsm.properties</td>
</tr>
<tr>
<td class='confluenceTd'>lus</td>
<td class='confluenceTd'>Defines a <a href="The Lookup Service.html" title="The Lookup Service">Lookup Service</a></td>
<td class='confluenceTd'> lus.xml</td>
<td class='confluenceTd'>lus.properties</td>
</tr>
<tr>
<td class='confluenceTd'>gsm_lus</td>
<td class='confluenceTd'>Defines a <a href="The GigaSpaces Manager.html" title="The GigaSpaces Manager">GigaSpaces Manager</a> and <a href="The Lookup Service.html" title="The Lookup Service">Lookup Service</a> within the same JVM</td>
<td class='confluenceTd'>gsm_lus.xml</td>
<td class='confluenceTd'>gsm_lus.properties</td>
</tr>
</tbody></table>

<p>Here is an example of the gsc xml configuration file:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag">&lt;process initial-instances=<span class="code-quote">"script"</span>&gt;</span>
    &lt;script enable=<span class="code-quote">"true"</span> work-dir=<span class="code-quote">"${com.gs.home}/bin"</span>
            windows=<span class="code-quote">"${com.gs.home}/bin/gsc.bat"</span> unix=<span class="code-quote">"${com.gs.home}/bin/gsc.sh"</span>&gt;
        <span class="code-tag">&lt;argument&gt;</span><span class="code-tag">&lt;/argument&gt;</span>
    <span class="code-tag">&lt;/script&gt;</span>
    <span class="code-tag">&lt;vm enable=<span class="code-quote">"true"</span> work-dir=<span class="code-quote">"${com.gs.home}/bin"</span> main-class=<span class="code-quote">"com.gigaspaces.start.SystemBoot"</span>&gt;</span>
        <span class="code-tag">&lt;input-argument&gt;</span><span class="code-tag">&lt;/input-argument&gt;</span>
        <span class="code-tag">&lt;argument&gt;</span>com.gigaspaces.start.services=<span class="code-quote">"GSC"</span><span class="code-tag">&lt;/argument&gt;</span>
    <span class="code-tag">&lt;/vm&gt;</span>
    <span class="code-tag">&lt;restart-regex&gt;</span>.*OutOfMemoryError.*<span class="code-tag">&lt;/restart-regex&gt;</span>
<span class="code-tag">&lt;/process&gt;</span></pre>
</div></div> 

<p>The GSA can either spawn a script based process, or a pure JVM (with its arguments) process. The GSC for example, allows for both types of process spawning.</p>

<ul class="alternate" type="square">
	<li>The <tt>initial-instnaces</tt> parameter controls what type of spawning will be performed when the GSA spawns processes by itself (and not on demand by the Admin API).</li>
	<li>The <tt>restart-regex</tt> (there can be more than one element) is applied to each console output line of the managed process, and if there is a match, the GSA will automatically restart the process. By default, the GSC will be restarted if there is an <tt>OutOfMemoryError</tt>.</li>
</ul>


<h1><a name="TheGigaSpacesAgent-LookupServiceConsiderations"></a>Lookup Service Considerations</h1>

<p>When starting a <a href="The Lookup Service.html" title="The Lookup Service">Lookup Service</a> and other services in unicast mode (not multicast), it means that specific machines will be the ones that will run the <a href="The Lookup Service.html" title="The Lookup Service">Lookup Service</a>. This means that on the machines running the LUS, the following command will be used (assuming other defaults are used for GSM and GSC):</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">gs-agent.(sh/bat) gsa.global.lus 0 gsa.lus 1</pre>
</div></div>

<p>And machines that will not run the LUS, the following command should be used:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">gs-agent.(sh/bat) gsa.global.lus 0</pre>
</div></div>

                     </td>
</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td height="12" background="http://www.gigaspaces.com/wiki/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
</tr>
<tr>
<td align="center"><font color="grey"><a href="http://www.gigaspaces.com">GigaSpaces.com</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xwBmAg" class="smalltext">Legal Notice</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xgBmAg" class="smalltext">3rd Party Licenses</a> -
		<a href="http://www.gigaspaces.com/wiki/x/BQFmAg" class="smalltext">Site Map</a> -
		<a href="http://www.gigaspaces.com/wiki/display/API/API+Documentation+Portal" class="version-link">API Docs</a> -
		<a href="http://forum.openspaces.org/forum.jspa?forumID=175" class="version-link">Forum</a> -
		<a href="http://www.gigaspaces.com/LatestProductVersion" class="version-link">Downloads</a> -
		<a href="http://blog.gigaspaces.com/" class="version-link">Blog</a> -
		<a href="http://www.gigaspaces.com/os_papers.html" class="version-link">White Papers</a> -
		<a href="mailto:techw@gigaspaces.com">Contact Tech Writing</a> -
		<i><a href="http://www.atlassian.com/software/confluence">Gen. by Atlassian Confluence</a></i></font></td>
</tr>
</table>
     </body>
</html>
