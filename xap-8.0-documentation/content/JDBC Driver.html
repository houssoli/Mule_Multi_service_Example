<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
     <head>
         <title>XAP 8.0 Documentation : JDBC Driver</title>
<link rel="stylesheet" href="styles/site.css" type="text/css" />
         <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
		 <style>
.back-to {
	color: #666666;
	font-weight: bold;
}	 
a.back-to:link, a.back-to:visited, a.back-to:hover, a.back-to:active  {
	color: #666666;
}	 
		 </style>
     </head>

     <body>
<table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
<tr>
<td valign="top" class="pagebody">
<div class="pageheader">
<span class="back-to">XAP 8.0 Documentation > <a href="index.html">Back to Table of Contents</a></span><br>
<h1>JDBC Driver</h1>
</div>
<br>

<script type='text/javascript'>//<![CDATA[
function debug() { }
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/browser.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/behaviour.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/memory.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/cloak.js'>//<![CDATA[
// ]]></script><script type='text/javascript'>//<![CDATA[
Cloak.closeHTML = "<img src=\'/wiki/download/resources/net.customware.confluence.plugin.composition:toggle-cloak/img/navigate_down_10.gif\'/>";
Cloak.openHTML = "<img src=\'/wiki/download/resources/net.customware.confluence.plugin.composition:toggle-cloak/img/navigate_right_10.gif\'/>";
Cloak.toggleZone = true;
Cloak.memoryDuration = 0;
Cloak.memoryPrefix = "contentId:53903714";
Cloak.memoryPath = "/wiki/";
// ]]></script><style type='text/css'>
.cloakToggle { /* Definition for state toggling image */
cursor:hand;
cursor:pointer;
}
</style><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/transitions.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/deck.js'>//<![CDATA[
// ]]></script><link rel='stylesheet' type='text/css'  href='/wiki/styles/main-action.css?pluginCompleteKey=net.customware.confluence.plugin.composition:composition-setup&stylesheetName=deck&spaceKey=XAP8'/><script type='text/javascript'>//<![CDATA[
Deck.memoryDuration = 0;
Deck.memoryPrefix = "contentId:53903714";
Deck.memoryPath = "/wiki/";
// ]]></script>

<div style="border-style:solid; border-color:#3C78B5; border-width:thin; padding-left:20px; padding-bottom:20px; padding-top:20px; padding-right:20px; background-color:#D8E4F1"> 

<p><b>Section Summary:</b>  GigaSpaces allows applications to connect to the IMDG using a JDBC driver. A GigaSpaces JDBC driver accepts SQL statements, translates them to space operations, and returns standard result sets.  </p>
</div>

<h1><a name="JDBCDriver-Overview"></a>Overview</h1>
<p>The GigaSpaces JDBC interface allows database-driven applications to interact with spaces via SQL queries and commands. A query processor transparently translates SQL queries into legal space operations. No integration is required - all you need to do is point the application to the GigaSpaces JDBC driver like any other JDBC driver.</p>

<p>Applications can access the GigaSpaces Data Grid using the JDBC API; data written to the IMDG using the JDBC API can also be accessed using other APIs. </p>

<div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>An alternative way of querying the space using SQL syntax is the <a href="SQLQuery.html" title="SQLQuery">SQLQuery</a> class. This class allows you to perform SQL queries directly against space objects, without adding O/R mapping complexity.</td></tr></table></div>

<p>JDBC support in GigaSpaces is centered around the Space-Based Architecture - its main motivation is to enable more sophisticated querying of the space, beyond the template matching provided by the <a href="The GigaSpace Interface.html" title="The GigaSpace Interface">The GigaSpace Interface</a>.</p>

<p>GigaSpaces is not a full-fledged relational database and it does not support the full SQL92 standard (see <a href="#JDBCDriver-SupportedFeatures">JDBC Supported Features</a>). However, the existing SQL support is extremely useful for applications that need to execute queries on a space for real-time queries.</p>

<h2><a name="JDBCDriver-UsingExistingSQLCodeandPortingtoExternalSystems"></a>Using Existing SQL Code and Porting to External Systems</h2>
<p>The JDBC interface is mostly used to enable access to the space through standard SQL tools and programming interfaces. You can write SQL commands against the space, and the same code will in many (simple) cases be compatible with other SQL implementations.</p>

<p>Porting existing JDBC code to the space is certainly doable (but would require some level of adaptation depending on the specifics of the case and the complexity of the SQL queries. For legacy applications, it may still be easier than porting existing code to leverage the space technology directly. Since the SQL support is limited, this path should be taken with caution, and would normally require close support from GigaSpaces.</p>

<h1><a name="JDBCDriver-GettingtheGigaSpacesJDBCconnection"></a>Getting the GigaSpaces JDBC connection </h1>
<p>In order to get the GigaSpaces JDBC connection you should use the following JDBC Driver classname:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java"><span class="code-object">Class</span>.forName(<span class="code-quote">"com.j_spaces.jdbc.driver.GDriver"</span>);</pre>
</div></div>

<p>The connection URL should include :<tt>jdbc:gigaspaces:url:&lt;Space URL&gt;</tt> &#8211; e.g.:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">Connection con = DriverManager.getConnection(<span class="code-quote">"jdbc:gigaspaces:url:jini:<span class="code-comment">//*/*/mySpace"</span>);</span></pre>
</div></div>

<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>You may use the GigaSpaces JDBC driver with remote or embedded space</td></tr></table></div>

<p><img src="download/attachments/19890517/referto.gif" align="absmiddle" border="0"/> For more details on the Space URL, refer to the <a href="Space URL.html" title="Space URL">Space URL</a> section.</p>

<p>Example:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">Connection conn;
<span class="code-object">Class</span>.forName(<span class="code-quote">"com.j_spaces.jdbc.driver.GDriver"</span>).newInstance();
<span class="code-object">String</span> url = <span class="code-quote">"jdbc:gigaspaces:url:jini:<span class="code-comment">//*/*/mySpace"</span>;
</span>conn = DriverManager.getConnection(url);
Statement st = conn.createStatement();
<span class="code-object">String</span> createTable = <span class="code-quote">"CREATE TABLE COFFEES (COF_NAME VARCHAR(32),SUP_ID INTEGER, "</span> + 
                     <span class="code-quote">"PRICE FLOAT,SALES INTEGER,TOTAL INTEGER)"</span>;
st.executeUpdate(createTable);

<span class="code-object">String</span> query = <span class="code-quote">"SELECT COF_NAME, PRICE FROM COFFEES"</span>;
st = conn.createStatement();
ResultSet rs = st.executeQuery(query);
<span class="code-keyword">while</span> (rs.next()) {
	<span class="code-object">String</span> s = rs.getString(<span class="code-quote">"COF_NAME"</span>);
	<span class="code-object">float</span> n = rs.getFloat(<span class="code-quote">"PRICE"</span>);
	<span class="code-object">System</span>.out.println(s + <span class="code-quote">"   "</span> + n);
}</pre>
</div></div>

<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>There is no need to deal with JDBC connection polling when using GigaSpaces JDBC driver.</td></tr></table></div> 

<h3><a name="JDBCDriver-EmbeddingtheQueryProcessorwithintheapplication"></a>Embedding the Query Processor within the application</h3>
<p>By default, the Query Processor is running server side.<br/>
It is possible to set the Query Processor to run embedded within the application by passing a parameter to the JDBC driver:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java"><span class="code-object">Class</span>.forName(<span class="code-quote">"com.j_spaces.jdbc.driver.GDriver"</span>).newInstance();
<span class="code-object">String</span> url = <span class="code-quote">"jdbc:gigaspaces:url:jini:<span class="code-comment">//*/*/mySpace"</span>;
</span>Properties properties = <span class="code-keyword">new</span> Properties();
properties.put(<span class="code-quote">"com.gs.embeddedQP.enabled"</span>, <span class="code-quote">"<span class="code-keyword">true</span>"</span>);
conn = DriverManager.getConnection(url, properties);</pre>
</div></div>
<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>It is also possible to set the "com.gs.embeddedQP.enabled" connection property as a System property (connection property overrides the system property).</td></tr></table></div>

<h1><a name="JDBCDriver-TransactionSupport"></a>Transaction Support</h1>
<p>GigaSpaces JDBC Driver supports the following transaction managers:</p>
<ul>
	<li>Local Transaction Manager</li>
	<li>Distributed embedded Jini Transaction Manager (default)</li>
	<li>Lookup Distributed Transaction Manager</li>
</ul>


<p>The transaction manager type can be configured via JDBC's connection properties (there are additional properties for lookup distributed tx manager):</p>

<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>Property</th>
<th class='confluenceTh'>Description</th>
</tr>
<tr>
<td class='confluenceTd'> <tt>gs.tx_manager_type</tt> </td>
<td class='confluenceTd'> <tt>Transaction manager type: "local"/"distributed"/"lookup_distributed"</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>gs.lookup_tx.name</tt> </td>
<td class='confluenceTd'> <tt>Lookup service name</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>gs.lookup_tx.timeout</tt> </td>
<td class='confluenceTd'> <tt>Lookup timeout (default=3000)</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>gs.lookup_tx.groups</tt> </td>
<td class='confluenceTd'> <tt>Lookup groups</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>gs.lookup_tx.locators</tt> </td>
<td class='confluenceTd'> <tt>Lookup locators</tt> </td>
</tr>
</tbody></table>

<p>Transaction Manager Type Configuration Example:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java"><span class="code-object">Class</span>.forName(<span class="code-quote">"com.j_spaces.jdbc.driver.GDriver"</span>);	
Properties props = <span class="code-keyword">new</span> Properties();
props.put(<span class="code-quote">"gs.tx_manager_type"</span>, <span class="code-quote">"distributed"</span>);
Connection conn = DriverManager.getConnection(<span class="code-quote">"jdbc:gigaspaces:url:jini:<span class="code-comment">//*/*/mySpace"</span>, props);</span></pre>
</div></div>

<h1><a name="JDBCDriver-GettingJDBCconnectionfromaSpaceProxy"></a>Getting JDBC connection from a Space Proxy</h1>
<p>You can get a GigaSpaces JDBC connection from a space proxy using the <tt>com.j_spaces.jdbc.driver.GConnection</tt>. See below example:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">IJSpace gsSpaceProxy;  <span class="code-comment">//your space proxy. You can get it using GigaSpace.getSpace()
</span>GConnection connection = GConnection.getInstance(gsSpaceProxy); 
connection.setUseSingleSpace(<span class="code-keyword">true</span>); <span class="code-comment">//<span class="code-keyword">false</span> = cluster, <span class="code-keyword">true</span>=single</span></pre>
</div></div>

<p>The <tt>setUseSingleSpace</tt> method allows you to get a JDBC connection that encapsulates a clustered proxy or to an embedded space proxy. </p>

<p>You can also use the following <tt>GConnection</tt> method to set the user and password for a secured space:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java"><span class="code-keyword">public</span> <span class="code-keyword">static</span> Connection getInstance(IJSpace space, <span class="code-object">String</span> username, <span class="code-object">String</span> password) 
    <span class="code-keyword">throws</span> SQLException</pre>
</div></div>

<h1><a name="JDBCDriver-MixingSpaceAPIwiththeJDBCAPI"></a>Mixing Space API with the JDBC API</h1>
<p>The following example using the Space API <a href="Task Execution over the Space.html" title="Task Execution over the Space">DistributedTask</a> with the JDBC API. With this example we use map/reduce approach to query the space using the JDBC API, but we send the JDBC query to be executed within the space. This approach scales very well once the space have multiple partitions avoiding the need to retrieve the actual space objects from the space to evaluate the query. Retrieving objects from the space involved network latency and serialization overhead.</p>

<p>With the example below we execute the following query:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">Select FIELD from CLASS group by FIELD sort by FIELD</pre>
</div></div>

<p>The query is executed in two phases:<br/>
1. A <tt>DistributedTask</tt> is sent to each partition to execute the following JDBC query:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">Select FIELD from CLASS group by FIELD</pre>
</div></div>
<p>The result is then sent into the reducer running at the client side.<br/>
2. The <tt>DistributedTask.reduce</tt> method running at the client side aggregating the results from all the partitions and sort the final set.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeHeader panelHeader" style="border-bottom-width: 1px;"><b>The DistributedTask implementation</b></div><div class="codeContent panelContent">
<pre class="code-java"><span class="code-keyword">public</span> class JDBCTask <span class="code-keyword">implements</span> DistributedTask&lt;<span class="code-object">String</span>[], <span class="code-object">String</span>[]&gt;{

	<span class="code-keyword">public</span> JDBCTask(<span class="code-object">String</span> queryStr){		
		<span class="code-keyword">this</span>.queryStr=queryStr;
	}
	
	@TaskGigaSpace
	<span class="code-keyword">transient</span> GigaSpace gigaspace;	
	<span class="code-keyword">transient</span> Statement stmt;
	<span class="code-keyword">transient</span> PreparedStatement perstmt;
	<span class="code-keyword">transient</span> Connection con;
	<span class="code-object">String</span> queryStr;
	
	<span class="code-keyword">public</span> <span class="code-object">String</span>[] execute() <span class="code-keyword">throws</span> Exception{

		Connection con = getConnection();
		stmt = con.createStatement();
		ArrayList&lt;<span class="code-object">String</span>&gt; result = <span class="code-keyword">new</span> ArrayList&lt;<span class="code-object">String</span>&gt; ();
		ResultSet rs =stmt.executeQuery(queryStr);
		<span class="code-keyword">while</span> (rs.next()) {
			result.add(rs.getString(1));
		}
		stmt.close();
		con.close();
		<span class="code-object">String</span> resultArr [] = <span class="code-keyword">new</span> <span class="code-object">String</span>[result.size()] ;			
		resultArr = result.toArray(resultArr);
		<span class="code-keyword">return</span> resultArr; 
	}

	<span class="code-keyword">public</span> <span class="code-object">String</span>[] reduce(List&lt;AsyncResult&lt;<span class="code-object">String</span>[]&gt;&gt; results) <span class="code-keyword">throws</span> Exception {
		Iterator&lt;AsyncResult&lt;<span class="code-object">String</span>[]&gt;&gt; iter = results.iterator();
		<span class="code-object">String</span>[] result_ = <span class="code-keyword">null</span>;
		HashSet&lt;<span class="code-object">String</span>&gt; result = <span class="code-keyword">new</span> HashSet&lt;<span class="code-object">String</span>&gt;(); 
		<span class="code-keyword">while</span> (iter.hasNext())
		{
			result_ = iter.next().getResult();
			<span class="code-keyword">for</span> (<span class="code-object">int</span> i=0;i&lt;result_.length;i++)
			{
				result.add(result_[i])	;
			}
			
		}
		
		<span class="code-object">String</span>[] fullResult = <span class="code-keyword">new</span> <span class="code-object">String</span>[result.size()];
		fullResult = result.toArray(fullResult);
		Arrays.sort(fullResult);
		<span class="code-keyword">return</span> fullResult;
	}

	<span class="code-keyword">public</span> Connection getConnection()
	{
		GConnection connection = <span class="code-keyword">null</span>;
		<span class="code-keyword">try</span> {
			<span class="code-object">Class</span>.forName(<span class="code-quote">"com.j_spaces.jdbc.driver.GDriver"</span>);	

		} <span class="code-keyword">catch</span>(java.lang.ClassNotFoundException e) {
			<span class="code-object">System</span>.err.print(<span class="code-quote">"ClassNotFoundException: "</span>);
			<span class="code-object">System</span>.err.println(e.getMessage());
		}

		<span class="code-keyword">try</span> {
			connection = GConnection.getInstance(gigaspace.getSpace()); 
			connection.setUseSingleSpace(<span class="code-keyword">true</span>); <span class="code-comment">//<span class="code-keyword">false</span> = cluster, <span class="code-keyword">true</span>=single
</span>			
		} <span class="code-keyword">catch</span>(SQLException ex) {
			<span class="code-object">System</span>.err.println(<span class="code-quote">"SQLException: "</span> + ex.getMessage());
		}
		
		<span class="code-keyword">return</span> connection;
	}
}</pre>
</div></div>

<div class="code panel" style="border-width: 1px;"><div class="codeHeader panelHeader" style="border-bottom-width: 1px;"><b>The Client application</b></div><div class="codeContent panelContent">
<pre class="code-java">GigaSpace gigapace = 
	<span class="code-keyword">new</span> GigaSpaceConfigurer(
		<span class="code-keyword">new</span> UrlSpaceConfigurer (<span class="code-quote">"jini:<span class="code-comment">//*/*/mySpace"</span>)).gigaSpace();
</span>AsyncFuture&lt;<span class="code-object">String</span>[]&gt; result= 
	gigapace.execute(<span class="code-keyword">new</span> JDBCTask(<span class="code-quote">"select str from "</span> + 
		MyClass.class.getName() + <span class="code-quote">" group by str"</span>));
<span class="code-object">String</span>[] result_str = result.get();
<span class="code-object">System</span>.out.println(<span class="code-quote">"The Result:"</span> + Arrays.asList(result_str));</pre>
</div></div>

<h1><a name="JDBCDriver-SQLtoJavaTypeMapping"></a>SQL to Java Type Mapping</h1>
<p>The GigaSpaces JDBC Driver translates in runtime a Space object into a relational table representation.</p>
<ul>
	<li>All Java class attributes are translated into their corresponding SQL types.</li>
	<li>Class names are translated into table names.</li>
	<li>Field names are translated into column names.</li>
	<li>Indexed columns are translated into indexed fields. Make sure the <tt>btree</tt> index is turned on allowing fast processing of bigger than/less than queries. For more details, refer to the <a href="Indexing.html#Indexing-ExtendedIndexing">Indexing</a> section.</li>
</ul>


<p>The following information represents the SQL to Java mapping conducted at runtime when a table is created via the JDBC driver. </p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>SQL Type</th>
<th class='confluenceTh'>Java Type</th>
</tr>
<tr>
<td class='confluenceTd'> <tt>VARCHAR, VARCHAR2</tt> </td>
<td class='confluenceTd'> <tt>java.lang.String</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>CHAR</tt> </td>
<td class='confluenceTd'> <tt>java.lang.String</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>DATE</tt> </td>
<td class='confluenceTd'> <tt>java.sql.Date</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>DATE</tt> </td>
<td class='confluenceTd'> <tt>java.sql.Timestamp</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>TIME</tt> </td>
<td class='confluenceTd'> <tt>java.sql.Time</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>FLOAT</tt> </td>
<td class='confluenceTd'> <tt>java.lang.Float</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>REAL</tt> </td>
<td class='confluenceTd'> <tt>java.lang.Float</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>NUMERIC</tt> </td>
<td class='confluenceTd'> <tt>java.math.BigDecimal</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>DECIMAL</tt> </td>
<td class='confluenceTd'> <tt>java.math.BigDecimal</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>DOUBLE</tt> </td>
<td class='confluenceTd'> <tt>java.lang.Double</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>BOOLEAN</tt> </td>
<td class='confluenceTd'> <tt>java.lang.Boolean</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>INTEGER</tt> </td>
<td class='confluenceTd'> <tt>java.lang.Integer</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>TIMESTAMP</tt> </td>
<td class='confluenceTd'> <tt>java.sql.Timestamp</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>LONG</tt> </td>
<td class='confluenceTd'> <tt>java.lang.Long</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>BLOB</tt> </td>
<td class='confluenceTd'> <tt>com.gigaspaces.jdbc.driver.Blob</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>CLOB</tt> </td>
<td class='confluenceTd'> <tt>com.gigaspaces.jdbc.driver.Clob</tt> </td>
</tr>
</tbody></table>

<h1><a name="JDBCDriver-SupportedFeatures"></a>Supported Features</h1>

<p><b>GigaSpaces JDBC supports the following</b>:</p>
<ul>
	<li>All Basic SQL statements: <tt>SELECT, INSERT, DELETE, UPDATE, CREATE TABLE, DROP TABLE</tt>.</li>
	<li><tt>AND/OR</tt> operators to join two or more conditions in a <tt>WHERE</tt> clause.</li>
	<li>Aggregate functions: <tt>COUNT</tt>, <tt>MAX</tt>, <tt>MIN</tt>, <tt>SUM</tt>, <tt>AVG</tt>.</li>
	<li>All basic logical operations to create conditions: =, &lt;&gt;, &lt;,&gt;, &gt;=, &lt;=, <tt>[NOT]</tt> like, is <tt>[NOT]</tt> <tt>null</tt>, <tt>IN</tt>.</li>
	<li>Nested fields query - You may use as part of the select statement nested fields within collections (maps) or objects within the Space object.</li>
	<li>Multiple tables select - Starting with XAP 7.0.1 the join feature supports the selection of multiple tables (previous versions supported select with only two tables). The join feature uses the cartesian product of the tables data to form the result set. The join will perform well when having tables with small/medium size (up to 1,000,000 rows).</li>
	<li><tt>ORDER BY</tt> for multiple columns.</li>
	<li>Column aliases. (<span id='tgl_content_2' class='cloakToggle'></span>Click here for example...)


<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">Connection conn;
Statement stmt = conn.createStatement();
ResultSet rs = stmt.executeQuery(<span class="code-quote">"SELECT ID AS Identifier, NAME AS FullName FROM PERSON WHERE Identifier = 210"</span>);</pre>
</div></div>

</li>
	<li>Table aliases &#8211; tables are allowed to use aliases throughout the query.</li>
	<li>Using a sub-query in the <tt>FROM</tt> clause. (<span id='tgl_content_3' class='cloakToggle'></span>Click here for example...)


<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">Connection conn;
Statement stmt = conn.createStatement();
ResultSet rs = stmt.executeQuery(<span class="code-quote">"SELECT * FROM STUDENT WHERE GRADE &gt;= (SELECT AVG(GRADE) FROM STUDENT)"</span>);</pre>
</div></div>
<div class='panelMacro'><table class='warningMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/forbidden.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>
<p>Joined sub-queries are not supported.</p></td></tr></table></div>

</li>
	<li><tt>sysdate</tt> &#45; a keyword suggesting current time and date.</li>
	<li><tt>rownum</tt> &#45; a keyword to use in <tt>WHERE</tt> clauses, setting the number of rows to select.</li>
	<li>Select for update &#8211; allowing the locking of rows in order to update them later.</li>
	<li>Remote and embedded query processes configuration &#8211; allows fast access to the space using embedded mode.</li>
	<li>Optimistic locking.</li>
	<li>Batch Processing.</li>
	<li>Increment a field in an UPDATE statement. (<span id='tgl_content_1' class='cloakToggle'></span>Click here for example...)


<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">Connection conn;
Statement stmt = conn.createStatement();
<span class="code-object">int</span> result = stmt.executeUpdate(<span class="code-quote">"UPDATE PERSON SET VERSION = VERSION + 1 WHERE ID = 10000"</span>);</pre>
</div></div>
<div class='panelMacro'><table class='warningMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/forbidden.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>
<p>Field incrementation is only supported for <tt>Integer</tt> fields using a '+' operator.</p></td></tr></table></div>

</li>
	<li>A statement caching mechanism is provided to speed up statement parsing.</li>
	<li>Meta Data API.</li>
	<li>Connection pool.</li>
	<li>All JDBC basic types including Blob and Clob.</li>
	<li><tt>GROUP BY</tt> for multiple columns.</li>
	<li><tt>DISTINCT</tt> (although not when used with functions or aggregations)</li>
</ul>


<h1><a name="JDBCDriver-UnsupportedFeatures"></a>Unsupported Features</h1>

<p><b>GigaSpaces JDBC does not support the following</b>:</p>
<ul>
	<li>The SQL statements: <tt>HAVING</tt>, <tt>VIEW</tt>, <tt>TRIGGERS</tt>, <tt>EXISTS</tt>, <tt>BETWEEN</tt>, <tt>NOT</tt>, <tt>CREATE USER</tt>, <tt>GRANT</tt>, <tt>REVOKE</tt>, <tt>SET PASSWORD</tt>,  <tt>CONNECT USER</tt>, <tt>ON</tt>.</li>
	<li><tt>CREATE</tt> Database.</li>
	<li><tt>CREATE</tt> Index, <tt>DROP</tt> Index.</li>
	<li>Constraints: <tt>NOT NULL</tt>, <tt>IDENTITY</tt>, <tt>UNIQUE</tt>, <tt>PRIMARY KEY</tt>, Foreign Key/<tt>REFERENCES</tt>, <tt>NO ACTION</tt>, <tt>CASCADE</tt>, <tt>SET NULL</tt>, <tt>SET DEFAULT</tt>, <tt>CHECK</tt>.</li>
	<li>Set operations: <tt>Union, Minus, Union All</tt>.</li>
	<li>Aggregate Functions: <tt>STDEV</tt>, <tt>STDEVP</tt>, <tt>VAR</tt>, <tt>VARP</tt>, <tt>FIRST</tt>, <tt>LAST</tt>.</li>
	<li>The <tt>UPDATE</tt> statement does not allow the use of an expression or a <tt>null</tt> value in the <tt>SET</tt> clause.</li>
	<li>Using a constant instead of the column name.</li>
	<li>The <tt>INSERT</tt> statement does not allow the use of an expression in the <tt>VALUES</tt> clause.</li>
	<li>"." used to indicate a double data type.</li>
	<li>Using mathematical expressions in the <tt>WHERE</tt> clause.</li>
	<li><tt>LEFT [OUTER] JOIN</tt></li>
	<li><tt>RIGHT [OUTER] JOIN</tt></li>
	<li><tt>[INNER] JOIN</tt></li>
</ul>


<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>When having <tt>SELECT count (&#42;) FROM myClass</tt> JDBC query &#8211; <tt>myClass</tt> sub classes object count are not taken into consideration when processing the query result. The <tt>SELECT count (&#42;) FROM myClass WHERE X=Y</tt> and <tt>SELECT (&#42;) from myClass</tt> do take into consideration <tt>myClass</tt> sub classes objects when processing the result. Future versions will resolve this inconsistency.<br/>
As a workaround, construct a JDBC query that includes a relevant <tt>WHERE</tt> part.</td></tr></table></div>

<h1><a name="JDBCDriver-PartitioningSupport"></a>Partitioning Support</h1>
<p>In order to partition the data and rout operations to the correct partition you should specify a "routing column" for each table. The "routing column" is specified through one of three mechanisms:</p>

<ol>
	<li>A POJO with a <a href="POJO Metadata.html" title="POJO Metadata">@SpaceRouting</a> field can be sent to the space via the <tt>snapshot</tt> call prior to calling the JDBC API.</li>
	<li>Create the table through JDBC; the first index as part of the CREATE TABLE statement will be the routing field.</li>
	<li>If there is no indexed column, the first column as part of the CREATE TABLE will be the routing field.</li>
</ol>


<h1><a name="JDBCDriver-NestedFieldQuery"></a>Nested Field Query</h1>
<p>You may use as part of the JDBC select statement nested fields. These could be <a href="http://download-llnw.oracle.com/javase/6/docs/api/java/util/Map.html">Map</a> type fields or user defined data type fields within the Space object. See below example for a space class with a nested Map and a nested object fields. Both are indexed:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeHeader panelHeader" style="border-bottom-width: 1px;"><b>The Inner Class</b></div><div class="codeContent panelContent">
<pre class="code-java"><span class="code-keyword">public</span> class MyData <span class="code-keyword">implements</span> Serializable{
	
	<span class="code-keyword">public</span> MyData(){}
	<span class="code-object">String</span> data1;
	<span class="code-object">String</span> data2;
	<span class="code-comment">// getter and setter methods
</span>}</pre>
</div></div>

<div class="code panel" style="border-width: 1px;"><div class="codeHeader panelHeader" style="border-bottom-width: 1px;"><b>The Space Class with the nested Map and custom Field data type</b></div><div class="codeContent panelContent">
<pre class="code-java">@SpaceClass
<span class="code-keyword">public</span> class MyClass {
	<span class="code-keyword">public</span> MyClass (){}
	<span class="code-object">Integer</span> num;
	<span class="code-object">String</span> str;
	<span class="code-object">Integer</span> id;
	HashMap&lt;<span class="code-object">String</span>, MyData&gt; map; <span class="code-comment">// a map within the space object
</span>	MyData data; <span class="code-comment">// an object within the space object
</span>	
	@SpaceIndex (type=SpaceIndexType.BASIC)
	<span class="code-keyword">public</span> <span class="code-object">Integer</span> getNum() {
		<span class="code-keyword">return</span> num;
	}
	<span class="code-keyword">public</span> void setNum(<span class="code-object">Integer</span> num) {
		<span class="code-keyword">this</span>.num = num;
	}
	
	@SpaceIndex (type=SpaceIndexType.BASIC)
	<span class="code-keyword">public</span> <span class="code-object">String</span> getStr() {
		<span class="code-keyword">return</span> str;
	}
	<span class="code-keyword">public</span> void setStr(<span class="code-object">String</span> str) {
		<span class="code-keyword">this</span>.str = str;
	}
	
	@SpaceId (autoGenerate = <span class="code-keyword">false</span>)
	@SpaceRouting
	<span class="code-keyword">public</span> <span class="code-object">Integer</span> getId() {
		<span class="code-keyword">return</span> id;
	}
	<span class="code-keyword">public</span> void setId(<span class="code-object">Integer</span> id) {
		<span class="code-keyword">this</span>.id = id;
	}
	
	@SpaceIndexes({@SpaceIndex(path=<span class="code-quote">"key1"</span> , type = SpaceIndexType.BASIC),
			@SpaceIndex(path=<span class="code-quote">"key2"</span> , type = SpaceIndexType.BASIC)})
	<span class="code-keyword">public</span> HashMap&lt;<span class="code-object">String</span>, MyData&gt; getMap() {
		<span class="code-keyword">return</span> map;
	}
	<span class="code-keyword">public</span> void setMap(HashMap&lt;<span class="code-object">String</span>, MyData&gt; map) {
		<span class="code-keyword">this</span>.map = map;
	}
	
	@SpaceIndexes({@SpaceIndex(path=<span class="code-quote">"data1"</span> , type = SpaceIndexType.BASIC),
			@SpaceIndex(path=<span class="code-quote">"data2"</span> , type = SpaceIndexType.BASIC)})
	<span class="code-keyword">public</span> MyData getData() {
		<span class="code-keyword">return</span> data;
	}
	<span class="code-keyword">public</span> void setData(MyData data) {
		<span class="code-keyword">this</span>.data = data;
	}
}</pre>
</div></div>

<p>Here is an example for a JDBC query call you may use with the above Space object. Both the nested Map and nested object fields are used with the JDBC query below:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeHeader panelHeader" style="border-bottom-width: 1px;"><b>The JDBC select Statement using nested objects</b></div><div class="codeContent panelContent">
<pre class="code-java"><span class="code-object">String</span> queryString = 
"select uid, 
map.key1.data1, map.key1.data2, 
map.key2.data1, map.key2.data2, 
data.data1, data.data2,str
from 
org.test.MyClass where 
map.key1.data1='aa' and
map.key1.data2='bb' and 
map.key2.data1='cc' and 
map.key2.data2='dd' and 
data.data1 = 'ee' and
data.data1 = 'ff' and
str='ABCD'";
stmt = connection.createStatement();
ResultSet rs = stmt.executeQuery(queryString );
<span class="code-keyword">while</span> (rs.next()) {
	...
}</pre>
</div></div>

<h1><a name="JDBCDriver-JDBCReservedWords"></a>JDBC Reserved Words</h1>
<p>Here is a list of JDBC reserved keywords, data types, separators and operators:</p>
<h2><a name="JDBCDriver-Keywords"></a>Keywords</h2>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">ALTER ADD AND ASC BETWEEN BY CREATE CALL DROP DEFAULT_NULL DESC DISTINCT 
END FROM GROUP IN IS LIKE MAX MIN NOT NULL OR ORDER SELECT SUBSTR SUM SYSDATE
UPPER WHERE COUNT DELETE EXCEPTION ROWNUM INDEX INSERT INTO SET TABLE TO_CHAR 
TO_NUMBER FOR_UPDATE UPDATE UNION VALUES COMMIT ROLLBACK PRIMARY_KEY UID USING</pre>
</div></div>

<h2><a name="JDBCDriver-DataTypes"></a>Data Types</h2>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">date datetime  time <span class="code-object">float</span> <span class="code-object">double</span> number decimal <span class="code-object">boolean</span> integer varchar varchar2 
<span class="code-object">char</span> timestamp <span class="code-object">long</span> clob blob empty_clob() empty_blob() lob <span class="code-keyword">true</span> <span class="code-keyword">false</span></pre>
</div></div>

<h2><a name="JDBCDriver-Separatorsandoperators"></a>Separators and operators</h2>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">:=  || ; . ROWTYPE ~ &lt; &lt;= &gt;  &gt;= =&gt; != &lt;&gt; \(+\) ( ) \* / + - ? \{ \}</pre>
</div></div>

<h1><a name="JDBCDriver-Configuration"></a>Configuration</h1>
<p>The JDBC Driver should be configured using the following properties. These should be part of the <a href="The Space Component.html" title="The Space Component">The Space Component</a> configuration when deployed:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> Parameter </th>
<th class='confluenceTh'> Description </th>
<th class='confluenceTh'> Default Value </th>
</tr>
<tr>
<td class='confluenceTd'>space-config.QueryProcessor.space_read_lease_time</td>
<td class='confluenceTd'>Read timeout. Millisec units.</td>
<td class='confluenceTd'>0</td>
</tr>
<tr>
<td class='confluenceTd'>space-config.QueryProcessor.space_write_lease</td>
<td class='confluenceTd'>Object lease timeout. Millisec units. </td>
<td class='confluenceTd'>9223372036854775807L</td>
</tr>
<tr>
<td class='confluenceTd'>space-config.QueryProcessor.transaction_timeout</td>
<td class='confluenceTd'>Millisec unit. Transaction Timeout.</td>
<td class='confluenceTd'>30000</td>
</tr>
<tr>
<td class='confluenceTd'>space-config.QueryProcessor.init_jmx</td>
<td class='confluenceTd'>Expose Tracing via JMX</td>
<td class='confluenceTd'>false</td>
</tr>
<tr>
<td class='confluenceTd'>space-config.QueryProcessor.trace_exec_time</td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>false</td>
</tr>
<tr>
<td class='confluenceTd'>space-config.QueryProcessor.debug_mode</td>
<td class='confluenceTd'>Boolean value. When true show debug information.</td>
<td class='confluenceTd'>false</td>
</tr>
<tr>
<td class='confluenceTd'>space-config.QueryProcessor.parser_case_sensetivity</td>
<td class='confluenceTd'>Boolean value. Determines if Column and Table names are case sensitive.</td>
<td class='confluenceTd'>true</td>
</tr>
<tr>
<td class='confluenceTd'>space-config.QueryProcessor.auto_commit</td>
<td class='confluenceTd'>Boolean value. Auto Commit mode</td>
<td class='confluenceTd'>true</td>
</tr>
<tr>
<td class='confluenceTd'>space-config.QueryProcessor.date_format</td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>yyyy-MM-dd</td>
</tr>
<tr>
<td class='confluenceTd'>space-config.QueryProcessor.datetime_format</td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>yyyy-MM-dd hh:mm:ss</td>
</tr>
<tr>
<td class='confluenceTd'>space-config.QueryProcessor.time_format</td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>hh:mm:ss</td>
</tr>
</tbody></table>

<p>Example:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag">&lt;os-core:space id=<span class="code-quote">"space"</span> url=<span class="code-quote">"/.//space"</span> &gt;</span>
    <span class="code-tag">&lt;os-core:properties&gt;</span>
        <span class="code-tag">&lt;props&gt;</span>
            <span class="code-tag">&lt;prop key=<span class="code-quote">"space-config.QueryProcessor.transaction_timeout"</span>&gt;</span>50000<span class="code-tag">&lt;/prop&gt;</span>
            <span class="code-tag">&lt;prop key=<span class="code-quote">"space-config.QueryProcessor.date_format"</span>&gt;</span>yyyy-MM-dd<span class="code-tag">&lt;/prop&gt;</span>
        <span class="code-tag">&lt;/props&gt;</span>
    <span class="code-tag">&lt;/os-core:properties&gt;</span>
<span class="code-tag">&lt;/os-core:space&gt;</span></pre>
</div></div>

<h1><a name="JDBCDriver-JDBCErrorCodes"></a>JDBC Error Codes</h1>
<p>List of JDBC error codes and their descriptions:<br/>
<tt>100</tt>: No (more) data<br/>
<tt>0</tt>: Successful Completion</p>

<p><tt>-101</tt>: Can't alter table<br/>
<tt>-102</tt>: Table <tt>&lt;tableName&gt;</tt> does not exist<br/>
<tt>-103</tt>: Commit/Rollback failed<br/>
<tt>-104</tt>: Can't delete row<br/>
<tt>-105</tt>: Table does not exist<br/>
<tt>-106</tt>: Remote Exception occurred<br/>
<tt>-107</tt>: Failed to drop table<br/>
<tt>-108</tt>: All values must be set in a Prepared Statement<br/>
<tt>-109</tt>: Prepared value already set!<br/>
<tt>-110</tt>: Prepared value missing!<br/>
<tt>-111</tt>: Invalid data<br/>
<tt>-112</tt>: Invalid type for the specified column<br/>
<tt>-113</tt>: Unknown columns<br/>
<tt>-114</tt>: Unknown table in condition<br/>
<tt>-115</tt>: Can't set same value more than once<br/>
<tt>-116</tt>: Unknown column for IN condition<br/>
<tt>-117</tt>: Unknown execution type<br/>
<tt>-118</tt>: Table already exists<br/>
<tt>-119</tt>: Wrong data type in SUM function<br/>
<tt>-120</tt>: Error in rownum<br/>
<tt>-121</tt>: Select failed<br/>
<tt>-122</tt>: The selected column does not exist in the selected tables<br/>
<tt>-123</tt>: No such column for given alias<br/>
<tt>-124</tt>: Order by column should be in select list<br/>
<tt>-125</tt>: Must specify the column to return the sum of.<br/>
<tt>-126</tt>: All values must be set<br/>
<tt>-127</tt>: Wrong type for given column<br/>
<tt>-128</tt>: Incorrect number of values to insert<br/>
<tt>-129</tt>: Type mismatch in nested query<br/>
<tt>-130</tt>: Can't update row!<br/>
<tt>-131</tt>: Blob cannot hold <tt>null</tt> data<br/>
<tt>-132</tt>: Command not supported<br/>
<tt>-133</tt>: Both parameters should be greater than 1<br/>
<tt>-134</tt>: Clob cannot hold <tt>null</tt> data<br/>
<tt>-135</tt>: Can't convert clob to ascii, unsupported encoding<br/>
<tt>-136</tt>: Substring out of clob's bounds<br/>
<tt>-137</tt>: Error creating connection - Unknown host<br/>
<tt>-138</tt>: Error creating connection or reading QP properties<br/>
<tt>-139</tt>: Cannot commit an autocommit connection<br/>
<tt>-140</tt>: Cannot rollback an autocommit connection<br/>
<tt>-141</tt>: The given URL is not supported<br/>
<tt>-142</tt>: Prepared statement must contain prepared values<br/>
<tt>-143</tt>: Cannot call <tt>SELECT</tt> with <tt>executeUpdate</tt>. Use <tt>executeQuery</tt> instead<br/>
<tt>-144</tt>: Cannot set a <tt>null</tt> object<br/>
<tt>-145</tt>: Cannot set object, unknown type<br/>
<tt>-146</tt>: Used <tt>executeQuery</tt> instead of <tt>executeUpdate</tt><br/>
<tt>-147</tt>: Cannot set a value<br/>
<tt>-148</tt>: Cannot represent this value as <tt>byte</tt><br/>
<tt>-149</tt>: Cannot represent this value as <tt>double</tt><br/>
<tt>-150</tt>: Cannot represent this value as <tt>float</tt><br/>
<tt>-151</tt>: Cannot represent this value as <tt>int</tt><br/>
<tt>-152</tt>: Cannot represent this value as <tt>long</tt><br/>
<tt>-153</tt>: Cannot represent this value as <tt>short</tt><br/>
<tt>-154</tt>: Cannot represent this value as boolean<br/>
<tt>-155</tt>: Column found in result<br/>
<tt>-156</tt>: Cannot represent this value as <tt>Blob</tt><br/>
<tt>-157</tt>: Cannot represent this value as <tt>Clob</tt><br/>
<tt>-158</tt>: Cannot represent this value as <tt>Date</tt><br/>
<tt>-159</tt>: Cannot represent this value as <tt>Time</tt><br/>
<tt>-160</tt>: Cannot represent this value as <tt>Timestamp</tt><br/>
<tt>-161</tt>: The <tt>next()</tt> method must be called at least once<br/>
<tt>-162</tt>: Exhausted <tt>ResultSet</tt><br/>
<tt>-201</tt>: Invalid SQL syntax</p>

                     </td>
</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td height="12" background="http://www.gigaspaces.com/wiki/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
</tr>
<tr>
<td align="center"><font color="grey"><a href="http://www.gigaspaces.com">GigaSpaces.com</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xwBmAg" class="smalltext">Legal Notice</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xgBmAg" class="smalltext">3rd Party Licenses</a> -
		<a href="http://www.gigaspaces.com/wiki/x/BQFmAg" class="smalltext">Site Map</a> -
		<a href="http://www.gigaspaces.com/wiki/display/API/API+Documentation+Portal" class="version-link">API Docs</a> -
		<a href="http://forum.openspaces.org/forum.jspa?forumID=175" class="version-link">Forum</a> -
		<a href="http://www.gigaspaces.com/LatestProductVersion" class="version-link">Downloads</a> -
		<a href="http://blog.gigaspaces.com/" class="version-link">Blog</a> -
		<a href="http://www.gigaspaces.com/os_papers.html" class="version-link">White Papers</a> -
		<a href="mailto:techw@gigaspaces.com">Contact Tech Writing</a> -
		<i><a href="http://www.atlassian.com/software/confluence">Gen. by Atlassian Confluence</a></i></font></td>
</tr>
</table>
     </body>
</html>
