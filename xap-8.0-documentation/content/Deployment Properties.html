<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
     <head>
         <title>XAP 8.0 Documentation : Deployment Properties</title>
<link rel="stylesheet" href="styles/site.css" type="text/css" />
         <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
		 <style>
.back-to {
	color: #666666;
	font-weight: bold;
}	 
a.back-to:link, a.back-to:visited, a.back-to:hover, a.back-to:active  {
	color: #666666;
}	 
		 </style>
     </head>

     <body>
<table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
<tr>
<td valign="top" class="pagebody">
<div class="pageheader">
<span class="back-to">XAP 8.0 Documentation > <a href="index.html">Back to Table of Contents</a></span><br>
<h1>Deployment Properties</h1>
</div>
<br>

<script type='text/javascript'>//<![CDATA[
function debug() { }
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/browser.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/behaviour.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/memory.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/cloak.js'>//<![CDATA[
// ]]></script><script type='text/javascript'>//<![CDATA[
Cloak.closeHTML = "<img src=\'/wiki/download/resources/net.customware.confluence.plugin.composition:toggle-cloak/img/navigate_down_10.gif\'/>";
Cloak.openHTML = "<img src=\'/wiki/download/resources/net.customware.confluence.plugin.composition:toggle-cloak/img/navigate_right_10.gif\'/>";
Cloak.toggleZone = true;
Cloak.memoryDuration = 0;
Cloak.memoryPrefix = "contentId:53903776";
Cloak.memoryPath = "/wiki/";
// ]]></script><style type='text/css'>
.cloakToggle { /* Definition for state toggling image */
cursor:hand;
cursor:pointer;
}
</style><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/transitions.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/deck.js'>//<![CDATA[
// ]]></script><link rel='stylesheet' type='text/css'  href='/wiki/styles/main-action.css?pluginCompleteKey=net.customware.confluence.plugin.composition:composition-setup&stylesheetName=deck&spaceKey=XAP8'/><script type='text/javascript'>//<![CDATA[
Deck.memoryDuration = 0;
Deck.memoryPrefix = "contentId:53903776";
Deck.memoryPath = "/wiki/";
// ]]></script>

<div style="border-style:solid; border-color:#3C78B5; border-width:thin; padding-left:20px; padding-bottom:20px; padding-top:20px; padding-right:20px; background-color:#D8E4F1"> 

<p><b>Section Summary:</b>  The processing unit can be injected with dynamic property values at deployment time. The mechanism leverages Spring's <a href="http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#beans-factory-placeholderconfigurer"><tt>PropertyPlaceholderConfigurer</tt></a> to provide powerful and simple properties-based injection. </p>
</div>

<h1><a name="DeploymentProperties-Overview"></a>Overview</h1>

<p>When a processing unit is deployed and provisioned, you can inject property values to it only known at deployment time, or in order to further configure the processing unit elements. Injected properties can be either properties that have been explicitly externalized from the <a href="Configuring Processing Unit Elements.html" title="Configuring Processing Unit Elements">processing unit configuration file</a> or properties related to one the platform components (e.g. a space) that can be configured at deployment time. This mechanism is built on top of Spring's support for an externalized properties configuration called <a href="http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#beans-factory-placeholderconfigurer">PropertyPlaceholderConfigurer</a>. This mechanism has been enhanced to provide a powerful yet simple property injection.</p>

<p><img class="emoticon" src="images/icons/emoticons/information.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> One of the core values of GigaSpaces XAP processing unit model is the fact that a processing unit need not be changed at all in the transition from the development environment (namely your IDE) to the production environment. This feature, along with others, is one of the enablers of this behavior. </p>

<h1><a name="DeploymentProperties-DefiningPropertyPlaceHoldersinYourProcessingUnit"></a>Defining Property Place Holders in Your Processing Unit </h1>

<p>Property injection to the processing unit's configuration is supported at the Spring application context scope, which means that it can be applied to all of the components configured in the <a href="Configuring Processing Unit Elements.html" title="Configuring Processing Unit Elements">processing unit's configuration file</a> (whether GigaSpaces out of the box components like the space, space proxy or event containers, or user-defined beans). </p>

<p>Below you can find an example of an XML configuration which defines to property place holders, <tt>spaceSchema</tt> and <tt>connectionTimeout</tt>. In this example we also specify default values for them, which is always a good practice and does not force the deployer to specify values for these place holders. </p>

<p><img class="emoticon" src="images/icons/emoticons/lightbulb_on.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> Note that for property place holders we use the <tt>${placeholder name</tt>} notation.</p>


<div class="panel" style="background-color: #FFFFFF;border-color: #3C78B5;border-style: solid;border-width: 1px;"><div class="panelContent" style="background-color: #FFFFFF;">
<h5><a name="DeploymentProperties-Namespace"></a>Namespace</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml">&lt;!-- The PropertyPlaceholderConfigurer must be present in order to define default value
     for properties.
--&gt;
<span class="code-tag">&lt;bean class=<span class="code-quote">"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"</span>&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"properties"</span>&gt;</span><span class="code-tag">&lt;props&gt;</span>
        <span class="code-tag">&lt;prop key=<span class="code-quote">"spaceSchema"</span>&gt;</span>default<span class="code-tag">&lt;/prop&gt;</span>
        <span class="code-tag">&lt;prop key=<span class="code-quote">"connectionTimeout"</span>&gt;</span>1000<span class="code-tag">&lt;/prop&gt;</span>
    <span class="code-tag">&lt;/props&gt;</span><span class="code-tag">&lt;/property&gt;</span>
<span class="code-tag">&lt;/bean&gt;</span>

<span class="code-tag">&lt;os-core:space id=<span class="code-quote">"space"</span> url=<span class="code-quote">"/./space"</span> schema=<span class="code-quote">"${spaceSchema}"</span> /&gt;</span>

<span class="code-tag">&lt;bean id=<span class="code-quote">"connBean"</span> class=<span class="code-quote">"MyConnection"</span>&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"timeout"</span> value=<span class="code-quote">"${connectionTimeout}"</span> /&gt;</span>
<span class="code-tag">&lt;/bean&gt;</span></pre>
</div></div> 


<h5><a name="DeploymentProperties-Plain"></a>Plain</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag"><span class="code-comment">&lt;!-- Define sensible defaults --&gt;</span></span>
<span class="code-tag">&lt;bean class=<span class="code-quote">"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"</span>&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"properties"</span>&gt;</span><span class="code-tag">&lt;props&gt;</span>
        <span class="code-tag">&lt;prop key=<span class="code-quote">"spaceSchema"</span>&gt;</span>default<span class="code-tag">&lt;/prop&gt;</span>
        <span class="code-tag">&lt;prop key=<span class="code-quote">"connectionTimeout"</span>&gt;</span>1000<span class="code-tag">&lt;/prop&gt;</span>
    <span class="code-tag">&lt;/props&gt;</span><span class="code-tag">&lt;/property&gt;</span>
<span class="code-tag">&lt;/bean&gt;</span>

<span class="code-tag">&lt;bean id=<span class="code-quote">"space"</span> class=<span class="code-quote">"org.openspaces.core.space.UrlSpaceFactoryBean"</span>&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"url"</span> value=<span class="code-quote">"/./space"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"schema"</span> value=<span class="code-quote">"${spaceSchema}"</span> /&gt;</span>
<span class="code-tag">&lt;/bean&gt;</span>

<span class="code-tag">&lt;bean id=<span class="code-quote">"connBean"</span> class=<span class="code-quote">"MyConnection"</span>&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"timeout"</span> value=<span class="code-quote">"${connectionTimeout}"</span> /&gt;</span>
<span class="code-tag">&lt;/bean&gt;</span></pre>
</div></div>
</div></div>

<p>The various <a href="Deploying and Running the Processing Unit.html" title="Deploying and Running the Processing Unit">processing unit runtime modes</a> all provide support for injecting property values instead of place holders. There are several ways to define the values for the property place holders, depending on how you choose to run/deploy your processing unit.</p>

<h3><a name="DeploymentProperties-Usinga%7B%7B.properties%7D%7DFile"></a>Using a <tt>.properties</tt> File </h3>

<p>If you would like your properties to be configured in a dedicated file this can be done in various ways. </p>

<ul>
	<li>Including a <tt>pu.properties</tt> file in the processing unit. This file can be placed under the root of the processing unit or under the <tt>META-INF/spring</tt> directory (This is also described <a href="The Processing Unit Structure and Configuration.html" title="The Processing Unit Structure and Configuration">here</a>). The values of this file will be loaded and injected automatically to the processing unit instances at deployment time.</li>
</ul>


<ul>
	<li>External <tt>.properties</tt> file. The file can have any name, as long as it's accessible to the deployment tool (UI, CLI, etc.) or specified when <a href="Running and Debugging Within Your IDE.html" title="Running and Debugging Within Your IDE">running the processing unit within your IDE</a> or in <a href="Running in Standalone Mode.html" title="Running in Standalone Mode">standalone mode</a>.<br/>
When deploying through the <a href="Commands and Scripts.html" title="Commands and Scripts">CLI</a> or <a href="Running and Debugging Within Your IDE.html" title="Running and Debugging Within Your IDE">running within the IDE</a>, you specify the location of the file using <tt>-properties &lt;location&gt;</tt> as a command line argument with the CLI or a program argument within the IDE. By default, the location is a file-system-based location of a properties file (follows Spring <a href="http://static.springframework.org/spring/docs/2.5.x/reference/resources.html#resources-resourceloader">Resource Loader</a> syntax). The following is an example of a <tt>.properties</tt> file that can be used with the sample <tt>pu.xml</tt> configuration shown above. In this case, the values within the <tt>.properties</tt> file are injected to the processing unit instances (overriding values in <tt>pu.properties</tt> if it exists).<br/>
When deploying via the UI, the file can be loaded into the deployment wizard by clicking "Next" in the first screen of the wizard and then "Load Properties", locating the properties file on your local disk. This will load all the property place holders that are in the file. </li>
</ul>


<ul>
	<li>Direct property injection. This can also be done via one of the deployment tools (UI, CLI) or specified when <a href="Running and Debugging Within Your IDE.html" title="Running and Debugging Within Your IDE">running the processing unit within your IDE</a>.<br/>
When deploying through the <a href="Commands and Scripts.html" title="Commands and Scripts">CLI</a> or <a href="Running and Debugging Within Your IDE.html" title="Running and Debugging Within Your IDE">running within the IDE</a>, you specify property values by using the following syntax:
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">-properties embed:<span class="code-comment">//spaceSchema=persistent;connectionTimeout=15000</span></pre>
</div></div>
<p>This can be specified as part of the command line arguments or as a program argument when running within your IDE. <br/>
When deploying via the UI, click "Next" in the first screen of the deployment wizard and then "+" to add properties. Any property you specify here will be injected to the appropriate property place holder (if such exists) and will override the <tt>pu.properties</tt> within the processing unit. </p></li>
</ul>


<div class='panelMacro'><table class='infoMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Property Injection for SLA Definitions</b><br />
<p>From version 7.0 onwards, the processing unit's <a href="Configuring the Processing Unit SLA.html" title="Configuring the Processing Unit SLA">SLA definitions</a> can be defined in a separate <tt>sla.xml</tt> file (unlike previous release in which they could only have been defined in the <tt>pu.xml</tt> file). As you may recall, the SLA definition are expressed via the <tt>&lt;os-sla:sla&gt;</tt> XML element in either the <tt>pu.xml</tt> of the <tt>sla.xml</tt> files.</p>

<p>You should note however that property injection, as described in this page, is only available for SLA definitions expressed in a separate <tt>sla.xml</tt> file, and will not be applied to the <tt>&lt;os-sla:sla&gt;</tt> element if it is part of the <tt>pu.xml</tt> file.</p>

<p>Also note that the parsing of the SLA element happens on the deploy tool side, so the properties should be available on the deploy tool side.</p></td></tr></table></div>


<h1><a name="DeploymentProperties-UsingDeploymentPropertiestoOverrideSpaceSchemaandClusterSchema"></a>Using Deployment Properties to Override Space Schema and Cluster Schema </h1>

<p>When a <a href="The Space Component.html" title="The Space Component">Space</a> is created, two major groups of configuration elements determine its runtime configuration: the space schema and the cluster schema. The cluster schema controls the space clustering topology (partitioned or replicated), whether the replication to its replicas is synchronous or asynchronous, and various other aspects that control its clustering behavior. The space schema on the other hand, controls other elements which are not related to the space clustering topology, such as the eviction strategy (LRU, ALL_IN_CACHE), whether or not its persistent, etc.</p>

<p>The basis for these two configuration groups are XML files located inside the GigaSpaces libraries. In order to override the values in these XML files, one can simply specify the <a href="http://en.wikipedia.org/wiki/XPath">XPath</a> expression that corresponds to the element to be overridden. </p>

<p>These expression can also be included in all of the above mentioned property injection mechanisms (with the exception that you do not have to explicitly specify property placeholders for them). </p>

<p>Here's an example for a space configured within the processing unit, and a property injection overriding its schema name:</p>


<div class="panel" style="background-color: #FFFFFF;border-color: #3C78B5;border-style: solid;border-width: 1px;"><div class="panelContent" style="background-color: #FFFFFF;">
<h5><a name="DeploymentProperties-Namespace"></a>Namespace</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag">&lt;os-core:space id=<span class="code-quote">"space"</span> url=<span class="code-quote">"/./space"</span> /&gt;</span></pre>
</div></div> 


<h5><a name="DeploymentProperties-Plain"></a>Plain</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag">&lt;bean id=<span class="code-quote">"space"</span> class=<span class="code-quote">"org.openspaces.core.space.UrlSpaceFactoryBean"</span>&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"url"</span> value=<span class="code-quote">"/./space"</span> /&gt;</span>
<span class="code-tag">&lt;/bean&gt;</span></pre>
</div></div>
</div></div>

<p>When deploying the space you should use <tt>-properties space embed://gs.space.url.arg.schema=persistent</tt>. This instructs the runtime to override the configuration of the bean named "space" in your pu.xml file with the specified value. You may also configure the space directly inside your processing unit using direct property injection on the space bean. See <br/>
<a href="http://www.gigaspaces.com/wiki/display/XAP8/Overriding+Default+Configuration">this page</a> for more details and for a complete list of the configurable XPath properties. </p>

                     </td>
</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td height="12" background="http://www.gigaspaces.com/wiki/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
</tr>
<tr>
<td align="center"><font color="grey"><a href="http://www.gigaspaces.com">GigaSpaces.com</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xwBmAg" class="smalltext">Legal Notice</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xgBmAg" class="smalltext">3rd Party Licenses</a> -
		<a href="http://www.gigaspaces.com/wiki/x/BQFmAg" class="smalltext">Site Map</a> -
		<a href="http://www.gigaspaces.com/wiki/display/API/API+Documentation+Portal" class="version-link">API Docs</a> -
		<a href="http://forum.openspaces.org/forum.jspa?forumID=175" class="version-link">Forum</a> -
		<a href="http://www.gigaspaces.com/LatestProductVersion" class="version-link">Downloads</a> -
		<a href="http://blog.gigaspaces.com/" class="version-link">Blog</a> -
		<a href="http://www.gigaspaces.com/os_papers.html" class="version-link">White Papers</a> -
		<a href="mailto:techw@gigaspaces.com">Contact Tech Writing</a> -
		<i><a href="http://www.atlassian.com/software/confluence">Gen. by Atlassian Confluence</a></i></font></td>
</tr>
</table>
     </body>
</html>
