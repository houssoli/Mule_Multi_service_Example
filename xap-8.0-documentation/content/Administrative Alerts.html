<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
     <head>
         <title>XAP 8.0 Documentation : Administrative Alerts</title>
<link rel="stylesheet" href="styles/site.css" type="text/css" />
         <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
		 <style>
.back-to {
	color: #666666;
	font-weight: bold;
}	 
a.back-to:link, a.back-to:visited, a.back-to:hover, a.back-to:active  {
	color: #666666;
}	 
		 </style>
     </head>

     <body>
<table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
<tr>
<td valign="top" class="pagebody">
<div class="pageheader">
<span class="back-to">XAP 8.0 Documentation > <a href="index.html">Back to Table of Contents</a></span><br>
<h1>Administrative Alerts</h1>
</div>
<br>

<script type='text/javascript'>//<![CDATA[
function debug() { }
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/browser.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/behaviour.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/memory.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/cloak.js'>//<![CDATA[
// ]]></script><script type='text/javascript'>//<![CDATA[
Cloak.closeHTML = "<img src=\'/wiki/download/resources/net.customware.confluence.plugin.composition:toggle-cloak/img/navigate_down_10.gif\'/>";
Cloak.openHTML = "<img src=\'/wiki/download/resources/net.customware.confluence.plugin.composition:toggle-cloak/img/navigate_right_10.gif\'/>";
Cloak.toggleZone = true;
Cloak.memoryDuration = 0;
Cloak.memoryPrefix = "contentId:54821669";
Cloak.memoryPath = "/wiki/";
// ]]></script><style type='text/css'>
.cloakToggle { /* Definition for state toggling image */
cursor:hand;
cursor:pointer;
}
</style><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/transitions.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/deck.js'>//<![CDATA[
// ]]></script><link rel='stylesheet' type='text/css'  href='/wiki/styles/main-action.css?pluginCompleteKey=net.customware.confluence.plugin.composition:composition-setup&stylesheetName=deck&spaceKey=XAP8'/><script type='text/javascript'>//<![CDATA[
Deck.memoryDuration = 0;
Deck.memoryPrefix = "contentId:54821669";
Deck.memoryPath = "/wiki/";
// ]]></script>


<div style="border-style:solid; border-color:#3C78B5; border-width:thin; padding-left:20px; padding-bottom:20px; padding-top:20px; padding-right:20px; background-color:#D8E4F1"> 

<p><b>Section Summary:</b>  Runtime administrative alerts - monitoring the "health state" of the system. </p>
</div>

<h1><a name="AdministrativeAlerts-Overview"></a>Overview</h1>

<p>The alert mechanism provides the ability to receive alerts on various problematic conditions at runtime by using the <a href="Administration and Monitoring API.html" title="Administration and Monitoring API">Administration and Monitoring API</a>. The alerts give indication for the "health state" of the system.</p>

<div class='panelMacro'><table class='infoMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Runtime Model</b><br />The alerts rules are running within the <tt>Admin</tt> instance which the user created. GigaSpaces does not run an alert service that is running behind the scenes. If you would like to register for alerts in your production system, the recommended way to do it is to deploy your alert listener to the GigaSpaces <a href="The Runtime Environment.html" title="The Runtime Environment">The Runtime Environment</a> in the form of a <a href="The Processing Unit Structure and Configuration.html" title="The Processing Unit Structure and Configuration">processing unit</a>. </td></tr></table></div>

<p>The <a href="Administration and Monitoring API.html" title="Administration and Monitoring API">Administration and Monitoring API</a> provides events and statistics on top of which 'rules' can be applied to trigger an alert when required.</p>

<ul>
	<li><b>Events</b> such as <tt>ReplicationStatusChangedEvent</tt> indicate that the <tt>ReplicationStatus</tt> has changed (e.g. ACTIVE, DISABLED, DISCONNECTED). From this event, an alert trigger can be written to raise an alert if replication has disconnected, and to resolve an alert once replication has reconnected (ref. <b>Predefined Alerts</b> below).</li>
</ul>


<ul>
	<li><b>Statistics</b> such as <tt>OperatingSystemStatistics</tt> arrive as an <tt>OperatingSystemStatisticsChangedEvent</tt>, from which you can extract statistics - in example CPU utilization statistics. An alert trigger can be written to raise an alert if the CPU utilization has crossed a threshold (e.g. 80%), and to resolve an alert once CPU utilization has crossed below a threshold (e.g. 60%).</li>
</ul>


<p>These alerts provide for better supportability and easier troubleshooting.</p>

<p>The following diagram illustrates a simple flow of events/statistics sent to the 'Alert Trigger' which checks if the state answers the condition to raise an alert or to resolve an alert. Notice that an alert may be raised multiple times until it is finally resolved.</p>

<p><img src="download/attachments/48235229/alerts-flow-diagram.png" align="absmiddle" border="0"/></p>

<h1><a name="AdministrativeAlerts-PredefinedAlerts"></a>Predefined Alerts</h1>

<p>XAP 8.0 is packaged with a number of predefined alerts whose thresholds are configurable. XAP 8.0 does not currently allow for custom alerts defined by the user. Alerts can be either raised or resolved. For example, a CPU alert can be raised when the CPU utilization on a certain host crosses a certain threshold (say 80%) for a predefined amount of time. This alert can be resolved when the CPU utilization goes below another threshold (say 30%) for a predefined amount of time.
<br clear="all" /></p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'> <b>CPU Utilization Alert</b> </td>
<td class='confluenceTd'><ul>
	<li>Raise an alert if CPU utilization is above 80% for 1 minute</li>
	<li>Resolve alert if CPU utilization is below 60% for 1 minute</li>
</ul>
</td>
</tr>
<tr>
<td class='confluenceTd'> <b>Physical Memory Utilization Alert</b> </td>
<td class='confluenceTd'><ul>
	<li>Raise an alert if physical memory utilization is above 80% for 1 minute</li>
	<li>Resolve alert if physical memory utilization is below 60% for 1 minute</li>
</ul>
</td>
</tr>
<tr>
<td class='confluenceTd'> <b>Heap Memory Utilization Alert</b> </td>
<td class='confluenceTd'><ul>
	<li>Raise an alert if JVM heap memory utilization is above 80% for 1 minute</li>
	<li>Resolve alert if JVM heap memory utilization is below 60% for 1 minute</li>
</ul>
</td>
</tr>
<tr>
<td class='confluenceTd'> <b>Garbage Collection Alert</b> </td>
<td class='confluenceTd'><ul>
	<li>Raise an alert if a GC pause takes more than 10 seconds</li>
	<li>Resolve alert if GC pause takes less than 1 second</li>
</ul>
</td>
</tr>
<tr>
<td class='confluenceTd'> <b>Replication Channel Disconnection Alert</b> </td>
<td class='confluenceTd'><ul>
	<li>Raise an alert if replication channel has been disconnected between source and target Space</li>
	<li>Resolve alert if replication channel is reconnected between source and target Space</li>
</ul>
</td>
</tr>
<tr>
<td class='confluenceTd'> <b>Replication Redo Log Overflow to Disk Alert</b> </td>
<td class='confluenceTd'><ul>
	<li>Raise an alert if replication redo log has exceeded its memory capacity and has overflown to disk.</li>
	<li>Resolve alert if replication redo log no longer uses the disk</li>
</ul>
</td>
</tr>
<tr>
<td class='confluenceTd'> <b>Replication Redo Log Size Alert</b> </td>
<td class='confluenceTd'><ul>
	<li>Raise an alert if replication redo log size goes 100,000 packets</li>
	<li>Resolve alert if replication redo log size goes below 1,000 packets</li>
</ul>
</td>
</tr>
<tr>
<td class='confluenceTd'> <b>Mirror Persistence failure Alert</b> </td>
<td class='confluenceTd'><ul>
	<li>Raise an alert if Mirror Space failed to persist due to an error (e.g. a DB error). The alert is reported via the replication channel</li>
	<li>Resolve alert if Mirror Space manages to persist to the DB for first time after the alert has been raised.</li>
</ul>
</td>
</tr>
</tbody></table>

<h1><a name="AdministrativeAlerts-StaticConfiguration"></a>Static Configuration</h1>
<p>The static configuration for the predefined alerts mentioned above is defined in the <tt>&lt;GigaSpaces Root&gt;/config/alerts/alerts.xml</tt> file. It includes the default settings for each alert.</p>

<p>For example, the following is a snippet that represents the configuration of the <b>CPU Utilization Alert</b>.<br/>
The alert is configured with a high threshold of 80% and a low threshold of 60% and a   period of 1 minute. An alert will be raised if CPU utilization in a certain host in the GigaSpaces cluster crosses 80% for a period of 1 minute. A raised alert will be resolved if the CPU utilization goes below 60% for 1 minute.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml">...
    &lt;alert class=<span class="code-quote">"org.openspaces.admin.alert.config.CpuUtilizationAlertConfiguration"</span>
           enabled=<span class="code-quote">"true"</span>&gt;
        <span class="code-tag">&lt;property key=<span class="code-quote">"high-threshold-perc"</span> value=<span class="code-quote">"80"</span> /&gt;</span>
        <span class="code-tag">&lt;property key=<span class="code-quote">"low-threshold-perc"</span> value=<span class="code-quote">"60"</span> /&gt;</span>
        <span class="code-tag">&lt;property key=<span class="code-quote">"measurement-period-milliseconds"</span> value=<span class="code-quote">"60000"</span> /&gt;</span>
    <span class="code-tag">&lt;/alert&gt;</span>
...</pre>
</div></div>

<p>The <b><tt>class</tt></b> attribute above is the implementation class used to configure the settings of this alert. When configuring <b><tt>enabled="false"</tt></b> alerts of this type will not be triggered, until enabled again (at runtime, see below).</p>

<p>Note that some alert triggers define that an alert is raised each time a certain high threshold is crossed for example. This means that can be are multiple raised alerts at the same time, each indicating its own utilization reading at the time it was triggered. On the other hand, there can only be one resolving alert, which 'resolves' the already raised alert/s.</p>

<p>Since GigaSpaces XAP is working in a distributed environment, an alert is identified with a specific component (machine, JVM, Space, etc., <a href="#AdministrativeAlerts-alertevent">see below</a> for more details)</p>

<h1><a name="AdministrativeAlerts-ListeningforAlerts"></a>Listening for Alerts</h1>

<p>Alerts can be consumed using a registered event listener by registereing with the <tt>AlertManager</tt> component (which is part of the <a href="Administration and Monitoring API.html" title="Administration and Monitoring API">Administration and Monitoring API</a>. The listener will be notified of alerts that have been triggered.</p>

<p>Javadoc ref: <a href="http://www.gigaspaces.com/docs/JavaDoc8.0/org/openspaces/admin/alert/Alert.html">Alert </a>&nbsp;<a href="http://www.gigaspaces.com/docs/JavaDoc8.0/org/openspaces/admin/alert/AlertManager.html">AlertManager </a>&nbsp;<a href="http://www.gigaspaces.com/docs/JavaDoc8.0/org/openspaces/admin/alert/config/parser/XmlAlertConfigurationParser.html">XmlAlertConfigurationParser</a>&nbsp;<a href="http://www.gigaspaces.com/docs/JavaDoc8.0/org/openspaces/admin/alert/events/AlertTriggeredEventListener.html">AlertTriggeredEventListener</a></p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">Admin admin = <span class="code-keyword">new</span> AdminFactory().createAdmin();

 AlertManager alertManager = admin.getAlertManager();

 alertManager.configure(<span class="code-keyword">new</span> XmlAlertConfigurationParser(<span class="code-quote">"alerts.xml"</span>).parse());
        
 alertManager.getAlertTriggered().add(<span class="code-keyword">new</span> AlertTriggeredEventListener() {

            <span class="code-keyword">public</span> void alertTriggered(Alert alert) {
                <span class="code-object">System</span>.out.println(alert);
            }
 });</pre>
</div></div>

<div class='panelMacro'><table class='infoMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Alert XML Configuration</b><br />The <tt>"alerts.xml"</tt> file argument specifies the file which holds the configuration settings. <br/>
The file argument can be:
<ul>
	<li>a direct path (e.g. /export/user/my-alerts.xml) or,</li>
	<li>a file in the classpath or,</li>
	<li>a file under config/alerts/ in the classpath.</li>
</ul>
</td></tr></table></div>

<p>The default parser parses the XML file. If needed, you can implement a different parser (see 
<a href="http://www.gigaspaces.com/docs/JavaDoc8.0/org/openspaces/admin/alert/config/parser/AlertConfigurationParser.html" target="_blank">AlertConfigurationParser</a> interface).<br/>
The <tt>alertTriggered</tt> method is called upon each alert triggered.</p>


<h1><a name="AdministrativeAlerts-TheAlertEvent"></a>The Alert Event</h1>

<p>The <tt>org.openspaces.admin.alert.Alert</tt> instance includes the following set of properties:</p>

<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> Name </th>
<th class='confluenceTh'> Description </th>
<th class='confluenceTh'> Value </th>
</tr>
<tr>
<td class='confluenceTd'> Description </td>
<td class='confluenceTd'> The readable description of the alert </td>
<td class='confluenceTd'> e.g. CPU Utilization crossed a threshold of 80% </td>
</tr>
<tr>
<td class='confluenceTd'> Timestamp </td>
<td class='confluenceTd'> The date and time of the alert occurred </td>
<td class='confluenceTd'> <tt>System.currentTimeMillis()</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> Severity </td>
<td class='confluenceTd'> The alert severity </td>
<td class='confluenceTd'> <tt>SEVERE, WARNING, INFO</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> Status </td>
<td class='confluenceTd'> The alert status </td>
<td class='confluenceTd'> <tt>ESCALATED, <b>RAISED</b>, SUPPRESSED, <b>RESOLVED</b>, NA</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> UID </td>
<td class='confluenceTd'> A unique indetifier for this alert </td>
<td class='confluenceTd'> component hash code with an incrementing number </td>
</tr>
<tr>
<td class='confluenceTd'> Component UID </td>
<td class='confluenceTd'> The grid component UID that the alert has been triggered for </td>
<td class='confluenceTd'> e.g. "service-id: 15f4b0b4-3a78-413f-bd3a-429a50dcdf05" </td>
</tr>
<tr>
<td class='confluenceTd'> Group UID </td>
<td class='confluenceTd'> A unique identifier for a set of alerts triggered for the same component,<br clear="all" />e.g. two different machines will have a different group UID if their CPU utilization <br clear="all" />raised an alert.But for each machine, the raised alerts and resolved <br clear="all" />alert for CPU utilization will have the same group UID </td>
<td class='confluenceTd'> e.g. "aafb1222-826c3cbb-73c6-4903-bdc1-d858f1324e12" </td>
</tr>
<tr>
<td class='confluenceTd'> Config </td>
<td class='confluenceTd'> The configuration properties set for this alert </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> Properties </td>
<td class='confluenceTd'> Any runtime properties that could be extracted and are relevant information for this alert </td>
<td class='confluenceTd'> e.g. host name, host address, memory utilization,etc. </td>
</tr>
</tbody></table>

<p>Javadoc ref: <a href="http://www.gigaspaces.com/docs/JavaDoc8.0/org/openspaces/admin/alert/AlertSeverity.html">AlertSeverity </a>&nbsp;<a href="http://www.gigaspaces.com/docs/JavaDoc8.0/org/openspaces/admin/alert/AlertStatus.html">AlertStatus </a></p>

<h1><a name="AdministrativeAlerts-RuntimeConfiguration"></a>Runtime Configuration</h1>

<p>Alerts can also be configured at runtime. Alert configuration settings can be changed for a predefined alert type. An already enabled alert type will need to be disabled prior to setting a new configuration. Also, a predefined but disabled alert can be enabled.</p>

<h2><a name="AdministrativeAlerts-Reconfigureapredefinedalert"></a>Re-configure a predefined alert</h2>
<p>For a predefined alert, you can do so by obtaining the current configuration, changing the settings and re-configuring the <tt>AlertManager</tt>.<br/>
In the background, the enabled alert will be disabled, set and re-enabled with the new configuration.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">CpuUtilizationAlertConfiguration config = alertManager.getConfig(CpuUtilizationAlertConfiguration.class);
config.setHighThresholdPerc(85);
alertManager.configure(config);</pre>
</div></div>

<h2><a name="AdministrativeAlerts-EnableaDisabledPredefinedAlert"></a>Enable a Disabled Predefined Alert</h2>
<p>For a predefined but disabled alert, here's how to enable it. The configuration settings that were predefined will be used.</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">alertManager.enableAlert(CpuUtilizationAlertConfiguration.class);</pre>
</div></div>

<h2><a name="AdministrativeAlerts-Configureandenableapredefineddisabledalert"></a>Configure and enable a predefined disabled alert</h2>
<p>If predefined settings need to be changed, get the configuration, change the settings, enable and re-configure.</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">CpuUtilizationAlertConfiguration config = alertManager.getConfig(CpuUtilizationAlertConfiguration.class);
config.setHighThresholdPerc(85);
config.setEnabled(<span class="code-keyword">true</span>); <span class="code-comment">//don't forget
</span>alertManager.configure(config);</pre>
</div></div>

<h2><a name="AdministrativeAlerts-ConfigureanUndefinedAlert"></a>Configure an Undefined Alert</h2>
<p>For an alert which wasn't defined in the original set of alerts, create a new configuration with required settings and call configure.</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">CpuUtilizationAlertConfiguration config = <span class="code-keyword">new</span> CpuUtilizationAlertConfiguration();
config.setHighThresholdPerc(85);
config.setLowThresholdPerc(70);
config.setMeasurementPeriod(60, TimeUnit.SECONDS);
config.setEnabled(<span class="code-keyword">true</span>);
alertManager.configure(config);</pre>
</div></div>

<h2><a name="AdministrativeAlerts-DisableaPredefinedEnabledAlert"></a>Disable a Predefined Enabled Alert</h2>
<p>Too disable an existing alert (yet keep its configuration), use the following code:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">alertManager.disableAlert(CpuUtilizationAlertConfiguration.class);</pre>
</div></div>

                     </td>
</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td height="12" background="http://www.gigaspaces.com/wiki/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
</tr>
<tr>
<td align="center"><font color="grey"><a href="http://www.gigaspaces.com">GigaSpaces.com</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xwBmAg" class="smalltext">Legal Notice</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xgBmAg" class="smalltext">3rd Party Licenses</a> -
		<a href="http://www.gigaspaces.com/wiki/x/BQFmAg" class="smalltext">Site Map</a> -
		<a href="http://www.gigaspaces.com/wiki/display/API/API+Documentation+Portal" class="version-link">API Docs</a> -
		<a href="http://forum.openspaces.org/forum.jspa?forumID=175" class="version-link">Forum</a> -
		<a href="http://www.gigaspaces.com/LatestProductVersion" class="version-link">Downloads</a> -
		<a href="http://blog.gigaspaces.com/" class="version-link">Blog</a> -
		<a href="http://www.gigaspaces.com/os_papers.html" class="version-link">White Papers</a> -
		<a href="mailto:techw@gigaspaces.com">Contact Tech Writing</a> -
		<i><a href="http://www.atlassian.com/software/confluence">Gen. by Atlassian Confluence</a></i></font></td>
</tr>
</table>
     </body>
</html>
