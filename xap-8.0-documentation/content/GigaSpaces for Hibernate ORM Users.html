<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
     <head>
         <title>XAP 8.0 Documentation : GigaSpaces for Hibernate ORM Users</title>
<link rel="stylesheet" href="styles/site.css" type="text/css" />
         <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
		 <style>
.back-to {
	color: #666666;
	font-weight: bold;
}	 
a.back-to:link, a.back-to:visited, a.back-to:hover, a.back-to:active  {
	color: #666666;
}	 
		 </style>
     </head>

     <body>
<table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
<tr>
<td valign="top" class="pagebody">
<div class="pageheader">
<span class="back-to">XAP 8.0 Documentation > <a href="index.html">Back to Table of Contents</a></span><br>
<h1>GigaSpaces for Hibernate ORM Users</h1>
</div>
<br>

<script type='text/javascript'>//<![CDATA[
function debug() { }
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/browser.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/behaviour.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/memory.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/cloak.js'>//<![CDATA[
// ]]></script><script type='text/javascript'>//<![CDATA[
Cloak.closeHTML = "<img src=\'/wiki/download/resources/net.customware.confluence.plugin.composition:toggle-cloak/img/navigate_down_10.gif\'/>";
Cloak.openHTML = "<img src=\'/wiki/download/resources/net.customware.confluence.plugin.composition:toggle-cloak/img/navigate_right_10.gif\'/>";
Cloak.toggleZone = true;
Cloak.memoryDuration = 0;
Cloak.memoryPrefix = "contentId:53903677";
Cloak.memoryPath = "/wiki/";
// ]]></script><style type='text/css'>
.cloakToggle { /* Definition for state toggling image */
cursor:hand;
cursor:pointer;
}
</style><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/transitions.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/deck.js'>//<![CDATA[
// ]]></script><link rel='stylesheet' type='text/css'  href='/wiki/styles/main-action.css?pluginCompleteKey=net.customware.confluence.plugin.composition:composition-setup&stylesheetName=deck&spaceKey=XAP8'/><script type='text/javascript'>//<![CDATA[
Deck.memoryDuration = 0;
Deck.memoryPrefix = "contentId:53903677";
Deck.memoryPath = "/wiki/";
// ]]></script>


<div style="border-style:solid; border-color:#3C78B5; border-width:thin; padding-left:20px; padding-bottom:20px; padding-top:20px; padding-right:20px; background-color:#D8E4F1"> 

<p><b>Section Summary:</b>  Using GigaSpaces as a Hibernate cache provider; creating a Hibernate-integrated Data Grid with your existing ORM. </p>
</div>

<p><a name="GigaSpacesforHibernateORMUsers-1"></a></p>
<h1><a name="GigaSpacesforHibernateORMUsers-Overview"></a>Overview</h1>

<p>This page explains how you can use GigaSpaces eXtreme Application Platform (XAP) to:</p>
<ul>
	<li><b>Get a free 2nd-level distributed cache</b> for your <a href="http://www.hibernate.org">Hibernate</a>-based database integration</li>
	<li><b>Scale up your database using the existing ORM</b> by adding a GigaSpaces Data Grid with back-end Hibernate integration</li>
</ul>


<p>GigaSpaces as Hibernate 2nd level cache provides:</p>
<ul class="alternate" type="square">
	<li>Unlimited cache capacity</li>
	<li>All activities be monitored/profiled in real-time</li>
	<li>Built-in support for replicated and/or partitioned cache topology</li>
	<li>Built-in support for embedded or remote cache</li>
	<li>Built-in dynamic scalability</li>
	<li>Built-in High-Availability support</li>
	<li>Built-in Spring integration</li>
	<li>Built-in WAN replication</li>
	<li>Built-in security</li>
	<li>Built-in deployment environment</li>
	<li>Built-in alerting system</li>
</ul>


<p>Read further in this section for more details about these solutions, or jump to detailed instructions: <a href="#GigaSpacesforHibernateORMUsers-step1">how to get a free distributed second-level cache</a> or <a href="#GigaSpacesforHibernateORMUsers-step2">how to add a GigaSpaces data grid</a>.</p>

<p><img class="emoticon" src="images/icons/emoticons/information.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> GigaSpaces fully supports the <a href="http://www.springframework.org">Spring Framework</a>, and can be plugged in very easily without changing your existing code.</p>

<h2><a name="GigaSpacesforHibernateORMUsers-TheExistingArchitecture"></a>The Existing Architecture</h2>

<p>Your existing Hibernate-based database integration probably looks like the following: the application uses Hibernate to persist its data directly to the database.</p>

<p><img src="download/attachments/17301573/Hibernate with EhCache.jpg" align="absmiddle" border="0"/></p>

<h2><a name="GigaSpacesforHibernateORMUsers-Step1%3AGettingaFreeDistributedTwoLevelCache"></a>Step 1: Getting a Free Distributed Two-Level Cache</h2>

<p>You can very easily replace your existing Hibernate cache provider, typically EHCache, with GigaSpaces. This gives you a powerful distributed cache with multiple clients.</p>

<p><img src="download/attachments/17301573/HB for community.jpg" align="absmiddle" border="0"/></p>

<p><b>Benefits:</b></p>
<ul>
	<li><b>Powerful distributed cache</b> &#45; multiple clients, each client's updates can be accessed by all other clients</li>
	<li><b>Effortless integration</b> using Spring</li>
</ul>


<p><img class="emoticon" src="images/icons/emoticons/information.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> To learn how to do this, see <a href="#GigaSpacesforHibernateORMUsers-step1">How to Switch Your Second-Level Cache Provider to GigaSpaces</a> below.</p>

<h2><a name="GigaSpacesforHibernateORMUsers-Step2%3AScalingUpYourDatabasebyAddingaDataGrid"></a>Step 2: Scaling Up Your Database by Adding a Data Grid</h2>

<p>If you need to scale up your database, you can use GigaSpaces as an In-Memory Data Grid. Your application communicates with the Data Grid using <a href="The GigaSpace Interface.html" title="The GigaSpace Interface">The GigaSpace Interface</a> or <a href="The GigaMap Interface.html" title="The GigaMap Interface">The GigaMap Interface</a> interfaces. On the back-end, GigaSpaces persists the data to your existing database using your existing Hibernate O/R mapping in <a href="Asynchronous Persistency with the Mirror.html" title="Asynchronous Persistency with the Mirror">asynchronous manner</a>.</p>

<p><img src="download/attachments/17301573/Hibernate DataGrid.jpg" align="absmiddle" border="0"/></p>

<p><b>Benefits:</b></p>
<ul>
	<li><b>Database scalability</b> through partitioning and data distribution - enables higher data volumes and higher throughput with low latency</li>
	<li><b>Better decoupling</b> between your application and the database - no need to hard-wire Hibernate and database concepts into your code and runtime environment</li>
	<li><b>Event-driven</b> model enables notifications when data is modified</li>
	<li><b>Database access can be synchronous or asynchronous</b> &#45; the <a href="Asynchronous Persistency with the Mirror.html" title="Asynchronous Persistency with the Mirror">GigaSpaces Mirror Service</a> allows data to be persisted to the database asynchronously, without a performance penalty</li>
</ul>


<p><img class="emoticon" src="images/icons/emoticons/information.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> To learn how to do this, see the <a href="http://www.gigaspaces.com/wiki/display/SBP/Moving+from+Hibernate+to+Space" title="Moving from Hibernate to Space">Moving from Hibernate to Space</a> best practice.</p>

<h2><a name="GigaSpacesforHibernateORMUsers-BeyondtheDataGrid%3AScalingOutYourApplicationUsingSpaceBasedArchitecture"></a>Beyond the Data Grid: Scaling Out Your Application Using Space-Based Architecture</h2>

<p>To gain ultimate scalability for your application, you can package your business logic together with the GigaSpaces space - which provides not only data but also messaging functionality. This creates a Processing Unit which is completely self sufficient (not dependent on a database, messaging server or any central component), meaning that you to duplicate it as many times as necessary without increasing complexity.</p>

<p>This approach is called Space Based Architecture, and the way to achieve it is the Spring-based OpenSpaces platform, which allows you to deploy your application as a set of services encased in a Processing Unit.</p>

<p><img src="download/attachments/19890517/referto.gif" align="absmiddle" border="0"/> <b>To get started with SBA and Open Spaces</b> see our <a href="http://www.gigaspaces.com/wiki/display/GS6/Extreme+Application+Platform+Tutorial" title="Extreme Application Platform Tutorial">eXtreme Application Platform Tutorial</a>.</p> 

<p><img src="download/attachments/19890517/referto.gif" align="absmiddle" border="0"/> To learn more about Space-Based Architecture and its implications, read our white paper, <a href="http://www.gigaspaces.com/WhitePapers">The Scalability Revolution: From Dead End to Open Road</a>.</p> 

<p><img src="download/attachments/19890517/referto.gif" align="absmiddle" border="0"/> To learn more about OpenSpaces, see the <a href="Product Architecture.html#ProductArchitecture-ProductArchitectureOpenSpacesAPIandComponents">OpenSpaces</a> section in this online help.</p> 

<p><a name="GigaSpacesforHibernateORMUsers-step1"></a></p>

<h1><a name="GigaSpacesforHibernateORMUsers-HowtoSwitchYourCacheProvidertoGigaSpacesandGainDistributedCaching"></a>How to Switch Your Cache Provider to GigaSpaces and Gain Distributed Caching</h1>

<p>This section provides instructions on switching your existing Hibernate local cache, typically EhCache, with GigaSpaces. This will give you a powerful distributed cache with multiple clients and advanced clustering.<br/>
<img src="download/attachments/17301573/TwoSteps.jpg" align="absmiddle" border="0"/><br/>
<b>To switch your Hibernate cache provider to GigaSpaces and use GigaSpaces distributed caching:</b><br/>
1. Download the GigaSpaces (<img src="download/attachments/53903503/referto.gif" align="absmiddle" border="0"/> <a href="http://www.gigaspaces.com/os_faq.html">Product FAQ</a> <img src="download/attachments/53903503/referto.gif" align="absmiddle" border="0"/> <a href="http://www.gigaspaces.com/os_downloads.html#g">Download Page</a>)<br/>
2. Install GigaSpaces. If you need help, refer to the <a href="Installing GigaSpaces.html" title="Installing GigaSpaces">installation instructions</a>.<br/>
3. This step is different if you are managing your Hibernate configuration using Spring (refer to the Spring documentation, ORM Data Access&#42;** , section 12.2.2), or directly using <tt>hibernate.properties</tt> or <tt>hibernate.cfg.xml</tt>. Select the relevant tab below.
<br clear="all" />
<br clear="all" /></p>

<div class="panel" style="background-color: #FFFFFF;border-color: #3C78B5;border-style: solid;border-width: 1px;"><div class="panelContent" style="background-color: #FFFFFF;">
<h5><a name="GigaSpacesforHibernateORMUsers-SpringConfiguration"></a>Spring Configuration</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<p><b>Spring Configuration</b>
<br clear="all" />
<br clear="all" />
Edit your SessionFactory Setup. This is the section inside your Spring Application Context File that controls the relevant Hibernate configuration (refer to the <a href="http://static.springframework.org/spring/docs/2.5.x/reference/orm.html">Spring documentation, ORM Data Access</a> , section 12.2.2).<br/>
<b>Add or modify</b> the following properties under <tt>&lt;property name="hibernateProperties"&gt;</tt>:</p>
<div class="indent20 inline" style="margin-left: 20px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><p>&bull;&nbsp; Set <tt>hibernate.cache.provider_class</tt> to <tt>org.openspaces.hibernate.cache.SimpleMapCacheProvider</tt>:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag">&lt;prop key=<span class="code-quote">"hibernate.cache.provider_class"</span>&gt;</span>
	org.openspaces.hibernate.cache.SimpleMapCacheProvider<span class="code-tag">&lt;/prop&gt;</span></pre>
</div></div> 
<p>&bull;&nbsp; Set <tt>hibernate.cache.use_second_level_cache</tt> to <tt>true</tt>:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag">&lt;prop key=<span class="code-quote">"hibernate.cache.use_second_level_cache"</span>&gt;</span>true<span class="code-tag">&lt;/prop&gt;</span></pre>
</div></div>
<p>&bull;&nbsp; Set <tt>gigaspace.hibernate.cache.url</tt> to <tt>/./dataGrid</tt>:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag">&lt;prop key=<span class="code-quote">"gigaspace.hibernate.cache.url"</span>&gt;</span>/./dataGrid<span class="code-tag">&lt;/prop&gt;</span></pre>
</div></div></div>


<h5><a name="GigaSpacesforHibernateORMUsers-DirectConfiguration%28hibernate.properties%29"></a>Direct Configuration (hibernate.properties)</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<p><b>Direct Configuration (hibernate.properties</b></p>

<p>Edit your <tt>hibernate.properties</tt> file. <b>Add or modify</b> the following properties in the Second-Level Cache section:</p>
<div class="indent20 inline" style="margin-left: 20px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><p>&bull;&nbsp; Set <tt>hibernate.cache.provider_class</tt> to <tt>org.openspaces.hibernate.cache.SimpleMapCacheProvider</tt>:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>hibernate.cache.provider_class org.openspaces.hibernate.cache.SimpleMapCacheProvider
</pre>
</div></div>
<p>&bull;&nbsp; Set <tt>hibernate.cache.use_second_level_cache</tt> to <tt>true</tt>:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>hibernate.cache.use_second_level_cache true
</pre>
</div></div>
<p>&bull;&nbsp; Set <tt>gigaspace.hibernate.cache.url</tt> to <tt>/./dataGrid</tt>:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>gigaspace.hibernate.cache.url /./dataGrid
</pre>
</div></div></div>


<h5><a name="GigaSpacesforHibernateORMUsers-DirectConfiguration%28hibernate.cfg.xml%29"></a>Direct Configuration (hibernate.cfg.xml)</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<p><b>Direct Configuration (hibernate.cfg.xml)</b>
<br clear="all" />
<br clear="all" />
Edit your <tt>hibernate.cfg.xml</tt> file. <b>Add or modify</b> the following properties under <tt>&lt;session-factory&gt;</tt>:</p>
<div class="indent20 inline" style="margin-left: 20px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><p>&bull;&nbsp; Set <tt>hibernate.cache.provider_class</tt> to <tt>org.openspaces.hibernate.cache.SimpleMapCacheProvider</tt>:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag">&lt;property name=<span class="code-quote">"hibernate.cache.provider_class"</span>&gt;</span>
	org.openspaces.hibernate.cache.SimpleMapCacheProvider<span class="code-tag">&lt;/property&gt;</span></pre>
</div></div> 
<p>&bull;&nbsp; Set <tt>hibernate.cache.use_second_level_cache</tt> to <tt>true</tt>:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag">&lt;property name=<span class="code-quote">"hibernate.cache.use_second_level_cache"</span>&gt;</span>true<span class="code-tag">&lt;/property&gt;</span></pre>
</div></div>
<p>&bull;&nbsp; Set <tt>gigaspace.hibernate.cache.url</tt> to <tt>/./dataGrid</tt>:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag">&lt;property name=<span class="code-quote">"gigaspace.hibernate.cache.url"</span>&gt;</span>/./dataGrid<span class="code-tag">&lt;/property&gt;</span></pre>
</div></div></div>
</div></div>
<div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>See all Hibernate second level Cache implementation listed below:
<ul class="alternate" type="square">
	<li><a href="http://www.gigaspaces.com/docs/JavaDoc7.1/org/openspaces/hibernate/cache/SimpleGigaMapCacheProvider.html">org.openspaces.hibernate.cache.SimpleGigaMapCacheProvider</a></li>
	<li><a href="http://www.gigaspaces.com/docs/JavaDoc7.1/org/openspaces/hibernate/cache/SimpleMapCacheProvider.html">org.openspaces.hibernate.cache.SimpleMapCacheProvider</a></li>
	<li><a href="http://www.gigaspaces.com/docs/JavaDoc7.1/org/openspaces/hibernate/cache/TransactionalGigaMapCacheProvider.html">org.openspaces.hibernate.cache.TransactionalGigaMapCacheProvider</a></li>
	<li><a href="http://www.gigaspaces.com/docs/JavaDoc7.1/org/openspaces/hibernate/cache/TransactionalMapCacheProvider.html">org.openspaces.hibernate.cache.TransactionalMapCacheProvider</a></li>
</ul>
</td></tr></table></div>
<p>4. Set or add the cache usage (the cache concurrency strategy) in your mapping resource file (<tt>*.hbm.xml</tt> files) to <tt>read-only</tt>, <tt>read-write</tt> or <tt>nonstrict-read-write</tt>:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag">&lt;class name=<span class="code-quote">"your.class.name"</span> table=<span class="code-quote">"YourTableName"</span>&gt;</span>
     <span class="code-tag">&lt;cache usage=<span class="code-quote">"nonstrict-read-write"</span>/&gt;</span></pre>
</div></div>
<p>Alternatively, use the <tt>&lt;class-cache&gt;</tt> and <tt>&lt;collection-cache&gt;</tt> elements in your hibernate configuration file.</p>

<p>You must include the following JARs from the Hibernate distribution package:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>jdbc2_0-stdext.jar; dom4j-XXX.jar; commons-collections-XXX.jar; asm.jar; asm-attrs.jar;
antlr-XXX.jar; ejb3-persistence.jar; hibernate3.jar; hibernate-annotations.jar; 
hibernate-commons-annotations.jar
</pre>
</div></div>
<p>5. Since your Hibernate objects and their custom type will be eventually be serialized across to wire stored on remote space or replicated into a backup space In-Memoery, these need to be serialized. You should make all your Hibernate objects and their custom fields will be implementing <tt>Serializable</tt>.<br/>
6. Launch your application. The application should instantiate a local cache based on an embedded GigaSpaces space.<br/>
<img src="download/attachments/17301573/Hibernate with embedded gs.jpg" align="absmiddle" border="0"/><br/>
7. If you want to use GigaSpaces as a distributed cache, select the distributed topology that interests you from the tabs below.</p>

<div class="panel" style="background-color: #FFFFFF;border-color: #3C78B5;border-style: solid;border-width: 1px;"><div class="panelContent" style="background-color: #FFFFFF;">
<h5><a name="GigaSpacesforHibernateORMUsers-RemoteCache"></a>Remote Cache</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<p><b>Remote Cache Topology</b><br/>
In this topology each application accessing a remote cache.</p>
<div class="indent40 inline" style="margin-left: 40px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><p><img src="download/attachments/17301573/HB Remote GS.jpg" align="absmiddle" border="0"/></p></div>
<p><b>To use the remote cache topology:</b></p>
<ul class="alternate" type="square">
	<li>Set your <tt>gigaspaces.hibernate.cache.url</tt> property to
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>jini://*/*/dataGrid
</pre>
</div></div></li>
	<li>Copy <tt>dom4j.jar</tt> and <tt>hibernate3.jar</tt> and all relevant Hibernate distribution package libraries into the <tt>&lt;GigaSpaces Root&gt;/lib/platform/ext</tt> folder.</li>
	<li>Run <tt>&lt;GigaSpaces Root&gt;\bin\gs-agent.bat (.sh)</tt> to start the GigaSpaces <a href="The Runtime Environment.html" title="The Runtime Environment">runtime environment</a>.</li>
	<li>Run the deploy command to deploy the remote space:
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>&lt;GigaSpaces root&gt;\bin\gs.bat deploy-space datagrid
</pre>
</div></div>
<p>Wait to see the following output:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>Found 1 GSMs
Deploying [datagrid] with name [datagrid] under groups [gigaspaces-7.1.2-XAPPremium-ga] and locators []
SLA Not Found in PU.  Using Default SLA.
Waiting for [1] processing unit instances to be deployed...
[datagrid] [1] deployed successfully on [10.10.254.1]
Finished deploying [1] processing unit instances
</pre>
</div></div></li>
	<li>Run your application.</li>
</ul>



<h5><a name="GigaSpacesforHibernateORMUsers-MasterLocalCache"></a>Master-Local Cache</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<p><b>Master-Local Cache Topology</b><br/>
In this topology each application has a lightweight, embedded cache, which is initially empty. The first time data is read, it is loaded from a master cache to the local cache (lazy load); the next time the same data is read, it is loaded quickly from the local cache. Later on data is either updated from the master or evicted from the cache.</p>
<div class="indent40 inline" style="margin-left: 40px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><p><img src="download/attachments/17301573/HB for community.jpg" align="absmiddle" border="0"/></p></div>
<p><b>To use the master-local topology:</b></p>
<ul class="alternate" type="square">
	<li>Set your <tt>gigaspaces.hibernate.cache.url</tt> property to
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>jini://*/*/dataGrid?useLocalCache
</pre>
</div></div></li>
	<li>Copy <tt>dom4j.jar</tt> and <tt>hibernate3.jar</tt> and all relevant Hibernate distribution package libraries into the <tt>&lt;GigaSpaces Root&gt;/lib/platform/ext</tt> folder.</li>
	<li>Run <tt>&lt;GigaSpaces Root&gt;\bin\gs-agent.bat (.sh)</tt> to start the GigaSpaces <a href="The Runtime Environment.html" title="The Runtime Environment">runtime environment</a>.</li>
	<li>Run the deploy command to deploy the master space:
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>&lt;GigaSpaces root&gt;\bin\gs.bat deploy-space datagrid
</pre>
</div></div></li>
</ul>


<p>Wait to see the following output:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>Found 1 GSMs
Deploying [datagrid] with name [datagrid] under groups [gigaspaces-7.1.2-XAPPremium-ga] and locators []
SLA Not Found in PU.  Using Default SLA.
Waiting for [1] processing unit instances to be deployed...
[datagrid] [1] deployed successfully on [10.10.254.1]
Finished deploying [1] processing unit instances
</pre>
</div></div>
<ul class="alternate" type="square">
	<li>Run your application.</li>
</ul>



<h5><a name="GigaSpacesforHibernateORMUsers-PartitionedMasterLocalCache"></a>Partitioned Master-Local Cache</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<p><b>Partitioned Master-Local Cache Topology</b><br/>
In this topology, data is split between two spaces (partitions) according to an index field defined in the data. An algorithm, defined in the load-balancing policy, maps values of the index field to specific partitions.<br/>
<img class="emoticon" src="images/icons/emoticons/information.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> This topology requires XAP Premium Edition.</p>
<div class="indent40 inline" style="margin-left: 40px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><p><img src="download/attachments/17301573/HB Master Local Partitioned GS.jpg" align="absmiddle" border="0"/></p></div>
<p><b>To use the master-local partitioned topology with two partitions:</b></p>
<ul class="alternate" type="square">
	<li>Configure your <tt>gigaspaces.hibernate.cache.url</tt> property to:
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>jini://*/*/dataGrid?useLocalCache
</pre>
</div></div></li>
	<li>Copy <tt>dom4j.jar</tt> and <tt>hibernate3.jar</tt> from Hibernate distribution package into the <tt>&lt;GigaSpaces Root&gt;/lib/platform/ext</tt> folder.</li>
	<li>Run <tt>&lt;GigaSpaces Root&gt;\bin\gs-agent.bat (.sh)</tt> to start the GigaSpaces <a href="The Runtime Environment.html" title="The Runtime Environment">runtime environment</a>.</li>
	<li>Run the deploy command to deploy the master space in cluster of two partitions topology:
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>&lt;GigaSpaces root&gt;\bin\gs.bat deploy-space -cluster schema=partitioned total_members=2,0 datagrid
</pre>
</div></div></li>
</ul>


<p>Wait to see the following output:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>gs&gt; deploy-space -cluster schema=partitioned total_members=2,0 datagrid
Found 1 GSMs
Deploying [datagrid] with name [datagrid] under groups [gigaspaces-7.1.2-XAPPremium-ga] and locators []
SLA Not Found in PU.  Using Default SLA.
Overrding SLA cluster schema with [partitioned]
Overrding SLA numberOfInstances with [2]
Overrding SLA numberOfBackups with [0]
Waiting for [2] processing unit instances to be deployed...
[datagrid] [1] deployed successfully on [10.10.254.1]
[datagrid] [2] deployed successfully on [10.10.254.1]
Finished deploying [2] processing unit instances
</pre>
</div></div>

<ul class="alternate" type="square">
	<li>Run your application.</li>
</ul>



<h5><a name="GigaSpacesforHibernateORMUsers-EmbeddedReplicatedCache"></a>Embedded Replicated Cache</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<p><b>Embedded Replicated Cache Topology</b><br/>
This topology consists of two or more space instances with replication between them, allowing two or more applications to work with their own dedicated data store, while working on the same data as the other applications.<br/>
<img class="emoticon" src="images/icons/emoticons/information.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> This topology requires XAP Premium Edition.</p>

<div class="indent40 inline" style="margin-left: 40px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><p><img src="download/attachments/17301573/Hibernate with 2 emedded replicated.jpg" align="absmiddle" border="0"/></p></div>
<p><b>To use the embedded replicated topology with two replicated instances:</b></p>
<ul class="alternate" type="square">
	<li>In your first application, configure the <tt>gigaspaces.hibernate.cache.url</tt> property to the following (as one long line):
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>/./dataGrid?cluster_schema=sync_replicated&amp;amp;total_members=2&amp;amp;id=1
</pre>
</div></div> </li>
	<li>Run your first application.</li>
	<li>In your second application, configure your <tt>gigaspaces.hibernate.cache.url</tt> property to the following (as one long line):
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>/./dataGrid?cluster_schema=sync_replicated&amp;amp;total_members=2&amp;amp;id=2
</pre>
</div></div></li>
	<li>Run your second application.</li>
</ul>
</div></div>

<h2><a name="GigaSpacesforHibernateORMUsers-BasicGuidelines"></a>Basic Guidelines</h2>
<ul class="alternate" type="square">
	<li>For the application components that are read/write (up to 50% write/remove/update) you should have the hibernate 2nd local cache to use a remote partitioned space topology.</li>
	<li>For the application components that are read mostly (above 50% read) you should have the hibernate 2nd local cache to use a <a href="Local View and Local Cache.html" title="Local View and Local Cache">master local cache/view</a> with remote partitioned space topology.</li>
	<li>The embedded replicated cache topology is recommended only when having few client applications (up to 3) where the total amount of data can be accommodated within a single JVM and the application is 50% read/write.</li>
	<li>For the application components that are write mostly (above 50% write/remove/update), you should <b>not use hibernate API directly</b> , but move into the <a href="The GigaSpace Interface.html" title="The GigaSpace Interface">GigaSpace  Interface</a> and use the <a href="Asynchronous Persistency with the Mirror.html" title="Asynchronous Persistency with the Mirror">Mirror service</a> (if you still want to persist the data). In this case you can leverage <a href="SQLQuery.html" title="SQLQuery">SQLQuery</a> or <a href="Task Execution over the Space.html" title="Task Execution over the Space">Task Executors</a> for complex distributed activities. In this case you should use remote partitioned space topology.</li>
</ul>


<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>See the <a href="http://www.gigaspaces.com/wiki/display/SBP/Moving+from+Hibernate+to+Space" title="Moving from Hibernate to Space">Moving from Hibernate to Space</a> best practice for step by step instructions moving from Hibernate based application to GigaSpaces Data-Grid as the data access layer.</td></tr></table></div>

<h2><a name="GigaSpacesforHibernateORMUsers-SettingsGigaSpaceslocalcachewithHibernateSecondLevelCache"></a>Settings GigaSpaces local cache with Hibernate Second Level Cache</h2>
<p>When using Hibernate Second Level Cache you can configure also GigaSpaces local cache. See below an example for both:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">&lt;property name=<span class="code-quote">"hibernateProperties"</span>&gt; 
   &lt;props&gt; 
	&lt;prop key=<span class="code-quote">"hibernate.dialect"</span>&gt;org.hibernate.dialect.${jdbc.platform}Dialect&lt;/prop&gt; 
	&lt;prop key=<span class="code-quote">"hibernate.cache.provider_class"</span>&gt;${hibernate.cache.provider_class}&lt;/prop&gt; 
	&lt;prop key=<span class="code-quote">"hibernate.show_sql"</span>&gt;{hibernate.show_sql}&lt;/prop&gt; 
	&lt;prop key=<span class="code-quote">"hibernate.jdbc.batch_size"</span>&gt;${hibernate.jdbc.batch_size}&lt;/prop&gt; 
	&lt;prop key=<span class="code-quote">"hibernate.cache.use_query_cache"</span>&gt;<span class="code-keyword">true</span>&lt;/prop&gt; 
	&lt;prop key=<span class="code-quote">"hibernate.transaction.flush_before_completion"</span>&gt;<span class="code-keyword">true</span>&lt;/prop&gt; 
	&lt;prop key=<span class="code-quote">"hibernate.generate_statistics"</span>&gt;<span class="code-keyword">true</span>&lt;/prop&gt; 
	&lt;prop key=<span class="code-quote">"hibernate.cache.user_structured_entries"</span>&gt;<span class="code-keyword">true</span>&lt;/prop&gt; 
	&lt;prop key=<span class="code-quote">"hibernate.cache.use_query_cache"</span>&gt;<span class="code-keyword">true</span>&lt;/prop&gt; 
	&lt;prop key=<span class="code-quote">"hibernate.transaction.auto_close_session"</span>&gt;<span class="code-keyword">true</span>&lt;/prop&gt; 
	&lt;prop key=<span class="code-quote">"hibernate.connection.release_mode"</span>&gt;${hibernate.connection.release_mode}&lt;/prop&gt; 
	&lt;prop key=<span class="code-quote">"hibernate.cache.use_second_level_cache"</span>&gt;<span class="code-keyword">true</span>&lt;/prop&gt; 
	&lt;prop key=<span class="code-quote">"gigaspace.hibernate.cache.url"</span>&gt;jini:<span class="code-comment">//*/*/dataGrid?useLocalCache&lt;/prop&gt; 
</span>
	&lt;prop key=<span class="code-quote">"space-config.engine.cache_size"</span>&gt;5000000&lt;/prop&gt;
	&lt;prop key=<span class="code-quote">"space-config.engine.memory_usage.high_watermark_percentage"</span>&gt;65&lt;/prop&gt;
	&lt;prop key=<span class="code-quote">"space-config.engine.memory_usage.write_only_block_percentage"</span>&gt;63&lt;/prop&gt;
	&lt;prop key=<span class="code-quote">"space-config.engine.memory_usage.write_only_check_percentage"</span>&gt;60&lt;/prop&gt;
	&lt;prop key=<span class="code-quote">"space-config.engine.memory_usage.low_watermark_percentage"</span>&gt;55&lt;/prop&gt;
	&lt;prop key=<span class="code-quote">"space-config.engine.memory_usage.eviction_batch_size"</span>&gt;1000&lt;/prop&gt;
	&lt;prop key=<span class="code-quote">"space-config.engine.memory_usage.retry_yield_time"</span>&gt;100&lt;/prop&gt;
	&lt;prop key=<span class="code-quote">"space-config.engine.memory_usage.retry_count"</span>&gt;20&lt;/prop&gt;
   &lt;/props&gt; 
&lt;/property&gt;</pre>
</div></div>

<h1><a name="GigaSpacesforHibernateORMUsers-GigaSpacesHibernate2ndLevelCacheProperties"></a>GigaSpaces Hibernate 2nd Level Cache Properties</h1>

<p>GigaSpaces Hibernate 2nd Level Cache controlled via the following system properties:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>Property</th>
<th class='confluenceTh'>Description</th>
<th class='confluenceTh'>Default</th>
<th class='confluenceTh'>Mandatory?</th>
</tr>
<tr>
<td class='confluenceTd'>gigaspace.hibernate.cache.url</td>
<td class='confluenceTd'>  <a href="Space URL.html" title="Space URL">Space URL</a> String. This could be remote (clustered space) with/without a local cache/view URL or embedded space URL. Examples: <div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">jini:<span class="code-comment">//*/*/mySpace</span></pre>
</div></div></td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> YES </td>
</tr>
<tr>
<td class='confluenceTd'>gigaspace.hibernate.cache.timeToLive</td>
<td class='confluenceTd'> Time in ms for the cached Hibernate object to live within the space. When you would like to evict Hibernate objects form the space based on a specific time duration, you should set this value.</td>
<td class='confluenceTd'> <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html#MAX_VALUE">Long.MAX_VALUE</a> </td>
<td class='confluenceTd'> NO </td>
</tr>
<tr>
<td class='confluenceTd'>gigaspace.hibernate.cache.waitForResponse</td>
<td class='confluenceTd'> Time in ms to wait for a matching object to be written into the space when reading object from the space. When having transactional hibernate configuration you might want to increase this value to allow GigaSpaces to wait for locked objects under a transaction to be committed before rejecting the read operation. A value of 60000 (60 second) might be relevant in such cases.</td>
<td class='confluenceTd'> 0 </td>
<td class='confluenceTd'> NO </td>
</tr>
</tbody></table>

                     </td>
</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td height="12" background="http://www.gigaspaces.com/wiki/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
</tr>
<tr>
<td align="center"><font color="grey"><a href="http://www.gigaspaces.com">GigaSpaces.com</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xwBmAg" class="smalltext">Legal Notice</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xgBmAg" class="smalltext">3rd Party Licenses</a> -
		<a href="http://www.gigaspaces.com/wiki/x/BQFmAg" class="smalltext">Site Map</a> -
		<a href="http://www.gigaspaces.com/wiki/display/API/API+Documentation+Portal" class="version-link">API Docs</a> -
		<a href="http://forum.openspaces.org/forum.jspa?forumID=175" class="version-link">Forum</a> -
		<a href="http://www.gigaspaces.com/LatestProductVersion" class="version-link">Downloads</a> -
		<a href="http://blog.gigaspaces.com/" class="version-link">Blog</a> -
		<a href="http://www.gigaspaces.com/os_papers.html" class="version-link">White Papers</a> -
		<a href="mailto:techw@gigaspaces.com">Contact Tech Writing</a> -
		<i><a href="http://www.atlassian.com/software/confluence">Gen. by Atlassian Confluence</a></i></font></td>
</tr>
</table>
     </body>
</html>
