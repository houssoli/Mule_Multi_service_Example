<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
     <head>
         <title>XAP 8.0 Documentation : JPA Entity Id</title>
<link rel="stylesheet" href="styles/site.css" type="text/css" />
         <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
		 <style>
.back-to {
	color: #666666;
	font-weight: bold;
}	 
a.back-to:link, a.back-to:visited, a.back-to:hover, a.back-to:active  {
	color: #666666;
}	 
		 </style>
     </head>

     <body>
<table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
<tr>
<td valign="top" class="pagebody">
<div class="pageheader">
<span class="back-to">XAP 8.0 Documentation > <a href="index.html">Back to Table of Contents</a></span><br>
<h1>JPA Entity Id</h1>
</div>
<br>



<div style="border-style:solid; border-color:#3C78B5; border-width:thin; padding-left:20px; padding-bottom:20px; padding-top:20px; padding-right:20px; background-color:#D8E4F1"> 

<p><b>Section Summary:</b>  This page explains the various supported options for mapping the identifier property of your JPA enntities. </p>
</div>

<h1><a name="JPAEntityId-UserDefinedId"></a>User-Defined Id</h1>
<p>In this case, the Entity's Id must be set manually in the user code before attempting to persist the entity.</p>
<div class='panelMacro'><table class='infoMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>Reminder: GigaSpaces <tt>@SpaceId</tt> annotation should also be defined on the property defined with JPA's <tt>@Id</tt> annotation</td></tr></table></div>
<p>Example of user defined Id:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">@Entity
<span class="code-keyword">public</span> class Car {
  <span class="code-keyword">private</span> <span class="code-object">Long</span> id;

  <span class="code-keyword">public</span> Car() {
  }

  <span class="code-comment">//both @Id and @SpaceId should be defined 
</span>  @Id
  @SpaceId
  <span class="code-keyword">public</span> <span class="code-object">Long</span> getId() {
    <span class="code-keyword">return</span> <span class="code-keyword">this</span>.id;
  }

  /* Additional Getters &amp; Setters */

}</pre>
</div></div>

<p>Before persisting a Car entity, we have to set its Id property:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java"><span class="code-comment">// Create a <span class="code-keyword">new</span> Car instance
</span>Car car = <span class="code-keyword">new</span> Car();
<span class="code-comment">// Set its Id property
</span>car.setId(100);

<span class="code-comment">// Persist
</span>EntityManager em = emf.createEntityManager();
em.getTransaction().begin();

em.persist(car);

em.getTransaction().commit();
em.close();</pre>
</div></div>

<h1><a name="JPAEntityId-AutoGeneratedId"></a>Auto-Generated Id</h1>
<p>An Auto-Generated Id is an Id generated by GigaSpaces.<br/>
In order to specify that an Id is auto-generated, we'll use JPA's @GeneratedValue annotation and set GigaSpaces @SpaceId's autoGenerate attribute to true:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">@Entity
<span class="code-keyword">public</span> class Form {
  <span class="code-comment">// The auto-generated property can only be a <span class="code-object">String</span>
</span>  <span class="code-keyword">private</span> <span class="code-object">String</span> id;

  <span class="code-keyword">public</span> Form() {
  }

  @Id
  @GeneratedValue
  @SpaceId(autoGenerate = <span class="code-keyword">true</span>)
  <span class="code-keyword">public</span> <span class="code-object">String</span> getId() {
    <span class="code-keyword">return</span> <span class="code-keyword">this</span>.id;
  }

  /* Additional Getters &amp; Setters */

}</pre>
</div></div>

<p>When persisting a Form entity, we don't need set its Id property:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java"><span class="code-comment">// Create a <span class="code-keyword">new</span> Car instance
</span>Form form = <span class="code-keyword">new</span> Form();

<span class="code-comment">// Persist
</span>EntityManager em = emf.createEntityManager();
em.getTransaction().begin();

em.persist(form);

em.getTransaction().commit();
em.close();

<span class="code-comment">// Print the auto-generated Id
</span><span class="code-object">System</span>.out.println(form.getId());</pre>
</div></div>

<div class='panelMacro'><table class='warningMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/forbidden.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>Auto Generated Id Limitations:
<ul>
	<li>When using an auto-generated Id, the Id property type must be of type: java.lang.String.</li>
	<li>An auto-generated Id can only be set on an owner entity if its a part of a relation.</li>
</ul>
</td></tr></table></div>

<h1><a name="JPAEntityId-CompoundObjectId%7B%7B@EmbeddedId%7D%7D"></a>Compound Object Id - <tt>@EmbeddedId</tt></h1>
<p>A compound object Id is an Entity Id which is not a primitive type or a primitive type wrapper.<br/>
It's defined using JPA's <tt>@EmbeddedId</tt> annotation.<br/>
Note that the class that uses the compound the Id should adhere to the following requirements:</p>
<ol>
	<li>There should be no <tt>@Id</tt> annotation when the <tt>@EmbeddedId</tt> annotation is used.</li>
	<li>The <tt>@EmbeddedId</tt> annotated property's type should have an <tt>@Embeddable</tt> annotation &amp; implement <tt>Serializable</tt>.</li>
</ol>


<p>Lets examine the following example:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java"><span class="code-comment">// This class will be used as an EmbeddedId 
</span>@Embeddable
<span class="code-keyword">public</span> class ComplexObjectId <span class="code-keyword">implements</span> Serilizable {
  <span class="code-keyword">private</span> <span class="code-keyword">static</span> <span class="code-keyword">final</span> <span class="code-object">long</span> serialVersionUID = 1L;
  <span class="code-keyword">private</span> <span class="code-object">Integer</span> number;
  <span class="code-keyword">private</span> <span class="code-object">String</span> text;

  <span class="code-keyword">public</span> ComplexObjectId() {
  }

  <span class="code-keyword">public</span> ComplexObjectId(<span class="code-object">Integer</span> number, <span class="code-object">String</span> text) {
    <span class="code-keyword">this</span>.number = number;
    <span class="code-keyword">this</span>.text = text;
  }

  <span class="code-comment">// An Embeddable class which is used as an EmbeddedId should implement
</span>  <span class="code-comment">// toString() having a unique returned value.
</span>  @Override
  <span class="code-keyword">public</span> <span class="code-object">String</span> toString() {
    <span class="code-keyword">return</span> number.toString() + text;
  }

}

<span class="code-comment">// An entity with an EmbeddedId
</span>@Entity
<span class="code-keyword">public</span> class MyObject {
  <span class="code-keyword">private</span> ComplexObjectId id;

  <span class="code-keyword">public</span> MyObject() {
  }

  @EmbeddedId
  @SpaceId
  <span class="code-keyword">public</span> ComplexObjectId getId() {
    <span class="code-keyword">return</span> <span class="code-keyword">this</span>.id;
  }

  <span class="code-keyword">public</span> void setId(ComplexObjectId id) {
    <span class="code-keyword">this</span>.id = id;
  }

  /* Additional Getters &amp; Setters */

}</pre>
</div></div>

<h5><a name="JPAEntityId-Usageexample%3A"></a>Usage example:</h5>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">ComplexObjectId id = <span class="code-keyword">new</span> ComplexObjectId(100, <span class="code-quote">"1234"</span>);
MyObject myObject = <span class="code-keyword">new</span> MyObject();
myObject.setId(id);

<span class="code-comment">// Persist
</span>EntityManager em = emf.createEntityManager();
em.getTransaction().begin();
em.persist(myObject);
em.getTransaction().commit();
em.close();

<span class="code-comment">// Find
</span>em = emf.createEntityManager();
myObject = (MyObject) em.find(MyObject.class, id);
em.close();</pre>
</div></div>

<h1><a name="JPAEntityId-Limitations"></a>Limitations</h1>
<h5><a name="JPAEntityId-%7B%7B@GeneratedValue%7D%7D"></a><tt>@GeneratedValue</tt></h5>
<p>Only <tt>GenerationType.AUTO</tt> is supported for the <tt>GeneratedValue.strategy()</tt> attribute.</p>

<h5><a name="JPAEntityId-MultiValueIds"></a>Multi Value Ids</h5>
<p>Setting an <tt>@Id/@EmbeddedId</tt> annotation for more than one property is not supported hence the <tt>@IdClass</tt> annotation is not supported.</p>


                     </td>
</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td height="12" background="http://www.gigaspaces.com/wiki/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
</tr>
<tr>
<td align="center"><font color="grey"><a href="http://www.gigaspaces.com">GigaSpaces.com</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xwBmAg" class="smalltext">Legal Notice</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xgBmAg" class="smalltext">3rd Party Licenses</a> -
		<a href="http://www.gigaspaces.com/wiki/x/BQFmAg" class="smalltext">Site Map</a> -
		<a href="http://www.gigaspaces.com/wiki/display/API/API+Documentation+Portal" class="version-link">API Docs</a> -
		<a href="http://forum.openspaces.org/forum.jspa?forumID=175" class="version-link">Forum</a> -
		<a href="http://www.gigaspaces.com/LatestProductVersion" class="version-link">Downloads</a> -
		<a href="http://blog.gigaspaces.com/" class="version-link">Blog</a> -
		<a href="http://www.gigaspaces.com/os_papers.html" class="version-link">White Papers</a> -
		<a href="mailto:techw@gigaspaces.com">Contact Tech Writing</a> -
		<i><a href="http://www.atlassian.com/software/confluence">Gen. by Atlassian Confluence</a></i></font></td>
</tr>
</table>
     </body>
</html>
