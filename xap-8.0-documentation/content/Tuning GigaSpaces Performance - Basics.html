<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
     <head>
         <title>XAP 8.0 Documentation : Tuning GigaSpaces Performance - Basics</title>
<link rel="stylesheet" href="styles/site.css" type="text/css" />
         <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
		 <style>
.back-to {
	color: #666666;
	font-weight: bold;
}	 
a.back-to:link, a.back-to:visited, a.back-to:hover, a.back-to:active  {
	color: #666666;
}	 
		 </style>
     </head>

     <body>
<table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
<tr>
<td valign="top" class="pagebody">
<div class="pageheader">
<span class="back-to">XAP 8.0 Documentation > <a href="index.html">Back to Table of Contents</a></span><br>
<h1>Tuning GigaSpaces Performance - Basics</h1>
</div>
<br>



<div style="border-style:solid; border-color:#3C78B5; border-width:thin; padding-left:20px; padding-bottom:20px; padding-top:20px; padding-right:20px; background-color:#D8E4F1"> 

<p><b>Section Summary:</b>  Helpful recommendations for tuning GigaSpaces, boosting its performance, and improving its scalability.</p>

</div>
<h1><a name="TuningGigaSpacesPerformance-Basics-Overview"></a>Overview</h1>

<p>This section lists helpful recommendations for tuning the GigaSpaces, boosting its performance, and improving its scalability.</p>

<h1><a name="TuningGigaSpacesPerformance-Basics-DesignYourSpaceClass"></a>Design Your Space Class</h1>
<p>Pay attention to the size of your Entries &#8211; do you really need all this information in the space? The bigger your Entries, the longer it takes to move them around, store them to disk, and fetch them back. Consider replacing a heavyweight blob field with a simple string URL, and use it later for fetching on demand. Contact GigaSpaces support for an example of this pattern. If you are using user-defined classes for your Space Class fields, try efficiently implementing <a href="Externalizable Support.html" title="Externalizable Support">java.io.Externalizable</a> with these classes. This will reduce the amount of data transferred over the network and written/read to/from the database, saving both time and space.</p>
<h1><a name="TuningGigaSpacesPerformance-Basics-Makeproperuseofindexes"></a>Make proper use of indexes </h1>
<p>GigaSpaces includes a sophisticated built-in indexing module (regardless whether the space is persistent or not) that maintains index list data for each indexed Space Class attribute. If you keep a large number of Space objects from the same class in the space, consider defining one or more indexes for attributes used with template matching. Defining indexes will improve the <tt>read/take/clear</tt> operations response time significantly, up to ten to fifty times faster. Remember, indexes influence <tt>write/update</tt> operations response time, so choose your indexed fields carefully - each index has an overhead. GigaSpaces offers <a href="Indexing.html" title="Indexing">implicit indexing</a> and <a href="Indexing.html" title="Indexing">explicit indexing</a>.</p>

<h1><a name="TuningGigaSpacesPerformance-Basics-BlockingTakeandThreadConsumption"></a>Blocking Take and Thread Consumption </h1>
<p>When performing blocking operations &#8211; read or take with timeout &gt;0, it is recommended to set the operation timeout for short durations (5-30 seconds), and not to <tt>FOREVER</tt>. </p>

<p>This allows the space's internal thread pool to balance the different requests without exhausting all pending operations thread pool. </p>

<h1><a name="TuningGigaSpacesPerformance-Basics-UseBatchOperations"></a>Use Batch Operations </h1>
<p>Batch operations (<tt>writeMultiple, readMultiple, takeMultiple, updateMultiple</tt>) perform actions on groups of Entries in one call. Instead of paying a penalty for every entry (remote call, database access, ...) you pay it only once. Try to design your hot spots around batch operations - this can drastically improve your application performance, up to ten to fifty times faster.</p>
<h1><a name="TuningGigaSpacesPerformance-Basics-UseTransactionsCautiously"></a>Use Transactions Cautiously</h1>
<p>Each transaction has an overhead. Do not use read under a transaction if you do not have a very good reason to do so. Use non-transactional read instead. This reduces database access for persistent spaces and eliminates transaction locks. If you really need to do some operations inside a transaction, use batch operations with transactions.</p>
<h1><a name="TuningGigaSpacesPerformance-Basics-QueryOptimizations"></a>Query Optimizations</h1>
<p>When using the or logical operation together with and operations as part of your query (JDBC , JavaSpaces with SQLQuery) you can speed up the query execution by having the and conditions added to each or condition.<br/>
For example:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">select uid,* from table where (A = 'X' or A = 'Y') and (B &gt; '2000-10-1' and B &lt; '2003-11-1')</pre>
</div></div>
<p>would be executed much faster when changing it to be:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">select uid,* from table where (A = 'X' and B &gt; '2000-10-1' and B &lt; '2003-11-1') 
or (A = 'Y' and B &gt; '2000-10-1' and B &lt; '2003-11-1')</pre>
</div></div>
<h1><a name="TuningGigaSpacesPerformance-Basics-UseanEmbeddedSpaceifPossible"></a>Use an Embedded Space if Possible </h1>
<p>If you access the space from a single JVM, or access it a large number of times from one JVM, use the embedded space mode. This eliminates the overhead of remote calls to the space. The slower your network compared to other resources (for example, a disk), the greater will be the noticeable improvement.</p>
<h1><a name="TuningGigaSpacesPerformance-Basics-UseUpdateInsteadofTakeandWrite"></a>Use Update Instead of Take and Write</h1>
<p>If you need to modify entry data, use update instead of take+ write. This saves you an extra call on the space.</p>
<h1><a name="TuningGigaSpacesPerformance-Basics-DistributeDataandUserRequestsamongSeveralSpaces"></a>Distribute Data and User Requests among Several Spaces </h1>
<p>A single machine is always limited in the amount of data and user requests it can handle.</p>

<p>You can use several spaces in a cluster in order to distribute the load and partial replication that partitions the data.</p>

<h1><a name="TuningGigaSpacesPerformance-Basics-MemoryUsageConsiderations"></a>Memory Usage Considerations </h1>
<p><b>Here are several guidelines to reduce the client and space server memory footprint:</b></p>
<ul>
	<li><tt>ClientUIDHandler</tt> and Jini UID factory produces lots of <tt>String/char[]</tt> objects at the client side. Use these very carefully.</li>
	<li>In order to reduce memory consumption, you can store multiple <tt>long/integer</tt> Entry attribute values as part of a <tt>long/integer array</tt>. If you have lots of entries this will improve the server footprint.</li>
	<li>Use indexes only for attributes used for matching. Make sure your space uses the <tt>-1</tt> value for the space implicit indexing property. This will ensure that indexes will be created upon request only.</li>
	<li>Make sure the statistics filter is turned off.</li>
	<li>Make sure all space workers are turned off.</li>
	<li>If you do not need <tt>Lease</tt> objects use the <tt>NOWriteLease=true</tt> as part of the URL.</li>
	<li>Consider using object pools.
	<ul>
		<li><a href="http://www.javaworld.com/javaworld/jw-06-1998/jw-06-object-pool.html">http://www.javaworld.com/javaworld/jw-06-1998/jw-06-object-pool.html</a></li>
		<li><a href="http://www.developer.com/java/ent/article.php/626171">http://www.developer.com/java/ent/article.php/626171</a></li>
	</ul>
	</li>
	<li>Encapsulates all non-indexed field into an inner custom class and have all <tt>primitive class</tt> (Integer,Long,..) fields as part of the inner class with primitive types (int, long).</li>
	<li>Replace string entry public fields with a custom implementation, which only supports basic ascii subset (backed with byte).</li>
	<li>Replaced string fields with a small number of possible (source for instance) values with enum.</li>
	<li>Indexes footprint can be reduced by directing the system to work in Economy mode. The downside of working in Economy mode is a performance penalty of up to 15% in embedded space operations. In order to work in Economy mode set space-config.engine.use_economy_hashmap=true.</li>
</ul>


<h1><a name="TuningGigaSpacesPerformance-Basics-ChooseLocalTransactionsOverDistributedTransactions"></a>Choose Local Transactions Over Distributed Transactions </h1>
<p><a href="Transaction Management.html#TransactionManagement-DistributedJiniTransactionManager">Distributed Transactions</a> perform a lengthy 2PC process. <a href="Transaction Management.html#TransactionManagement-LocalJiniTransactionManager">Local Transactions</a>, in contrast, perform a 1PC process. If you are performing some operations under a transaction on a single space, use local transactions. The slower your network compared to other resources (for example, a disk), the greater will be the noticeable improvement.</p>

<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>For more details on transaction support, refer to the <a href="Transaction Management.html" title="Transaction Management">Transaction Management</a> section.</td></tr></table></div>

<h1><a name="TuningGigaSpacesPerformance-Basics-UsingSnapshottoReduceObjectCreationandEntryDataInspection"></a>Using Snapshot to Reduce Object Creation and Entry Data Inspection</h1>
<p>When using the same template for matching, consider using a snapshot template. A snapshot template is the result object of the <tt>JavaSpace.snapshot</tt> call. The returned result includes GigaSpaces internal representation of the template object that does not need to undergo any inspection before it is sent to the GigaSpaces server.</p>

<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>The snapshot returns an object you can use for subsequent matching as a template.</td></tr></table></div>

<h1><a name="TuningGigaSpacesPerformance-Basics-DetermineCacheSize"></a>Determine Cache Size</h1>
<p>When using persistent space and reusing data, you must take caching into account. The cache manager caches space objects for use and performs an LRU (Least Recent Use) based cleanup on the cache. When searching for a space object , the cache is searched first. Set the cache size to the number of Space objects that your environment can reasonably contain as resident in the VM heap size. This will prevent unnecessary queries on your database. If you want the cache size to be based on the JVM running the space you may use the memory usage options.</p>
<h1><a name="TuningGigaSpacesPerformance-Basics-DetermineDatabaseConnectionPools"></a>Determine Database Connection Pools</h1>
<p>When using persistent space and a large number of users/threads access the space concurrently, each of them requires a database connection. Set enough connections in the connection pool so that users won't be blocked. You should calculate the number of concurrent requests the space needs to handle based on the number of users that will access the space simultaneously.</p>

<h1><a name="TuningGigaSpacesPerformance-Basics-BenchmarkingYourTuning"></a>Benchmarking Your Tuning</h1>
<p>The Benchmark View provides a user interface for benchmarking the space. </p>
<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>For more details, refer to:
<ul>
	<li><a href="Benchmark View - GigaSpaces Browser.html" title="Benchmark View - GigaSpaces Browser">Benchmark View</a></li>
	<li><a href="Benchmark Utility - GigaSpaces CLI.html" title="Benchmark Utility - GigaSpaces CLI">Benchmark Example</a></li>
</ul>
</td></tr></table></div>

                     </td>
</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td height="12" background="http://www.gigaspaces.com/wiki/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
</tr>
<tr>
<td align="center"><font color="grey"><a href="http://www.gigaspaces.com">GigaSpaces.com</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xwBmAg" class="smalltext">Legal Notice</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xgBmAg" class="smalltext">3rd Party Licenses</a> -
		<a href="http://www.gigaspaces.com/wiki/x/BQFmAg" class="smalltext">Site Map</a> -
		<a href="http://www.gigaspaces.com/wiki/display/API/API+Documentation+Portal" class="version-link">API Docs</a> -
		<a href="http://forum.openspaces.org/forum.jspa?forumID=175" class="version-link">Forum</a> -
		<a href="http://www.gigaspaces.com/LatestProductVersion" class="version-link">Downloads</a> -
		<a href="http://blog.gigaspaces.com/" class="version-link">Blog</a> -
		<a href="http://www.gigaspaces.com/os_papers.html" class="version-link">White Papers</a> -
		<a href="mailto:techw@gigaspaces.com">Contact Tech Writing</a> -
		<i><a href="http://www.atlassian.com/software/confluence">Gen. by Atlassian Confluence</a></i></font></td>
</tr>
</table>
     </body>
</html>
