<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
     <head>
         <title>XAP 8.0 Documentation : Configuring the Service Grid Using the services.config File</title>
<link rel="stylesheet" href="styles/site.css" type="text/css" />
         <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
		 <style>
.back-to {
	color: #666666;
	font-weight: bold;
}	 
a.back-to:link, a.back-to:visited, a.back-to:hover, a.back-to:active  {
	color: #666666;
}	 
		 </style>
     </head>

     <body>
<table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
<tr>
<td valign="top" class="pagebody">
<div class="pageheader">
<span class="back-to">XAP 8.0 Documentation > <a href="index.html">Back to Table of Contents</a></span><br>
<h1>Configuring the Service Grid Using the services.config File</h1>
</div>
<br>



<div style="border-style:solid; border-color:#3C78B5; border-width:thin; padding-left:20px; padding-bottom:20px; padding-top:20px; padding-right:20px; background-color:#D8E4F1"> 

<p><b>Section Summary:</b>  Configuring the Service Grid, using the services.config File. </p>
</div>

<h1><a name="ConfiguringtheServiceGridUsingtheservices.configFile-Overview"></a>Overview</h1>

<p>The <tt>services.config</tt> file (<em>&lt;GigaSpaces root&gt;/config/services/services.config</em>) contains configuration definitions for the following core services:</p>

<div class="error"><span class="error">Error formatting macro: toc: java.lang.NullPointerException</span> </div>

<p>This configuration is based on the <a href="http://java.sun.com/products/jini/2.0.2/doc/specs/api/net/jini/config/ConfigurationFile.html">Jini configuration specification</a>, a Java-based syntax that provides strict type definition and runtime configuration capabilities.</p>

<div class='panelMacro'><table class='warningMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/forbidden.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>Starting with XAP 7.0 the <tt>services.config</tt> has been deprecated. Its settings can be set using system properties (follows the [component name].[property name] notation). If the <tt>services.config</tt> is still needed to be used, the installation comes with <tt>services.config.template</tt> file, which can be renamed back to <tt>services.config</tt>. By renaming it, it will be taken into account.</td></tr></table></div>

<h1><a name="ConfiguringtheServiceGridUsingtheservices.configFile-SharedGridConfiguration"></a>Shared Grid Configuration</h1>

<p>Shared configurations (for both GSM and GSC) are located under the <tt>com.gigaspaces.grid</tt> configuration element in the services.config file.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">com.gigaspaces.grid{
    groups = <span class="code-keyword">new</span> <span class="code-object">String</span>[]{<span class="code-quote">"${com.gs.jini_lus.groups}"</span>};
    secured = <span class="code-object">Boolean</span>.getBoolean(<span class="code-quote">"com.gs.grid.secured"</span>);
}</pre>
</div></div>

<div class="indent20 inline" style="margin-left: 20px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> Property </th>
<th class='confluenceTh'> Value </th>
<th class='confluenceTh'> Description </th>
</tr>
<tr>
<td class='confluenceTd'> groups </td>
<td class='confluenceTd'> Sys.prop: com.gs.jini_lus.groups </td>
<td class='confluenceTd'> Jini's lookup service group; default set by <tt>bin/setenv</tt> script </td>
</tr>
<tr>
<td class='confluenceTd'> secured </td>
<td class='confluenceTd'> Sys.prop: com.gs.grid.secured (false/true) </td>
<td class='confluenceTd'> True if GSM and GSC should be loaded in secured mode; default false </td>
</tr>
</tbody></table></div>

<h1><a name="ConfiguringtheServiceGridUsingtheservices.configFile-GigaSpacesTransport"></a>GigaSpaces Transport</h1>

<p>The GigaSpaces LRMI Communication Protocol configuration defines the <b>default exporter</b> for services and utilities.<br/>
A more detailed description of how to configure the transport layer can be found <a href="Communication Protocol.html" title="Communication Protocol">here</a>.</p>

<p><tt>com.gigaspaces.transport</tt> is the configuration element in the the services.config file.</p>

<h1><a name="ConfiguringtheServiceGridUsingtheservices.configFile-GigaSpacesManager%28GSM%29"></a>GigaSpaces Manager (GSM)</h1>

<p>The GigaSpaces Manager (GSM) provides the support to deploy, manage and monitor services in the Service Grid.</p>

<p><tt>org.jini.rio.monitor</tt> is the configuration element in the services.config file.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">org.jini.rio.monitor {
    serviceResourceSelector = <span class="code-keyword">new</span> org.jini.rio.monitor.LeastActiveSelector();

    /* Set the groups to join */
    initialLookupGroups = BootUtil.toArray(<span class="code-quote">"${com.gs.jini_lus.groups}"</span>);

    <span class="code-comment">//NOTE: in order to enable the Jini Locators unicast discovery and registration, verify
</span>    <span class="code-comment">//the -Dcom.gs.jini_lus.locators=&lt;host:port&gt; is passed in the command line
</span>    initialLookupLocators= BootUtil.toLookupLocators(<span class="code-quote">"${com.gs.jini_lus.locators}"</span>);

    serviceName = <span class="code-quote">"Grid Service Manager"</span>;
    serviceComment = <span class="code-quote">"Grid Service Management"</span>;
    opStringName = <span class="code-quote">"Service Grid Infrastructure"</span>;
    jmxName = <span class="code-quote">"com.gigaspaces.grid:type=GSM"</span>;

    <span class="code-comment">// Delays next attempts to re-provision a service after it failed to allocate it on all of the
</span>    <span class="code-comment">// existing GSCs. If a <span class="code-keyword">new</span> GSC is brought up, a re-provision request will attempt immediately.
</span>    <span class="code-comment">// Otherwise, after the specified delay, it will retry to provision the service on all existing
</span>    <span class="code-comment">// GSCs. Default is 10 min.
</span>    pendingRequestDelay = 600000;

    /* Configure a FaultDetectionHandler <span class="code-keyword">for</span> the Grid Service Monitor */
    fdh = <span class="code-quote">"com.gigaspaces.grid.gsm.GSMFaultDetectionHandler"</span>;
    configArg = <span class="code-keyword">new</span> <span class="code-object">Object</span>[]{<span class="code-keyword">new</span> <span class="code-object">String</span>[]{
        <span class="code-quote">"-"</span>,
        <span class="code-quote">"com.gigaspaces.grid.gsm.GSMFaultDetectionHandler.invocationDelay=10000"</span>,
        <span class="code-quote">"com.gigaspaces.grid.gsm.GSMFaultDetectionHandler.retryCount=0"</span>}
    };
    faultDetectionHandler =
        <span class="code-keyword">new</span> org.jini.rio.core.ClassBundle(fdh,
                                          <span class="code-keyword">null</span>,  <span class="code-comment">// load from classpath
</span>                                          <span class="code-keyword">new</span> <span class="code-object">String</span>[]{<span class="code-quote">"setConfiguration"</span>},
                                          <span class="code-keyword">new</span> <span class="code-object">Object</span>[]{ configArg });
}</pre>
</div></div>

<h2><a name="ConfiguringtheServiceGridUsingtheservices.configFile-GSMFaultDetectionHandling"></a>GSM Fault-Detection Handling</h2>

<p>The <tt>GSMFaultDetectionHandler</tt> is used to monitor the reachability between GSMs.<br/>
A GSM acts as an active GSM for any deployments it initiated. In case of an abrupt termination, another GSM takes over the deployments, hence declaring an active state over them.</p>

<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> Property </th>
<th class='confluenceTh'> Value </th>
<th class='confluenceTh'> Description </th>
</tr>
<tr>
<td class='confluenceTd'> invocationDelay </td>
<td class='confluenceTd'> 10000 ms </td>
<td class='confluenceTd'> Delay between each monitoring invocation </td>
</tr>
<tr>
<td class='confluenceTd'> retryCount </td>
<td class='confluenceTd'> 0 </td>
<td class='confluenceTd'> Retries until a GSM is considered unreachable </td>
</tr>
<tr>
<td class='confluenceTd'> retryTimeout </td>
<td class='confluenceTd'> 1000 ms </td>
<td class='confluenceTd'> Delay between retries until a GSM is considered unreachable </td>
</tr>
</tbody></table>

<p>When a GSM fails to provision a service on all currently available GSCs, the next attempt to re-provision the service is delayed (as specified by <tt>pendingRequestDelay</tt>). If a new GSC is brought up during this time, then a re-provision attempt is initiated immediately.</p>

<h1><a name="ConfiguringtheServiceGridUsingtheservices.configFile-GigaSpacesContainer%28GSC%29"></a>GigaSpaces Container (GSC)</h1>

<p>The GigaSpaces Container (GSC) represents the capabilities of a compute resource, making the compute resource available as a service on the network, and provides a dynamic lightweight container to instantiate dynamic application services.</p>

<p><tt>com.gigaspaces.grid.gsc</tt> is the configuration element in the services.config file.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">com.gigaspaces.grid.gsc {
    initialLookupGroups = BootUtil.toArray(<span class="code-quote">"${com.gs.jini_lus.groups}"</span>);

    <span class="code-comment">//NOTE: in order to enable the Jini Locators unicast discovery and registration, verify
</span>    <span class="code-comment">//the -Dcom.gs.jini_lus.locators=&lt;host:port&gt; is passed in the command line
</span>    initialLookupLocators= BootUtil.toLookupLocators(<span class="code-quote">"${com.gs.jini_lus.locators}"</span>);
    
    serviceName = <span class="code-quote">"Grid Service Container"</span>;
    serviceComment = <span class="code-quote">"GigaSpace Technologies Dynamic Grid Service Container"</span>;
    provisionEnabled = <span class="code-object">Boolean</span>.valueOf(<span class="code-keyword">true</span>);
    opStringName = <span class="code-quote">"Service Grid Infrastructure"</span>;
    jmxName = <span class="code-quote">"com.gigaspaces.grid:type=GSC"</span>;

    nativeLibDirectory = <span class="code-keyword">new</span> <span class="code-object">String</span>[]{
                             <span class="code-quote">"${com.gigaspaces.grid.lib}${/}<span class="code-keyword">native</span>"</span>
                         };

    /* Configure a FaultDetectionHandler <span class="code-keyword">for</span> the Grid Service Container */
    fdh = <span class="code-quote">"com.gigaspaces.grid.gsc.GSCFaultDetectionHandler"</span>;
    configArg = <span class="code-keyword">new</span> <span class="code-object">Object</span>[]{<span class="code-keyword">new</span> <span class="code-object">String</span>[]{
        <span class="code-quote">"-"</span>,
        <span class="code-quote">"com.gigaspaces.grid.gsc.GSCFaultDetectionHandler.invocationDelay=10000"</span>,
        <span class="code-quote">"com.gigaspaces.grid.gsc.GSCFaultDetectionHandler.retryCount=0"</span>}
    };
    faultDetectionHandler =
        <span class="code-keyword">new</span> org.jini.rio.core.ClassBundle(fdh,
                                          <span class="code-keyword">null</span>,  <span class="code-comment">// load from classpath
</span>                                          <span class="code-keyword">new</span> <span class="code-object">String</span>[]{<span class="code-quote">"setConfiguration"</span>},
                                          <span class="code-keyword">new</span> <span class="code-object">Object</span>[]{ configArg });
}</pre>
</div></div>

<h2><a name="ConfiguringtheServiceGridUsingtheservices.configFile-GSCFaultDetectionHandling"></a>GSC Fault-Detection Handling</h2>

<p>The <tt>GSCFaultDetectionHandler</tt> is used by the GigaSpaces Management Center (UI) to monitor the reachability of a GSC.</p>

<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> Property </th>
<th class='confluenceTh'> Value </th>
<th class='confluenceTh'> Description </th>
</tr>
<tr>
<td class='confluenceTd'> invocationDelay </td>
<td class='confluenceTd'> 10000 ms </td>
<td class='confluenceTd'> Delay between each monitoring invocation </td>
</tr>
<tr>
<td class='confluenceTd'> retryCount </td>
<td class='confluenceTd'> 0 </td>
<td class='confluenceTd'> Retries until the UI considers a GSC as unreachable </td>
</tr>
<tr>
<td class='confluenceTd'> retryTimeout </td>
<td class='confluenceTd'> 1000 ms </td>
<td class='confluenceTd'> Delay between retries until the UI considers a GSC as unreachable </td>
</tr>
</tbody></table>

<h2><a name="ConfiguringtheServiceGridUsingtheservices.configFile-ServiceFaultDetectionHandling"></a>Service Fault-Detection Handling</h2>

<p>The <a href="Configuring the Processing Unit SLA.html#ConfiguringtheProcessingUnitSLA-livenessDetection">Member Alive Indicator SLA</a> is used to monitor the reachability between a GSM and a service deployed on a GSC. A service is managed by only one active GSM, through which the deployment initiated, but it is monitored by all GSMs. If a GSC has been abruptly terminated, only the active GSM is responsible for redeployment. </p>


<h1><a name="ConfiguringtheServiceGridUsingtheservices.configFile-JiniLookupService%28LUS%29"></a>Jini Lookup Service (LUS)</h1>

<p>The Jini lookup service configuration exposed in services.config, mainly defines the lookup groups and the lookup protocols.<br/>
A more detailed description of how to configure Jini reggie can be found <a href="http://java.sun.com/products/jini/2.1/doc/api/com/sun/jini/reggie/package-summary.html#configuration">here</a>.</p>

<p><tt>com.sun.jini.reggie</tt> is the configuration element in the services.config file.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">com.sun.jini.reggie {

    <span class="code-comment">//Specifies initial groups <span class="code-keyword">for</span> <span class="code-keyword">this</span> lookup service to be a member of.
</span>    initialMemberGroups = BootUtil.toArray(<span class="code-quote">"${com.gs.jini_lus.groups}"</span>);

    <span class="code-comment">//Specifies initial list of locators indicating other lookup services with which to register.
</span>    <span class="code-comment">//NOTE: in order to enable the Jini Locators unicast discovery and registration, verify
</span>    <span class="code-comment">//the -Dcom.gs.jini_lus.locators=&lt;host:port&gt; is passed in the command line
</span>    initialLookupLocators = BootUtil.toLookupLocators(<span class="code-quote">"${com.gs.jini_lus.locators}"</span>);

    <span class="code-comment">//Specifies the host name <span class="code-keyword">for</span> unicast discovery, which is advertised in multicast announcements
</span>    <span class="code-comment">//and unicast discovery responses.
</span>    unicastDiscoveryHost =
        BootUtil.getHostAddressFromProperty(<span class="code-quote">"java.rmi.server.hostname"</span>);

    <span class="code-comment">//Specifies the initial number of the port on which to listen <span class="code-keyword">for</span> unicast discovery queries.
</span>    <span class="code-comment">//If the port number is 0, then an arbitrary port is selected (with preference given to 4166, <span class="code-keyword">if</span> available). 
</span>    <span class="code-comment">//This entry is obtained once at service start
</span>    <span class="code-comment">//initialUnicastDiscoveryPort = 1222;
</span>
    <span class="code-comment">//Specifies initial attributes to use when registering with lookup services (including self)
</span>    initialLookupAttributes =
        <span class="code-keyword">new</span> net.jini.core.entry.Entry[] {
            <span class="code-keyword">new</span> net.jini.lookup.entry.Name(<span class="code-quote">"Lookup"</span>),
            <span class="code-keyword">new</span> org.jini.rio.entry.OperationalStringEntry(
                                               <span class="code-quote">"Service Grid Infrastructure"</span>)
        };

    <span class="code-comment">//Specifies the exporter to use to export <span class="code-keyword">this</span> service.
</span>    serverExporter = com.gigaspaces.transport.defaultExporter;

    <span class="code-comment">//A service's entry in the lookup is leased and kept until the next renewal attempt fails. This property
</span>    <span class="code-comment">//specifies the lower bound <span class="code-keyword">for</span> the maximum value allowed <span class="code-keyword">for</span> service leases, in milliseconds. Default 15 min.
</span>    minMaxServiceLease = 900000L;
	
    <span class="code-comment">//Internal Reggie task managers (applies to GigaRegistrar)
</span>    commTaskManager = <span class="code-keyword">new</span> com.sun.jini.thread.TaskManager(40, 15000, 2.0F, <span class="code-quote">"Reggie Comm Task"</span>, 10);
    eventTaskManagerPool = 5;
    eventTaskManager = <span class="code-keyword">new</span> com.sun.jini.thread.TaskManager(8, 15000, 2.0F, <span class="code-quote">"Reggie Event Task"</span>, 10);
    
    <span class="code-comment">//Specifies <span class="code-keyword">if</span> a cache miss should indicate the non existence of a Space service within reggie
</span>    useCacheForSpaceMiss = <span class="code-object">Boolean</span>.valueOf(<span class="code-keyword">true</span>);
}</pre>
</div></div>

<h1><a name="ConfiguringtheServiceGridUsingtheservices.configFile-JiniTransactionManager"></a>Jini Transaction Manager</h1>

<p>The Jini Transaction Manager configuration exposed in services.config mainly defines the lookup groups and the lookup protocols.<br/>
A more detailed description of how to configure mahalo can be found <a href="http://java.sun.com/products/jini/2.1/doc/api/com/sun/jini/mahalo/package-summary.html#configuration">here</a>.</p>

<p><tt>com.sun.jini.mahalo</tt> is the configuration element in the services.config file.</p>

<h1><a name="ConfiguringtheServiceGridUsingtheservices.configFile-QualityofService%28QoS%29"></a>Quality of Service (QoS)</h1>

<p>The quality of service section defines a set of measurable capabilities for a compute resource (e.g. a GSC). These specify how often the compute resource informs registered observers (e.g. a GSM) of a state change. A state change is determined if any of the <tt>MeasurableCapability</tt> components contained within this <tt>ComputeResource</tt>, provide an update in the interval specified.</p>

<p><tt>org.jini.rio.qos</tt> is the configuration element in the services.config file.</p>

<p>There are three measurable capabilities defined: CPU, memory and disk. These can be monitored using the Utilization tab in the GigaSpaces Management Center (UI). A GSM won't deploy to a GSC which has breached the QoS requirements, and relocates an already deployed service, if possible.</p>

<p><tt>com.gigaspaces.management.system.cpu</tt>,  <tt>com.gigaspaces.management.system.memory</tt>,  and <tt>com.gigaspaces.management.system.disk</tt> are the configuration elements in the services.config file.</p>

<p>This configuration defines the overall capability of a GSC, which can be overridden for each deployed service by specifying the <a href="Configuring the Processing Unit SLA.html" title="Configuring the Processing Unit SLA">service level agreement</a> (SLA).</p>

<div class="error"><span class="error">Error formatting macro: toc-zone: java.lang.NullPointerException</span> </div>

                     </td>
</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td height="12" background="http://www.gigaspaces.com/wiki/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
</tr>
<tr>
<td align="center"><font color="grey"><a href="http://www.gigaspaces.com">GigaSpaces.com</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xwBmAg" class="smalltext">Legal Notice</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xgBmAg" class="smalltext">3rd Party Licenses</a> -
		<a href="http://www.gigaspaces.com/wiki/x/BQFmAg" class="smalltext">Site Map</a> -
		<a href="http://www.gigaspaces.com/wiki/display/API/API+Documentation+Portal" class="version-link">API Docs</a> -
		<a href="http://forum.openspaces.org/forum.jspa?forumID=175" class="version-link">Forum</a> -
		<a href="http://www.gigaspaces.com/LatestProductVersion" class="version-link">Downloads</a> -
		<a href="http://blog.gigaspaces.com/" class="version-link">Blog</a> -
		<a href="http://www.gigaspaces.com/os_papers.html" class="version-link">White Papers</a> -
		<a href="mailto:techw@gigaspaces.com">Contact Tech Writing</a> -
		<i><a href="http://www.atlassian.com/software/confluence">Gen. by Atlassian Confluence</a></i></font></td>
</tr>
</table>
     </body>
</html>
