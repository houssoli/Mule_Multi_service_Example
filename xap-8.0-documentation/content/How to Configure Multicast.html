<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
     <head>
         <title>XAP 8.0 Documentation : How to Configure Multicast</title>
<link rel="stylesheet" href="styles/site.css" type="text/css" />
         <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
		 <style>
.back-to {
	color: #666666;
	font-weight: bold;
}	 
a.back-to:link, a.back-to:visited, a.back-to:hover, a.back-to:active  {
	color: #666666;
}	 
		 </style>
     </head>

     <body>
<table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
<tr>
<td valign="top" class="pagebody">
<div class="pageheader">
<span class="back-to">XAP 8.0 Documentation > <a href="index.html">Back to Table of Contents</a></span><br>
<h1>How to Configure Multicast</h1>
</div>
<br>



<div style="border-style:solid; border-color:#3C78B5; border-width:thin; padding-left:20px; padding-bottom:20px; padding-top:20px; padding-right:20px; background-color:#D8E4F1"> 

<p><b>Section Summary:</b>  Enabling multicast on Linux and windows.  </p>
</div>

<h1><a name="HowtoConfigureMulticast-Overview"></a>Overview</h1>

<p>Multicast is the delivery of information to a group of destinations simultaneously, using the most efficient strategy to deliver messages over each link of the network only once, and create copies only when the links to the destinations split.</p>

<p>The word "multicast" is typically used to refer to IP Multicast, the implementation of the multicast concept on the IP routing level, where routers create optimal spanning tree distribution paths for datagrams sent to a multicast destination address in realtime. However, there are also other implementations of the multicast distribution strategy listed below.<br/>
(Source - wikipedia: <a href="http://en.wikipedia.org/wiki/Multicast">http://en.wikipedia.org/wiki/Multicast</a>).</p>

<p>GigaSpaces uses multicast in the following cases:</p>
<ul>
	<li><a href="Deploying onto the Service Grid.html" title="Deploying onto the Service Grid">When deploying onto the service grid</a> GigaSpaces XAP uses multicast to discover the <a href="Lookup Service Configuration.html" title="Lookup Service Configuration">Lookup Service</a>, and register their proxies.</li>
	<li>Clients use multicast to discover the <a href="Lookup Service Configuration.html" title="Lookup Service Configuration">Lookup Service</a> and look up a matching service proxy (such as the space).</li>
</ul>


<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>What should I do in order to determine if multicast is enabled on my environment?</b><br />Refer to the <a href="How to Determine Whether Multicast is Available.html" title="How to Determine Whether Multicast is Available">How to Determine Whether Multicast is Available</a> section for more details.</td></tr></table></div>

<p>To enable the important capabilities above, you should enable multicast on machines running clients, spaces or services. <div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>What should I do if I can't enable multicast?</b><br />
<ul>
	<li>If you cannot enable multicast in your environment, you can use unicast discovery to allow services and clients to locate the Lookup Service.</li>
	<li>Space cluster replication uses unicast by default. You should use multicast replication when having more than 10 clients acting as replica spaces per target space.</li>
</ul>
</td></tr></table></div></p>

<p><img class="emoticon" src="images/icons/emoticons/warning.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> In case you want to <b>disable the Jini Lookup Service Multicast announcements</b> please refer to <a href="Lookup Service Configuration.html#LookupServiceConfiguration-MulticastSettings">this</a> section in the Wiki.</p>

<h1><a name="HowtoConfigureMulticast-ConfiguringMulticastonLinux"></a>Configuring Multicast on Linux</h1>

<p>In some cases, Linux distributions do not have multicast enabled by default and the <tt>/etc/hosts</tt> file does not include the IP address associated with the server's hostname. An error that is frequently met is: <tt>hostname associated with the localhost</tt> in <tt>/etc/hosts</tt>. The machine's hostname in <tt>/etc/hosts</tt> should be associated with the IP address set to the server's network interface, or to the external static NAT IP address of the server (the address clients should connect to).<br/>
Make sure the <tt>/etc/hosts</tt> has the machine's IP, together with the IP: <tt>127.0.0.1</tt>.</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">127.0.0.1        localhost
192.168.10.127   Mylinux</pre>
</div></div>

<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>Make sure all network machines can ping each other. You might need to list all the network machines' IPs as part of each machine's <tt>hosts</tt> file, or have a DHCP server configured.</td></tr></table></div>

<p>Before running GigaSpaces, make sure your network interface supports multicast, and the appropriate routes are properly configured.</p>

<p>To check if your network interface supports multicast, run the following <tt>ifconfig</tt>:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">$ /sbin/ifconfig -a
eth0      Link encap:Ethernet  HWaddr 00:30:48:2E:67:BA
          inet addr:192.168.10.127  Bcast:192.168.10.255  Mask:255.255.255.0
          inet6 addr: fe80::230:48ff:fe2e:67ba/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:89049707 errors:34 dropped:0 overruns:0 frame:34
          TX packets:79402911 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:24029278032 (22.3 GiB)  TX bytes:52438225932 (48.8 GiB)
          Base address:0x3000 Memory:dc300000-dc320000

eth1      Link encap:Ethernet  HWaddr 00:30:48:2E:67:BB
          inet addr:192.168.0.1  Bcast:192.168.0.255  Mask:255.255.255.0
          inet6 addr: fe80::230:48ff:fe2e:67bb/64 Scope:Link
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)
          Base address:0x3040 Memory:dc320000-dc340000

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:1366770822 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1366770822 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:319301580062 (297.3 GiB)  TX bytes:319301580062 (297.3 GiB)

sit0      Link encap:IPv6-in-IPv4
          NOARP  MTU:1480  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)</pre>
</div></div>
<p>If the <tt>MULTICAST</tt> attribute in the fourth line of the <tt>eth0</tt> properties is not present, it's possible that your kernel has not been compiled with multicast support. Before re-compiling the kernel, try enabling multicast on your network interface (<tt>eth0</tt> in this case) via <tt>ifconfig</tt>:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">$ /sbin/ifconfig etho multicast</pre>
</div></div>
<p>To check that multicast routing is configured, run the following <tt>route</tt> command:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">$ /sbin/route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
192.168.0.0     0.0.0.0         255.255.255.0   U     0      0        0 eth1
192.168.10.0    0.0.0.0         255.255.255.0   U     0      0        0 eth0
169.254.0.0     0.0.0.0         255.255.0.0     U     0      0        0 eth1
224.0.0.0       0.0.0.0         240.0.0.0       U     0      0        0 eth0
0.0.0.0         192.168.10.1    0.0.0.0         UG    0      0        0 eth0</pre>
</div></div>
<p>If the destination <tt>224.0.0.0</tt> entry is not present, you need to enable multicast routing.</p>

<p>To enable multicast routing, run the following <tt>route</tt> command as <b>root</b>:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">$ /sbin/route -n add -net 224.0.0.0 netmask 240.0.0.0 dev eth0</pre>
</div></div><div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>On Redhat systems you can configure this route statically via the network setup configuration tools &#8211; see:<br/>
<a href="http://www.redhat.com/docs/manuals/linux/RHL-7.2-Manual/custom-guide/ch-network-config.html">redhat - Chapter 6. Network Configuration</a>. </td></tr></table></div>
<p>Alternatively, try executing the command above as part of a startup script in <tt>/etc/rc.d/&#42;</tt>. <div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>For more details on Linux <tt>ifconfig</tt> and <tt>route</tt> commands, refer to:
<ul>
	<li><a href="http://linux.about.com/od/commands/l/blcmdl8_ifconfi.htm">http://linux.about.com/od/commands/l/blcmdl8_ifconfi.htm</a></li>
	<li><a href="http://linux.about.com/od/commands/l/blcmdl8_route.htm">http://linux.about.com/od/commands/l/blcmdl8_route.htm</a></li>
</ul>
</td></tr></table></div></p>

<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><a href="http://www.ethereal.com/docs/man-pages/tcpdump.8.html">tcpdump</a> is another useful command which dumps traffic on a network:  
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">tcpdump -i eth0 ip multicast</pre>
</div></div> </td></tr></table></div>

<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td> By default multicast is not allowed between the virtual machines, so the unicast should be configured instead </td></tr></table></div>

<h1><a name="HowtoConfigureMulticast-ConfiguringMulticastonWindows"></a>Configuring Multicast on Windows</h1>

<p>To enable multicasting from a token ring on a Windows® 2000 workstation to any Windows 98/NT machine, set the <tt>TrFunctionalMcastAddress</tt> parameter to <tt>0</tt> in the Windows 2000 registry:</p>
<ol>
	<li>Click <b>Start</b> &gt; <b>Run</b> on the Windows 2000 taskbar.</li>
	<li>In the <b>Open</b> field, select or type <b>REGEDIT</b>.</li>
	<li>Click <b>OK</b>. The <b>Registry Editor</b> window opens.</li>
	<li>Click <b>HKEY_LOCAL_Machine</b> &gt; <b>SYSTEM</b> &gt; <b>CurrentControlSet</b> &gt; <b>Services</b> &gt; <b>Tcpip</b> &gt; <b>Parameters</b>.</li>
	<li>Right-click <b>TrFunctionalMcastAddress</b>, and click <b>Modify</b>. The <b>Edit DWORD Value</b> window opens.</li>
	<li>In the <b>Value</b> data field, type <tt>0</tt>.</li>
	<li>Click <b>OK</b> to save changes and exit.</li>
	<li>Close the <b>Registry Editor</b>.</li>
</ol>


<h1><a name="HowtoConfigureMulticast-ConfiguringMulticastScopeTimeToLive%28TTL%29Value"></a>Configuring Multicast Scope Time-To-Live (TTL) Value</h1>
<p>The <b><a href="http://en.wikipedia.org/wiki/Time_to_live">multicast Time-To-Live (TTL)</a></b> value specifies the number of routers (hops) that multicast traffic is permitted to pass through before expiring on the network. For each router (hop), the original specified TTL is decremented by one (1). When its TTL reaches a value of zero (0), each multicast datagram expires and is no longer forwarded through the network to other subnets.
<br clear="all" />
The problem of multicasts/broadcasts not passing the router/switch is a well known issue - most routers (Cisco, 3Com, etc) have multicast forwarding disabled by default - otherwise the networks will be flooded with packets coming from very distant locations. To get it delivered all over the globe takes below 30 hops, so TTL 20 means delivery to more than half of it. It is very common that network experts in large networks hate the flooding problem caused by multicasts/broadcasts sent with the large TTL, and block it.
<br clear="all" /></p>
<h1><a name="HowtoConfigureMulticast-PacketSniffer%2FNetworkAnalyzerTool"></a>Packet Sniffer/Network Analyzer Tool</h1>
<p><a href="http://www.wireshark.org/">Wireshark (formerly Ethereal)</a> - accumulates years of network analyzing experience and is far more mature and known than other tools. It is a cross-platform packet sniffer/network analyzer tool (used both in Windows and Unix/Linux). It allows you to examine data from a live network, or from a capture file on disk. You can interactively browse the capture data, viewing summary and detail information for each packet. It has several powerful features, including a rich display filter language and the ability to view the reconstructed stream of a TCP session.
<br clear="all" />
<img class="emoticon" src="images/icons/emoticons/information.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> <b>To find TTL</b>, you should monitor some traffic (start-stop on the proper interface), in the monitoring log. Choose the packet you are interested in, and look at its IP layer - TTL (and other parameters) are shown.
<br clear="all" />
<img class="emoticon" src="images/icons/emoticons/information.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> Since XAP 6.5, the <b>default TTL value is 3</b> (was 15). See <a href="Lookup Service Configuration.html#LookupServiceConfiguration-LookupServiceConfigurationMulticastSettings">Multicast Settings</a> section for details of how to modify that value.</p>










                     </td>
</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td height="12" background="http://www.gigaspaces.com/wiki/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
</tr>
<tr>
<td align="center"><font color="grey"><a href="http://www.gigaspaces.com">GigaSpaces.com</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xwBmAg" class="smalltext">Legal Notice</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xgBmAg" class="smalltext">3rd Party Licenses</a> -
		<a href="http://www.gigaspaces.com/wiki/x/BQFmAg" class="smalltext">Site Map</a> -
		<a href="http://www.gigaspaces.com/wiki/display/API/API+Documentation+Portal" class="version-link">API Docs</a> -
		<a href="http://forum.openspaces.org/forum.jspa?forumID=175" class="version-link">Forum</a> -
		<a href="http://www.gigaspaces.com/LatestProductVersion" class="version-link">Downloads</a> -
		<a href="http://blog.gigaspaces.com/" class="version-link">Blog</a> -
		<a href="http://www.gigaspaces.com/os_papers.html" class="version-link">White Papers</a> -
		<a href="mailto:techw@gigaspaces.com">Contact Tech Writing</a> -
		<i><a href="http://www.atlassian.com/software/confluence">Gen. by Atlassian Confluence</a></i></font></td>
</tr>
</table>
     </body>
</html>
