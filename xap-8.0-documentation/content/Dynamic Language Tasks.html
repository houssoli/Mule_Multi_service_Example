<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
     <head>
         <title>XAP 8.0 Documentation : Dynamic Language Tasks</title>
<link rel="stylesheet" href="styles/site.css" type="text/css" />
         <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
		 <style>
.back-to {
	color: #666666;
	font-weight: bold;
}	 
a.back-to:link, a.back-to:visited, a.back-to:hover, a.back-to:active  {
	color: #666666;
}	 
		 </style>
     </head>

     <body>
<table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
<tr>
<td valign="top" class="pagebody">
<div class="pageheader">
<span class="back-to">XAP 8.0 Documentation > <a href="index.html">Back to Table of Contents</a></span><br>
<h1>Dynamic Language Tasks</h1>
</div>
<br>

<script type='text/javascript'>//<![CDATA[
function debug() { }
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/browser.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/behaviour.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/memory.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/cloak.js'>//<![CDATA[
// ]]></script><script type='text/javascript'>//<![CDATA[
Cloak.closeHTML = "<img src=\'/wiki/download/resources/net.customware.confluence.plugin.composition:toggle-cloak/img/navigate_down_10.gif\'/>";
Cloak.openHTML = "<img src=\'/wiki/download/resources/net.customware.confluence.plugin.composition:toggle-cloak/img/navigate_right_10.gif\'/>";
Cloak.toggleZone = true;
Cloak.memoryDuration = 0;
Cloak.memoryPrefix = "contentId:53903400";
Cloak.memoryPath = "/wiki/";
// ]]></script><style type='text/css'>
.cloakToggle { /* Definition for state toggling image */
cursor:hand;
cursor:pointer;
}
</style><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/transitions.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/deck.js'>//<![CDATA[
// ]]></script><link rel='stylesheet' type='text/css'  href='/wiki/styles/main-action.css?pluginCompleteKey=net.customware.confluence.plugin.composition:composition-setup&stylesheetName=deck&spaceKey=XAP8'/><script type='text/javascript'>//<![CDATA[
Deck.memoryDuration = 0;
Deck.memoryPrefix = "contentId:53903400";
Deck.memoryPath = "/wiki/";
// ]]></script>


<div style="border-style:solid; border-color:#3C78B5; border-width:thin; padding-left:20px; padding-bottom:20px; padding-top:20px; padding-right:20px; background-color:#D8E4F1"> 

<p><b>Section Summary:</b>  GigaSpaces supports the execution of tasks using scripting languages like JavaScipt and Groovy. These can be defined dynamically using the JDK 1.6 dynamic languages support. The dynamic language support is based on the <a href="Task Execution over the Space.html" title="Task Execution over the Space">ordinary task executors</a> and OpenSpaces <a href="Space Based Remoting.html" title="Space Based Remoting">remoting support</a>. </p>
</div>

<h1><a name="DynamicLanguageTasks-Overview"></a>Overview</h1>

<p><a href="Event Driven Remoting.html" title="Event Driven Remoting">Event Driven Remoting</a> and <a href="Executor Based Remoting.html" title="Executor Based Remoting">Executor Based Remoting</a> allow you to simply expose and execute custom services using the Space as the transport layer. The dynamic tasks feature (also known as "scripting support") allows you to utilize a built remote service, exposed using these two remoting mechanisms, that can execute dynamic language scripts in the space. <br/>
A major benefit of using scripting or dynamic languages is the ability to simply change the behavior of the executed task without the need to recompile your application. As per the SBA paradigm, dynamic language scripts can be executed collocated with the Space, allowing you to execute the task as close as possible to the data it needs to access, and then return a result.</p>

<p>The following section goes through the steps needed in order to execute dynamic language tasks. The other sections in this page dive more deeply into different dynamic language support features.</p>

<p>The first step in using scripting is exposing the built in scripting service over the Space. Here is a simple example:</p>


<div class="panel" style="background-color: #FFFFFF;border-color: #3C78B5;border-style: solid;border-width: 1px;"><div class="panelContent" style="background-color: #FFFFFF;">
<h5><a name="DynamicLanguageTasks-Namespace"></a>Namespace</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag"><span class="code-comment">&lt;!-- The scripting built in service executor --&gt;</span></span>
<span class="code-tag">&lt;bean id=<span class="code-quote">"scriptingExecutor"</span> class=<span class="code-quote">"org.openspaces.remoting.scripting.DefaultScriptingExecutor"</span> /&gt;</span>

<span class="code-tag"><span class="code-comment">&lt;!-- The service exporter exposing the scripting service --&gt;</span></span>
<span class="code-tag">&lt;os-remoting:service-exporter id=<span class="code-quote">"serviceExporter"</span>&gt;</span>
     <span class="code-tag">&lt;os-remoting:service ref=<span class="code-quote">"scriptingExecutor"</span>/&gt;</span>
<span class="code-tag">&lt;/os-remoting:service-exporter&gt;</span>

<span class="code-tag">&lt;os-core:space id=<span class="code-quote">"space"</span> url=<span class="code-quote">"/./space"</span> /&gt;</span>

<span class="code-tag">&lt;os-core:giga-space id=<span class="code-quote">"gigaSpace"</span> space=<span class="code-quote">"space"</span>/&gt;</span>

<span class="code-tag"><span class="code-comment">&lt;!-- Polling container exposing the service exporter as async remoting --&gt;</span></span>
<span class="code-tag">&lt;os-events:polling-container id=<span class="code-quote">"eventContainer"</span> giga-space=<span class="code-quote">"gigaSpace"</span>&gt;</span>    
    <span class="code-tag">&lt;os-events:listener ref=<span class="code-quote">"serviceExporter"</span>&gt;</span>    
<span class="code-tag">&lt;/os-events:polling-container&gt;</span></pre>
</div></div> 


<h5><a name="DynamicLanguageTasks-PlainXML"></a>Plain XML</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag"><span class="code-comment">&lt;!-- The scripting built in service executor --&gt;</span></span>
<span class="code-tag">&lt;bean id=<span class="code-quote">"scriptingExecutor"</span> class=<span class="code-quote">"org.openspaces.remoting.scripting.DefaultScriptingExecutor"</span> /&gt;</span>

<span class="code-tag"><span class="code-comment">&lt;!-- The service exporter exposing the scripting service --&gt;</span></span>
<span class="code-tag">&lt;bean id=<span class="code-quote">"serviceExporter"</span> class=<span class="code-quote">"org.openspaces.remoting.SpaceRemotingServiceExporter"</span>&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"services"</span>&gt;</span>
        <span class="code-tag">&lt;list&gt;</span>
            <span class="code-tag">&lt;ref bean=<span class="code-quote">"scriptingExecutor"</span> /&gt;</span>
        <span class="code-tag">&lt;/list&gt;</span>
    <span class="code-tag">&lt;/property&gt;</span>
<span class="code-tag">&lt;/bean&gt;</span>

<span class="code-tag">&lt;bean id=<span class="code-quote">"space"</span> class=<span class="code-quote">"org.openspaces.core.space.UrlSpaceFactoryBean"</span>&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"url"</span> value=<span class="code-quote">"/./space"</span> /&gt;</span>
<span class="code-tag">&lt;/bean&gt;</span>

<span class="code-tag">&lt;bean id=<span class="code-quote">"gigaSpace"</span> class=<span class="code-quote">"org.openspaces.core.GigaSpaceFactoryBean"</span>&gt;</span>
	<span class="code-tag">&lt;property name=<span class="code-quote">"space"</span> ref=<span class="code-quote">"space"</span> /&gt;</span>
<span class="code-tag">&lt;/bean&gt;</span>

<span class="code-tag"><span class="code-comment">&lt;!-- Polling container exposing the service exporter as async remoting --&gt;</span></span>
<span class="code-tag">&lt;bean id=<span class="code-quote">"eventContainer"</span> class=<span class="code-quote">"org.openspaces.events.polling.SimplePollingEventListenerContainer"</span>&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"eventListener"</span> ref=<span class="code-quote">"serviceExporter"</span>&gt;</span>
<span class="code-tag">&lt;/bean&gt;</span></pre>
</div></div>
</div></div>

<p>The next simple step is using the exposed scripting service on the client side, here is a groovy example (for more complete client side configuration instructions refer to the <a href="http://www.gigaspaces.com/wiki/display/XAP8/Open+Spaces+Remoting+Component+-+Scripting#OpenSpacesRemotingComponent-Scripting-ScriptingontheClientSide">Scripting on the Client Side section</a> below):</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java"><span class="code-keyword">public</span> class MyRemoting {

    @EventDrivenScriptingExecutor
    <span class="code-keyword">private</span> ScriptingExecutor asyncScriptingExecutor;

    @ExecutorScriptingExecutor
    <span class="code-keyword">private</span> ScriptingExecutor execScriptingExecutor;

    <span class="code-keyword">public</span> void doSomeScripting() {
        asyncScriptingExecutor.execute(<span class="code-keyword">new</span> StaticScript(<span class="code-quote">"myScriptAsync"</span>, <span class="code-quote">"groovy"</span>, 
                                                                <span class="code-quote">"println 'Async Hello Groovy'"</span>));
        
        execScriptingExecutor.execute(<span class="code-keyword">new</span> StaticScript(<span class="code-quote">"myScriptExec"</span>, <span class="code-quote">"groovy"</span>, 
                                                               <span class="code-quote">"println 'Sync Hello Groovy'"</span>));
    }
}</pre>
</div></div>

<p>On the client side Spring XML configuration, the following needs to be defined (mainly to define the connection to the Space as the transport layer, and define the scripting annotation processor):</p>


<div class="panel" style="background-color: #FFFFFF;border-color: #3C78B5;border-style: solid;border-width: 1px;"><div class="panelContent" style="background-color: #FFFFFF;">
<h5><a name="DynamicLanguageTasks-Namespace"></a>Namespace</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag">&lt;os-core:space id=<span class="code-quote">"space"</span> url=<span class="code-quote">"jini://*/*/space"</span> /&gt;</span>

<span class="code-tag">&lt;os-core:giga-space id=<span class="code-quote">"gigaSpace"</span> space=<span class="code-quote">"space"</span>/&gt;</span>

<span class="code-tag">&lt;os-remoting:annotation-support /&gt;</span>

<span class="code-tag">&lt;bean id=<span class="code-quote">"myRemoting"</span> class=<span class="code-quote">"MyRemoting"</span> /&gt;</span></pre>
</div></div> 


<h5><a name="DynamicLanguageTasks-PlainXML"></a>Plain XML</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag">&lt;bean id=<span class="code-quote">"space"</span> class=<span class="code-quote">"org.openspaces.core.space.UrlSpaceFactoryBean"</span>&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"url"</span> value=<span class="code-quote">"jini://*/*/space"</span> /&gt;</span>
<span class="code-tag">&lt;/bean&gt;</span>

<span class="code-tag">&lt;bean id=<span class="code-quote">"gigaSpace"</span> class=<span class="code-quote">"org.openspaces.core.GigaSpaceFactoryBean"</span>&gt;</span>
	<span class="code-tag">&lt;property name=<span class="code-quote">"space"</span> ref=<span class="code-quote">"space"</span> /&gt;</span>
<span class="code-tag">&lt;/bean&gt;</span>

<span class="code-tag">&lt;bean id=<span class="code-quote">"remotingAnnotationSupport"</span> class=<span class="code-quote">"org.openspaces.remoting.RemotingAnnotationBeanPostProcessor"</span> /&gt;</span>

<span class="code-tag">&lt;bean id=<span class="code-quote">"myRemoting"</span> class=<span class="code-quote">"MyRemoting"</span> /&gt;</span></pre>
</div></div>
</div></div>

<h1><a name="DynamicLanguageTasks-WhatisaScript"></a>What is a Script</h1>

<p><tt>Script</tt> is a simple interface that is defined within the OpenSpaces scripting over remoting support. It has the following basic methods:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java"><span class="code-keyword">public</span> <span class="code-keyword">interface</span> Script <span class="code-keyword">extends</span> BroadcastIndicator {

    /**
     * The name of the script. Should uniquely identify scripts.
     */
    <span class="code-object">String</span> getName();

    /**
     * The type of the script (or actually, language). For example, &lt;code&gt;groovy&lt;/code&gt; or &lt;code&gt;ruby&lt;/code&gt;.
     */
    <span class="code-object">String</span> getType();

    /**
     * The script source as a string.
     */
    <span class="code-object">String</span> getScriptAsString();

    /**
     * One or more parameters that will be passed to the script.
     */
    Map&lt;<span class="code-object">String</span>, <span class="code-object">Object</span>&gt; getParameters();

    /**
     * The routing index <span class="code-keyword">for</span> the script. Can be &lt;code&gt;<span class="code-keyword">null</span>&lt;/code&gt;. Defaults
     * to a random routing.
     */
    <span class="code-object">Object</span> getRouting();

    /**
     * Should <span class="code-keyword">this</span> script be cached or not. Defaults to &lt;code&gt;<span class="code-keyword">true</span>&lt;/code&gt;.
     */
    <span class="code-object">boolean</span> shouldCache();

    /**
     * Returns a set of meta arguments that are used <span class="code-keyword">for</span> remote invocation.
     *
     * @see org.openspaces.remoting.SpaceRemotingInvocation#getMetaArguments()  
     */
    <span class="code-object">Object</span>[] getMetaArguments();
}</pre>
</div></div>

<p>There are several implementations of this class which is covered more in the client section. OpenSpaces comes with three different implementations of the <tt>Script</tt> interface, they are: </p>

<ul>
	<li><tt>StaticScript</tt>: A script that holds the actual script as a string. The name, type, and script must be provided.</li>
	<li><tt>StaticResourceScript</tt>: A static script that uses Spring <tt>Resource</tt> and <tt>ResourceLoader</tt> to load a given script (for example, from the classpath).</li>
	<li><tt>ResourceLazyLoadingScript</tt>: A lazy loading script that uses Spring abstraction on top of a resource. The script resource location uses Spring notations for location (similar to a URL, with the addition of the <tt>classpath:</tt> prefix).</li>
</ul>


<h1><a name="DynamicLanguageTasks-ExposingJavaScriptScriptingService"></a>Exposing JavaScript Scripting Service</h1>

<p>OpenSpaces scripting over remoting support has a built in service that allows to expose the execution of scripting code. The service is implemented using the <tt>DefaultScriptingExecutor</tt> class. The executor supports several scripting languages out of the box, allows to cache compiled scripts, and automatically expose common beans as script parameters.</p>

<h2><a name="DynamicLanguageTasks-LocalScriptExecutor"></a>Local Script Executor</h2>

<p>The <tt>DefaultScriptingExecutor</tt> holds one or more <tt>LocalScriptExecutor</tt>. A <tt>LocalScriptExecutor</tt> implementation is an abstraction on top of an actual scripting language (such as groovy or jruby). OpenSpaces scripting support comes with built in local executors for groovy, jruby, and Java 6 <tt>ScriptEngine</tt> abstraction.</p>

<p>By default, the default scripting executor identifies if groovy, jruby, or Java 6 scripting support exist within the classpath, and automatically registers then as possible local executors. The relevant local executors are <tt>GroovyLocalScriptExecutor</tt> for groovy, <tt>JRubyLocalScriptExecutor</tt> for jruby, and <tt>Jsr223LocalScriptExecutor</tt> for Java 6. The local scripting executor is chosen based on the <tt>Script#getType()</tt>.</p>

<p>The Java 6 local script executor is a special case as in-itself it allows to execute several scripting engines types. The <tt>DefaultScriptingExecutor</tt> handles that by trying to offload the execution of an unidentified type to the <tt>Jsr223LocalScriptExecutor</tt>. Unidentified type is one that has no specific <tt>LocalScriptExecutor</tt> configured for it within the <tt>DefaultScriptingExecutor</tt>. This means that if one wishes to execute a JavaScript script that comes built in with Java 6, the type for the script should be <tt>JavaScript</tt> (and not Jsr223).</p>

<h2><a name="DynamicLanguageTasks-ScriptExecutionParameters"></a>Script Execution Parameters</h2>

<p>The <tt>Script</tt> interface allows to define specific parameters per script. The <tt>DefaultScriptingExecutor</tt> can be configured with a set of parameters that is passed to each script execution. A <tt>setParameters</tt> that accepts a Map can be passed to each script.</p>

<p>By default, the <tt>DefaultScriptingExecutor</tt> passes beans of type <tt>GigaSpace</tt>, keyed by their bean id. The Spring <tt>ApplicationContext</tt> is passed to the script under the <tt>applicationContext</tt> key, and the <tt>ClusterInfo</tt> object is passed under the <tt>clusterInfo</tt> key.</p>

<p>As an example, if my server side Spring application context has a <tt>GigaSpace</tt> bean with id of <tt>myGigaSpace</tt>, a simple groovy script to use it (without configuring anything within the default executor) can be: <tt>myGigaSpace.write(new Object())</tt>. Note, we use the id of the bean to access the <tt>GigaSpace</tt> and write a new Object.</p>

<p><img class="emoticon" src="images/icons/emoticons/information.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> A quick note regarding usage of <tt>GigaSpace</tt> beans. The clustered flag plays an important role when using it. This basically allows to control if the script execution of <tt>GigaSpace</tt> operations works only against its clustered member space, or against the whole cluster.</p>

<h2><a name="DynamicLanguageTasks-ScriptCompilationCaching"></a>Script Compilation Caching</h2>

<p>If a scripting engine support compilation of scripting, the <tt>DefaultScriptingExecutor</tt> allows caching of compiled scripts for faster execution. The actual caching of scripts is abstracted using <tt>CompiledScriptCache</tt> interface, and has default LRU type cache built in.</p>

<p>The compilation is done based on a flag on the <tt>Script</tt> interface (which defaults to true), and if cached, the "key" of the cache is the script name. This means that if a script was changed, it needs to be executed with a different script name in order for it to recompile and take affect.</p>

<h1><a name="DynamicLanguageTasks-ScriptingontheClientSide"></a>Scripting on the Client Side</h1>

<p>Using scripting on the client side is very similar to how similar remoting services are used. There are two types of proxies, <tt>executor-proxy</tt> and <tt>event-driven-proxy</tt>, and there are specific scripting annotations that allow to simplify the injection of scripting proxies.</p>

<p>Here is the xml definition of an async scripting proxy (the sync proxy is exactly the same except for the tag/class name of the proxy):</p>


<div class="panel" style="background-color: #FFFFFF;border-color: #3C78B5;border-style: solid;border-width: 1px;"><div class="panelContent" style="background-color: #FFFFFF;">
<h5><a name="DynamicLanguageTasks-Namespace"></a>Namespace</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml">&lt;os-remoting:event-driven-proxy id=<span class="code-quote">"eventDrivenScriptingExecutor"</span> giga-space=<span class="code-quote">"gigaSpace"</span>
                         interface=<span class="code-quote">"org.openspaces.remoting.scripting.ScriptingExecutor"</span>&gt;
    <span class="code-tag">&lt;os-remoting:aspect&gt;</span>
        <span class="code-tag">&lt;bean class=<span class="code-quote">"org.openspaces.remoting.scripting.LazyLoadingRemoteInvocationAspect"</span> /&gt;</span>
    <span class="code-tag">&lt;/os-remoting:aspect&gt;</span>
    <span class="code-tag">&lt;os-remoting:routing-handler&gt;</span>
        <span class="code-tag">&lt;bean class=<span class="code-quote">"org.openspaces.remoting.scripting.ScriptingRemoteRoutingHandler"</span> /&gt;</span>
    <span class="code-tag">&lt;/os-remoting:routing-handler&gt;</span>
    <span class="code-tag">&lt;os-remoting:meta-arguments-handler&gt;</span>
        <span class="code-tag">&lt;bean class=<span class="code-quote">"org.openspaces.remoting.scripting.ScriptingMetaArgumentsHandler"</span> /&gt;</span>
    <span class="code-tag">&lt;/os-remoting:meta-arguments-handler&gt;</span>
<span class="code-tag">&lt;/os-remoting:event-driven-proxy&gt;</span></pre>
</div></div> 


<h5><a name="DynamicLanguageTasks-PlainXML"></a>Plain XML</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag">&lt;bean id=<span class="code-quote">"eventDrivenScriptingExecutor"</span> class=<span class="code-quote">"org.openspaces.remoting.EventDrivenSpaceRemotingProxyFactoryBean"</span>&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"gigaSpace"</span> ref=<span class="code-quote">"gigaSpace"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"serviceInterface"</span> value=<span class="code-quote">"org.openspaces.remoting.scripting.ScriptingExecutor"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"remoteInvocationAspect"</span>&gt;</span>
        <span class="code-tag">&lt;bean class=<span class="code-quote">"org.openspaces.remoting.scripting.LazyLoadingRemoteInvocationAspect"</span> /&gt;</span>
    <span class="code-tag">&lt;/property&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"remoteRoutingHandler"</span>&gt;</span>
        <span class="code-tag">&lt;bean class=<span class="code-quote">"org.openspaces.remoting.scripting.ScriptingRemoteRoutingHandler"</span> /&gt;</span>
    <span class="code-tag">&lt;/property&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"metaArgumentsHandler"</span>&gt;</span>
        <span class="code-tag">&lt;bean class=<span class="code-quote">"org.openspaces.remoting.scripting.ScriptingMetaArgumentsHandler"</span> /&gt;</span>
    <span class="code-tag">&lt;/property&gt;</span>
<span class="code-tag">&lt;/bean&gt;</span></pre>
</div></div> 


<h5><a name="DynamicLanguageTasks-Code"></a>Code</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<p>Asynchronous scripting executor: </p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">IPojoSpace space = <span class="code-keyword">new</span> UrlSpaceConfigurer(<span class="code-quote">"jini:<span class="code-comment">//*/*/mySpace"</span>)
</span>                   .space();
GigaSpace gigaSpace = <span class="code-keyword">new</span> GigaSpaceConfigurer(space).gigaSpace();
ScriptingExecutor  executor = <span class="code-keyword">new</span> EventDrivenScriptingProxyConfigurer (gigaSpace)
                              .scriptingExecutor();</pre>
</div></div>
<p>Executor based scripting executor: </p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">IPojoSpace space = <span class="code-keyword">new</span> UrlSpaceConfigurer(<span class="code-quote">"jini:<span class="code-comment">//*/*/mySpace"</span>)
</span>                   .space();
GigaSpace gigaSpace = <span class="code-keyword">new</span> GigaSpaceConfigurer(space).gigaSpace();
ScriptingExecutor  executor = <span class="code-keyword">new</span> ExecutorScriptingProxyConfigurer (gigaSpace)
                              .scriptingExecutor();</pre>
</div></div>
</div></div>

<p>The different components implemented by scripting basically enables all the different scripting client side features which we will cover in the next sections. The annotation based injection is a much simplified way to use scripting on the client side and is shown in the Overview section.</p>

<h2><a name="DynamicLanguageTasks-RoutingIndex"></a>Routing Index</h2>

<p>The <tt>Script</tt> interface allows to set a routing index which controls, both in async and sync mode (not in broadcast mode), where the execution of the script is directed. Here is a simple example of it:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">asyncScriptingExecutor.execute(<span class="code-keyword">new</span> StaticScript(<span class="code-quote">"myScript"</span>, <span class="code-quote">"groovy"</span>, 
                                                        <span class="code-quote">"println 'Hello Groovy'"</span>).routing(1));</pre>
</div></div>

<p>This causes the routing to go the the second member (assuming hash based routing is configured). Naturally, most often a business level routing will be used, for example, direct a script that executed on a certain share to a partition based on the share symbol.</p>

<h2><a name="DynamicLanguageTasks-LazyLoadingofScripts"></a>Lazy Loading of Scripts</h2>

<p>The <tt>StaticResourceScript</tt> holds the actual script contents and it gets passed for each execution of the script. If script supports caching, there is no need to pass the actual contents of the script on each execution, since once the script was compiled, only its parameters and other values are required, not the actual script. The <tt>LazyLoadingRemoteInvocationAspect</tt> aspect (on the client side) with the <tt>ResourceLazyLoadingScript</tt> script type allow for such behavior. As an example:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">asyncScriptingExecutor.execute(<span class="code-keyword">new</span> ResourceLazyLoadingScript(<span class="code-quote">"test4"</span>, <span class="code-quote">"groovy"</span>, 
                                                             <span class="code-quote">"classpath:test.groovy"</span>).cache(<span class="code-keyword">true</span>));</pre>
</div></div>

<p>The above code only loads the <tt>test.groovy</tt> file if it is required on the server side. By default it is not sent, and if the server has not compiled it, it returns to the client and request the actual script content. The script is then loaded and sent again to the server. This logic is implemented by the <tt>LazyLoadingRemoteInvocationAspect</tt>.</p>

                     </td>
</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td height="12" background="http://www.gigaspaces.com/wiki/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
</tr>
<tr>
<td align="center"><font color="grey"><a href="http://www.gigaspaces.com">GigaSpaces.com</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xwBmAg" class="smalltext">Legal Notice</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xgBmAg" class="smalltext">3rd Party Licenses</a> -
		<a href="http://www.gigaspaces.com/wiki/x/BQFmAg" class="smalltext">Site Map</a> -
		<a href="http://www.gigaspaces.com/wiki/display/API/API+Documentation+Portal" class="version-link">API Docs</a> -
		<a href="http://forum.openspaces.org/forum.jspa?forumID=175" class="version-link">Forum</a> -
		<a href="http://www.gigaspaces.com/LatestProductVersion" class="version-link">Downloads</a> -
		<a href="http://blog.gigaspaces.com/" class="version-link">Blog</a> -
		<a href="http://www.gigaspaces.com/os_papers.html" class="version-link">White Papers</a> -
		<a href="mailto:techw@gigaspaces.com">Contact Tech Writing</a> -
		<i><a href="http://www.atlassian.com/software/confluence">Gen. by Atlassian Confluence</a></i></font></td>
</tr>
</table>
     </body>
</html>
