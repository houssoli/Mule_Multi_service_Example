<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
     <head>
         <title>XAP 8.0 Documentation : Modeling your data</title>
<link rel="stylesheet" href="styles/site.css" type="text/css" />
         <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
		 <style>
.back-to {
	color: #666666;
	font-weight: bold;
}	 
a.back-to:link, a.back-to:visited, a.back-to:hover, a.back-to:active  {
	color: #666666;
}	 
		 </style>
     </head>

     <body>
<table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
<tr>
<td valign="top" class="pagebody">
<div class="pageheader">
<span class="back-to">XAP 8.0 Documentation > <a href="index.html">Back to Table of Contents</a></span><br>
<h1>Modeling your data</h1>
</div>
<br>



<div style="border-style:solid; border-color:#3C78B5; border-width:thin; padding-left:20px; padding-bottom:20px; padding-top:20px; padding-right:20px; background-color:#D8E4F1"> 

<p><b>Section Summary:</b>  How to model application data for in-memory data grid </p>
</div>

<h1><a name="Modelingyourdata-MovingfromCentralizedtoDistributedDataModel"></a>Moving from Centralized to Distributed Data Model</h1>

<p>When moving from a centralized into a distributed data store, your data needs to be partitioned across multiple nodes (AKA partitions). Implementing the partitioning mechanism technically is not a hard task; however, planning the distribution of your data for scalability and performance, requires some thinking.</p>

<p>There are several questions which need to be answered when planning for data partitioning:<br/>
1. <b>What is the information I should store in memory?</b> The answer to this question is not a technical one, and should not be mistakenly confused with the structure of the data. This is in essence a business question: How much the data will it grow over time? For how long should you keep it? </p>

<p>We recommend using the following table for this process:</p>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>Data item</th>
<th class='confluenceTh'>Estimated Quantity</th>
<th class='confluenceTh'>Expected Growth</th>
<th class='confluenceTh'>Estimated Object Size</th>
</tr>
<tr>
<td class='confluenceTd'>Data Type A</td>
<td class='confluenceTd'>100K</td>
<td class='confluenceTd'>10%</td>
<td class='confluenceTd'>2K</td>
</tr>
<tr>
<td class='confluenceTd'>Data Type B</td>
<td class='confluenceTd'>200K</td>
<td class='confluenceTd'>20%</td>
<td class='confluenceTd'>4K</td>
</tr>
</tbody></table>

<p>Once you have identified the size and expected growth of your data, you can start thinking about partitioning it; however, there's more to consider before doing that.</p>

<p>2. <b>What are my application's use cases?</b> While you might be used to model your data by the logical relationship of your data items, in the case of distributed data, you need to think differently. The rule of thumb here is to avoid cross cluster relationships as much as possible, since they will lead to cross cluster queries and updates which are usually much less scalable and fast than their local counterparts.</p>

<p>Thinking in terms of traditional relationships ("one to one", "one to many" and "many to many"), is deceiving with distributed data. <br/>
The first question to ask is: How many different associations does each entity have?</p>

<p>If an entity is associated with several containers (parent entities), it can't be embedded within the containing entity. It might be also impossible to store it with all of its containers on the same partition.</p>

<p>Here's an example:<br/>
In the <a href="http://www.openspaces.org/display/DAE/GigaSpaces+PetClinic">Pet Clinic application</a> that is based on the <a href="http://static.springsource.org/docs/petclinic.html">Spring pet clinic sample</a>, a Pet is only associated with an Owner. We can therefore store each Pet with its owner on the same partition. We can even embed the Pet object within the physical Owner entry.<br/>
<img src="download/attachments/55935974/petclinic_class_model.gif" align="absmiddle" border="0"/><br/>
However, if a Pet would have been associated with a Vet as well, we could have certainly not embedded the Pet in the Vet physical entry (without duplicating each Pet entry) and could not even store the Pet and its Vet in the same partition.</p>

<p>We have mentioned the concept of embedded relationships above, let us now explain this concept's implications on your application.</p>

<h1><a name="Modelingyourdata-Embeddedvs.NonEmbeddedRelationships"></a>Embedded vs. Non Embedded Relationships</h1>

<p><b>Embedded Relationships</b> mean that one object physically contains the associated objects and there is a <b>strong</b> lifecycle dependency between them - once you delete the containing object, you also delete all of its contained objects. With this type of object association, you are always ensuring a local transaction since the entire object graph is stored in the same entry within the Space. </p>

<p><img src="download/attachments/48235229/model_embed.jpg" align="absmiddle" border="0"/></p>

<p><b>Non Embedded Relationships</b> mean that one object is associated with a number of other objects, so you can navigate from one object to another. However, there is no life cycle dependency between them, so if you delete the referencing object, you don't automatically delete the referenced object(s). The association is therefore manifested in storing IDs rather than storing the actual associated object itself. This type of relationship means that you don't duplicate data but you are more likely to use access more than one node in the cluster when querying or updating your data. </p>

<p><img src="download/attachments/48235229/model_non_embed.jpg" align="absmiddle" border="0"/></p>

<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>See the <a href="Parent Child Relationship.html" title="Parent Child Relationship">Parent Child Relationship</a> for an example for non-embedded relationships.</td></tr></table></div>

<h2><a name="Modelingyourdata-WhenShouldObjectsbeEmbedded%3F"></a>When Should Objects be Embedded?</h2>

<p>You already know it's not a good practice to embed related objects. But even when there's a good case for embedding related objects (sometimes at the cost of data duplications), you still should be aware of the following:</p>
<ul>
	<li>Embedding means no direct access: When an entity is embedded within another entity you cannot apply CRUD operations to it directly. Instead, you need to get its root parent entity from the space via regualr query and then navigate down the object graph, until you get the entity you need. This is not just a matter of convenience, it has also performance implications: whenever you want to perform CRUD operations on an embedded entity, you read the entire graph first and (if you need to also update it) you write the entire object graph back to the Space.</li>
	<li>On the other hand, with GigaSpaces non-embedded relationships mean you need to manage the relationship yourself, within your code.</li>
</ul>


<h2><a name="Modelingyourdata-ThumbRulesforChoosingEmbeddedRelationships"></a>Thumb Rules for Choosing Embedded Relationships</h2>
<ul>
	<li>Embed when an entity is meaningful only with the context of its containing object. For example, in the petclinic application - a Pet has a meaning only when it has an Owner. A Pet in itself is meaningless without an Owner in this specific application. There is no business scenario for transferring a Pet from owner to owner or admitting a Pet to a Vet without the owner.</li>
	<li>Embedding may sometimes mean duplicating your data. For example, if you want to reference a certain Visit from both the Pet and Vet class, you'll need to have duplicate Visit entries. So let's look into duplications:
	<ul>
		<li>Duplication means preferring scalability over footprint - the reason to duplicate is to avoid cluster wide transactions and in many cases it's the only way to partition your object in a scalable manner.</li>
		<li>Duplication means higher memory consumption: While memory is considered a commodity and low cost today, duplication has a bigger price to pay - you might have two space objects that contain the same data.</li>
		<li>Duplication means more lenient consistency. When you add a Visit to a Pet and Vet for example, you need to update them both. You can do it in one (potentially distributed) transaction, or in two separate transactions, which will scale better but be less consistent. This may be sufficient for many types of applications (e.g. social networks), where losing a post, although undesired, does not incur significant damage. In contrast, this is not feasible for financial applications where every operation should be accounted for.</li>
	</ul>
	</li>
</ul>


                     </td>
</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td height="12" background="http://www.gigaspaces.com/wiki/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
</tr>
<tr>
<td align="center"><font color="grey"><a href="http://www.gigaspaces.com">GigaSpaces.com</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xwBmAg" class="smalltext">Legal Notice</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xgBmAg" class="smalltext">3rd Party Licenses</a> -
		<a href="http://www.gigaspaces.com/wiki/x/BQFmAg" class="smalltext">Site Map</a> -
		<a href="http://www.gigaspaces.com/wiki/display/API/API+Documentation+Portal" class="version-link">API Docs</a> -
		<a href="http://forum.openspaces.org/forum.jspa?forumID=175" class="version-link">Forum</a> -
		<a href="http://www.gigaspaces.com/LatestProductVersion" class="version-link">Downloads</a> -
		<a href="http://blog.gigaspaces.com/" class="version-link">Blog</a> -
		<a href="http://www.gigaspaces.com/os_papers.html" class="version-link">White Papers</a> -
		<a href="mailto:techw@gigaspaces.com">Contact Tech Writing</a> -
		<i><a href="http://www.atlassian.com/software/confluence">Gen. by Atlassian Confluence</a></i></font></td>
</tr>
</table>
     </body>
</html>
