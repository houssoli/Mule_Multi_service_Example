<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
     <head>
         <title>XAP 8.0 Documentation : CPP API Hello World Example</title>
<link rel="stylesheet" href="styles/site.css" type="text/css" />
         <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
		 <style>
.back-to {
	color: #666666;
	font-weight: bold;
}	 
a.back-to:link, a.back-to:visited, a.back-to:hover, a.back-to:active  {
	color: #666666;
}	 
		 </style>
     </head>

     <body>
<table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
<tr>
<td valign="top" class="pagebody">
<div class="pageheader">
<span class="back-to">XAP 8.0 Documentation > <a href="index.html">Back to Table of Contents</a></span><br>
<h1>CPP API Hello World Example</h1>
</div>
<br>

<script type='text/javascript'>//<![CDATA[
function debug() { }
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/browser.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/behaviour.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/memory.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/cloak.js'>//<![CDATA[
// ]]></script><script type='text/javascript'>//<![CDATA[
Cloak.closeHTML = "<img src=\'/wiki/download/resources/net.customware.confluence.plugin.composition:toggle-cloak/img/navigate_down_10.gif\'/>";
Cloak.openHTML = "<img src=\'/wiki/download/resources/net.customware.confluence.plugin.composition:toggle-cloak/img/navigate_right_10.gif\'/>";
Cloak.toggleZone = true;
Cloak.memoryDuration = 0;
Cloak.memoryPrefix = "contentId:53903767";
Cloak.memoryPath = "/wiki/";
// ]]></script><style type='text/css'>
.cloakToggle { /* Definition for state toggling image */
cursor:hand;
cursor:pointer;
}
</style><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/transitions.js'>//<![CDATA[
// ]]></script><script type='text/javascript' src='/wiki/download/resources/net.customware.confluence.plugin.composition:composition-setup/js/deck.js'>//<![CDATA[
// ]]></script><link rel='stylesheet' type='text/css'  href='/wiki/styles/main-action.css?pluginCompleteKey=net.customware.confluence.plugin.composition:composition-setup&stylesheetName=deck&spaceKey=XAP8'/><script type='text/javascript'>//<![CDATA[
Deck.memoryDuration = 0;
Deck.memoryPrefix = "contentId:53903767";
Deck.memoryPath = "/wiki/";
// ]]></script>


<div style="border-style:solid; border-color:#3C78B5; border-width:thin; padding-left:20px; padding-bottom:20px; padding-top:20px; padding-right:20px; background-color:#D8E4F1"> 

<p><b>Section Summary:</b>  C++ environment setup and writing a Hello World C++ application. </p>
</div>

<h1><a name="CPPAPIHelloWorldExample-Overview"></a>Overview</h1>

<p>The example below demonstrates interaction between a sample application and a space. </p>

<p><img class="emoticon" src="images/icons/emoticons/lightbulb_on.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> The example source code can be found under: <tt>&lt;GigaSpaces Root&gt;\cpp\examples\HelloWorld</tt>.</p>

<p><img src="download/attachments/19890517/referto.gif" align="absmiddle" border="0"/> To learn about GigaSpaces C++ API, refer to the <a href="GigaSpaces CPP API.html" title="GigaSpaces CPP API">GigaSpaces C++ API</a> section.</p>

<h1><a name="CPPAPIHelloWorldExample-BuildingandRunningtheExample"></a>Building and Running the Example</h1>

<h2><a name="CPPAPIHelloWorldExample-Prerequisites"></a>Prerequisites</h2>

<h3><a name="CPPAPIHelloWorldExample-JAVAHOME"></a>JAVA_HOME</h3>

<p>The <tt>JAVA_HOME</tt> environment variable must be set to point to the appropriate JDK version.</p>

<p><img class="emoticon" src="images/icons/emoticons/warning.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> The JDK version must match the GigaSpaces version. GigaSpaces support JDK 1.5/1.6.</p>

<h3><a name="CPPAPIHelloWorldExample-GigaSpacesInstallation"></a>GigaSpaces Installation</h3>

<p>GigaSpaces needs to be installed in your local directory. Make sure that this version matches the JDK version installed on your machine.</p>

<p>To verify the JVM version, run the following command: <tt>&gt;java -version</tt></p>

<p><img src="download/attachments/19890517/referto.gif" align="absmiddle" border="0"/> For more details, refer to the <a href="Installing GigaSpaces.html" title="Installing GigaSpaces">Installing GigaSpaces</a> section.</p>

<h3><a name="CPPAPIHelloWorldExample-CAPIinstallation"></a>C++ API installation</h3>

<p><img src="download/attachments/19890517/referto.gif" align="absmiddle" border="0"/>  See the <a href="Installing CPP API Package.html" title="Installing CPP API Package">Installing CPP API Package</a> section.</p>

<h2><a name="CPPAPIHelloWorldExample-BuildingandRunning"></a>Building and Running</h2>

<p>You can build and run the application using the provided scripts or using the Visual Studio IDE.  </p>


<div class="panel" style="background-color: #FFFFFF;border-color: #3C78B5;border-style: solid;border-width: 1px;"><div class="panelContent" style="background-color: #FFFFFF;">
<h5><a name="CPPAPIHelloWorldExample-UsingScripts"></a>Using Scripts</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >

<p><img class="emoticon" src="images/icons/emoticons/information.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> <tt>&lt;Example Root&gt;</tt> below refers to the path: <tt>&lt;GigaSpaces Root&gt;\cpp\examples\HelloWorld</tt>. </p>

<ol>
	<li>Compile the example by running: <tt>&lt;Example Root&gt;\bin\compile.sh/bat</tt>. You should run this script from the <tt>&lt;Example Root&gt;\bin</tt> directory.</li>
	<li>Execute <tt>&lt;Example Root&gt;\bin\startAll.sh/bat</tt>. This starts a light version of the server with one space instance, and the Jini Lookup Service. <br clear="all" /> <br clear="all" /> <a name="CPPAPIHelloWorldExample-step2"></a>
<div class='panelMacro'><table class='infoMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>
<p>If you want to start an <b>embedded space</b>, there is no need to perform this step.</p>

<p>Open <tt>&lt;Example Root&gt;\bin\run_HelloWorld.bat/.sh</tt> in a text editor, and replace <tt>jini://</tt> with <tt>java://</tt>.</p>

<p>For example, in Windows:-</p>

<p>Replace:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>"%JSHOMEDIR%\cpp\bin\%PLATFORM%\%COMPILER%\HelloWorld" jini://localhost/*/mySpace?groups=%LOOKUPGROUPS%
</pre>
</div></div>
<p>with:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>"%JSHOMEDIR%\cpp\bin\%PLATFORM%\%COMPILER%\HelloWorld" java://localhost/./mySpace?groups=%LOOKUPGROUPS%
</pre>
</div></div>
<p>Changing the space URL protocol to Java causes the application to launch a space collocated in the same process, instead of connecting to a remote one.
<br clear="all" /> <br clear="all" />
Another way to activate the example with an embedded space is:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>"%JSHOMEDIR%\cpp\bin\%PLATFORM%\%COMPILER%\HelloWorld" /./mySpace?groups=%LOOKUPGROUPS%
</pre>
</div></div></td></tr></table></div></li>
	<li>If you want to view the space in the <a href="GigaSpaces Management Center.html" title="GigaSpaces Management Center">GigaSpaces Browser</a>, execute <tt>&lt;GigaSpaces Root&gt;\bin\gs-ui.sh/bat</tt>.</li>
	<li>To start the sample application, execute <tt>&lt;Example Root&gt;\bin\run_HelloWorld.sh/bat</tt>.</li>
	<li>This is what you should see: <br clear="all" /> <br clear="all" />
<div class="indent20 inline" style="margin-left: 20px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><p><img src="download/attachments/48235229/GigaSpacesCPP_BuildingandRunning_UsingScripts.jpg" align="absmiddle" border="0"/></p></div></li>
</ol>


<p>Here is an example for a linux makefile:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">CXXFLAGS = -fPIC -rdynamic -c -w -shared

OBJS = HelloWorldMessage.o

DEF = -DACE_AS_STATIC_LIBS -D__RENTRANT -DHAVE_CONFIG_H

LIBS = <span class="code-quote">"-L$(JSHOMEDIR)/cpp/lib/$(PLATFORM)/$(COMPILER)"</span> \
 <span class="code-quote">"-L$(JSHOMEDIR)/cpp/open-source/platform-libs/$(PLATFORM)/$(COMPILER)"</span> \
 <span class="code-quote">"-L$(JAVA_HOME)/jre/lib/amd64/server/"</span> \
 -lgscpplib -lACE -lxerces-c \
 -lpthread \
 -ldl \
 -lnsl
 

INCL = <span class="code-quote">"-I$(JSHOMEDIR)/cpp/include"</span>\
 <span class="code-quote">"-I$(JSHOMEDIR)/cpp/open-source/platform-includes/$(PLATFORM)"</span>\
 <span class="code-quote">"-I$(JSHOMEDIR)/cpp/open-source/platform-independant-includes"</span>\
 <span class="code-quote">"-I$(JSHOMEDIR)/cpp/examples/HelloWorld/serializer"</span>\
 
%.o:%.cpp
	$(CC) $(CXXFLAGS) $(INCL) -c $&lt; 

TARGET = <span class="code-quote">"$(JSHOMEDIR)/lib/ServiceGrid/<span class="code-keyword">native</span>/libHelloWorldMessage.so"</span>

$(TARGET):	$(OBJS)
	g++ -shared -Wl $(INCL) -o $(TARGET) $(OBJS) $(LIBS)

all: $(TARGET)

clean:
	rm -f $(OBJS) $(TARGET)</pre>
</div></div>

<div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Debugging in Linux</b><br />When debugging the code in Linux, you may receive the signal SIGSEGV (segmentation fault). It is recommended to instruct the debugger to ignore these signals ("<tt>handle SIGSEGV nostop noprint</tt>" in gdb, "<tt>ignore SIGSEGV</tt>" in most versions of dbx).</td></tr></table></div>
 

<h5><a name="CPPAPIHelloWorldExample-UsingVisualStudio"></a>Using Visual Studio</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >


<ol>
	<li>Start Visual Studio using the <tt>&lt;GigaSpaces Root&gt;\cpp\GigaVisualStudio.bat</tt> script.<br/>
<img class="emoticon" src="images/icons/emoticons/warning.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> You might need to edit this file (<tt>GigaVisualStudio.bat</tt>) and the file it calls (<tt>env.cmd</tt>) to include the correct values for the <tt>JAVA_HOME</tt> and <tt>JSHOMEDIR</tt> environment variables and the correct location of Visual Studio. <br clear="all" /> <br clear="all" /></li>
	<li>Once Visual Studio is started, open the examples solution <tt>&lt;GigaSpaces Root&gt;\cpp\examples\examples.sln</tt>: <br clear="all" /> <br clear="all" />
<div class="indent20 inline" style="margin-left: 20px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><p><img src="download/attachments/48235229/hello_CPP1.jpg" align="absmiddle" border="0"/></p></div> <br clear="all" /></li>
	<li>Make sure the Hello World project appears: <br clear="all" /> <br clear="all" />
<div class="indent20 inline" style="margin-left: 20px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><p><img src="download/attachments/48235229/hello_CPP2.jpg" align="absmiddle" border="0"/></p></div> <br clear="all" /></li>
	<li>Modify the Hello World project to have the following as the Command Arguments (<tt>java://localhost/./mySpace</tt>): <br clear="all" /> <br clear="all" />
<div class="indent20 inline" style="margin-left: 20px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><p><img src="download/attachments/48235229/hello_CPP3.jpg" align="absmiddle" border="0"/></p></div> <br clear="all" /></li>
	<li>Execute <tt>&lt;Example Root&gt;\bin\startAll.sh/bat</tt>. This starts a light version of the server with one space instance, and the Jini Lookup Service. <br clear="all" /> <br clear="all" />
<div class='panelMacro'><table class='infoMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td> If you want to start an <b>embedded space</b>, there is no need to perform the last 2 steps. Running the Hello World example without any Command Arguments automatically launches a space collocated in the same process.<br clear="all" /> <br clear="all" />
<div class="indent20 inline" style="margin-left: 20px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><p><img src="download/attachments/48235229/hello_CPP4.jpg" align="absmiddle" border="0"/></p></div> <br clear="all" /></td></tr></table></div> <br clear="all" /> <br clear="all" /></li>
	<li>Make sure that Hello World is the Startup Project: <br clear="all" /> <br clear="all" />
<div class="indent20 inline" style="margin-left: 20px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><p><img src="download/attachments/48235229/hello_CPP5.jpg" align="absmiddle" border="0"/></p></div> <br clear="all" /></li>
	<li>Make sure that Hello World is configured to run in the <tt>Release</tt> solution configuration mode. <br clear="all" /> <br clear="all" /></li>
	<li><b>Rebuild</b> the Hello World project. <br clear="all" /> <br clear="all" /></li>
	<li>Run the Hello World Application: <br clear="all" /> <br clear="all" />
<div class="indent20 inline" style="margin-left: 20px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><p><img src="download/attachments/48235229/hello_CPP6.jpg" align="absmiddle" border="0"/></p></div> <br clear="all" /></li>
	<li>This is what you should see: <br clear="all" /> <br clear="all" />
<div class="indent20 inline" style="margin-left: 20px;"><style type="text/css">div.inline p:first-child { display: inline; }</style><p><img src="download/attachments/48235229/hello_CPP7.jpg" align="absmiddle" border="0"/></p></div></li>
</ol>
</div></div>

<h2><a name="CPPAPIHelloWorldExample-EnvironmentSettings"></a>Environment Settings </h2>
<p>The above scripts and the Visual Studio solution define several environment settings that are necessary to build and run the example. This section lists these settings. Choose the tab below that matches your platform.   </p>


<div class="panel" style="background-color: #FFFFFF;border-color: #3C78B5;border-style: solid;border-width: 1px;"><div class="panelContent" style="background-color: #FFFFFF;">
<h5><a name="CPPAPIHelloWorldExample-Windows"></a>Windows</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >


<h2><a name="CPPAPIHelloWorldExample-EnvironmentVariables"></a>Environment Variables </h2>

<p>The following environment variables need to be defined:</p>
<ul>
	<li><b><tt>JSHOMEDIR</tt></b> &#8211; the <tt>&lt;GigaSpaces Root&gt;</tt> directory.</li>
	<li><b><tt>PLATFORM</tt></b> &#8211; the build platform, in this case win32 or win64.</li>
	<li><b><tt>COMPILER</tt></b> &#8211; the compiler used for building, for example: VS9.0.</li>
</ul>


<p>For example: </p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>set JSHOMEDIR=C:\gigaspaces-xap-8
set PLATFORM=win32
set COMPILER=VS9.0
</pre>
</div></div>

<p>In addition, the variable <b><tt>PATH</tt></b> should be updated to include:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>%JSHOMEDIR%\cpp\lib\%PLATFORM%\%COMPILER%;%JSHOMEDIR%\cpp\bin\%PLATFORM%\%COMPILER%;%JAVA_HOME%\jre\bin\client
</pre>
</div></div>

<p><img class="emoticon" src="images/icons/emoticons/lightbulb_on.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> You can also run the <tt>&lt;GigaSpaces Root&gt;\cpp\env.cmd</tt> file to define these variables to match your platform.  </p>

<h2><a name="CPPAPIHelloWorldExample-AdditionalIncludeDirectories"></a>Additional Include Directories </h2>

<p>(Properties window -&gt; Configuration Properties -&gt; C/C++ -&gt; General -&gt; Additional Include Directories) </p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>"$(JSHOMEDIR)\cpp\include";
"$(JSHOMEDIR)\cpp\open-source\platform-independant-includes";
"$(JSHOMEDIR)\cpp\open-source\platform-includes\$(PLATFORM)";
"$(JSHOMEDIR)\cpp\examples\helloWorld\serializer"
</pre>
</div></div>

<h2><a name="CPPAPIHelloWorldExample-AdditionalDependencies"></a>Additional Dependencies </h2>

<p>(Properties window -&gt; Configuration Properties -&gt; Linker -&gt; Input -&gt; Additional Dependencies) </p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>gscpplib.lib
</pre>
</div></div>


<h5><a name="CPPAPIHelloWorldExample-Linux"></a>Linux</h5>
<hr 
 size="1" 
 color="#3C78B5" 
 >


<h2><a name="CPPAPIHelloWorldExample-EnvironmentVariables"></a>Environment Variables </h2>

<p>The following environment variables need to be defined:</p>
<ul>
	<li><b><tt>JSHOMEDIR</tt></b> &#8211; the <tt>&lt;GigaSpaces Root&gt;</tt> directory.</li>
	<li><b><tt>PLATFORM</tt></b> &#8211; the build platform, in this case linux-amd64 or linux32.</li>
	<li><b><tt>COMPILER</tt></b> &#8211; the compiler used for building, for example: gcc-4.1.2.</li>
</ul>


<p>Example:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>JSHOMEDIR=../../..
PLATFORM=linux-amd64
COMPILER=gcc-4.1.2
</pre>
</div></div>

<p><img class="emoticon" src="images/icons/emoticons/lightbulb_on.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> You can also run the <tt>&lt;GigaSpaces Root&gt;\cpp\setenv.sh</tt> file to define these variables to match your platform.  </p>

<h2><a name="CPPAPIHelloWorldExample-AdditionalIncludePaths"></a>Additional Include Paths </h2>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>-I$(JSHOMEDIR)/cpp/include\
-I$(JSHOMEDIR)/cpp/open-source/platform-includes/$(PLATFORM)\
-I$(JSHOMEDIR)/cpp/open-source/platform-independant-includes\
-I$(JSHOMEDIR)/cpp/examples/HelloWorld\
-I$(JSHOMEDIR)/cpp/examples/HelloWorld/serializer\
</pre>
</div></div>

<h2><a name="CPPAPIHelloWorldExample-AdditionalLibraries"></a>Additional Libraries </h2>
<p>Paths:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>-L$(JSHOMEDIR)/cpp/lib/$(PLATFORM)/$(COMPILER) \
-L$(JSHOMEDIR)/cpp/open-source/platform-libs/$(PLATFORM)/$(COMPILER) \
-L$(JAVA_HOME)/jre/lib/amd64/server/
</pre>
</div></div>

<p><img class="emoticon" src="images/icons/emoticons/information.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> The last path might differ from the example above, depending on your Java installation. </p>

<p>Libraries:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">-lgscpplib -lACE -lxerces-c -ljvm</pre>
</div></div>
</div></div>

<h1><a name="CPPAPIHelloWorldExample-CodeWalkthrough"></a>Code Walkthrough</h1>

<div class="error"><span class="error">Error formatting macro: toc-zone: java.lang.NullPointerException</span> 

<p><img class="emoticon" src="images/icons/emoticons/warning.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> <tt>&lt;Example Root&gt;</tt> in the text below refers to <tt>&lt;GigaSpaces Root&gt;/cpp/examples/HelloWorld</tt>. </p>

<p>This application is a simple client that connects to a remote space, writes a data object into that space and then reads it back. We start by defining the properties of this data object which we refer to as a <tt>Message</tt>.    </p>

<h2><a name="CPPAPIHelloWorldExample-GeneratingMessageClassfromgs.xml"></a>Generating Message Class from gs.xml</h2>

<p>The <tt>Message</tt> class used in the example contains only three fields: <tt>id</tt> (int), <tt>uid</tt> (string) and <tt>content</tt> (string). The <tt>uid</tt> field is used as a primary key, the <tt>id</tt> field is used for routing in a partitioned space, and the <tt>content</tt> field contains the message text.     </p>

<p>The following XML code represents this <tt>Message</tt> object (located at <tt>&lt;Example Root&gt;\serializer\HelloWorld.gs.xml</tt>): </p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml"><span class="code-tag">&lt;?xml version=<span class="code-quote">"1.0"</span> encoding=<span class="code-quote">"UTF-8"</span>?&gt;</span>
<span class="code-tag">&lt;!DOCTYPE gigaspaces-mapping SYSTEM <span class="code-quote">"../../../config/cpp.dtd"</span>&gt;</span>
<span class="code-tag">&lt;gigaspaces-mapping&gt;</span>
  <span class="code-tag">&lt;class name=<span class="code-quote">"Message"</span> persist=<span class="code-quote">"false"</span> replicate=<span class="code-quote">"false"</span> fifo=<span class="code-quote">"false"</span> &gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"id"</span> type=<span class="code-quote">"int"</span> null-value=<span class="code-quote">"-999"</span> index=<span class="code-quote">"true"</span>/&gt;</span>
    <span class="code-tag">&lt;routing  name=<span class="code-quote">"id"</span>/&gt;</span>

    <span class="code-tag">&lt;property name=<span class="code-quote">"uid"</span> type=<span class="code-quote">"string"</span> null-value=<span class="code-quote">"" index="</span>true"/&gt;</span>
    <span class="code-tag">&lt;id name=<span class="code-quote">"uid"</span> auto-generate=<span class="code-quote">"true"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"content"</span> type=<span class="code-quote">"string"</span> null-value=<span class="code-quote">"" index="</span>false"/&gt;</span>
  <span class="code-tag">&lt;/class&gt;</span>
<span class="code-tag">&lt;/gigaspaces-mapping&gt;</span></pre>
</div></div>

<p><img class="emoticon" src="images/icons/emoticons/information.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> The <tt>id</tt> tag defines the <tt>uid</tt> field as the primary key, while the <tt>routing</tt> tag defines the <tt>id</tt> field used for routing. For more details, refer to the <a href="CPP API Mapping File.html" title="CPP API Mapping File">gs.xml reference</a> section.</p>

<p>This XML file is used by the <tt>gsxml2cpp</tt> command that produces the <tt>HelloWorldMessage.h</tt> and <tt>HelloworldMessage.cpp</tt> files. This is performed by the following command:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">gsxml2cpp ../serializer/helloWorld.gs.xml HelloWorld ../serializer/HelloWorldMessage.cpp ../serializer/HelloWorldMessage.h</pre>
</div></div>

<p><tt>HelloWorldMessage.h</tt> contains the class declaration and <tt>HelloworldMessage.cpp</tt> contains serialization code that shouldn't be edited. You can use an existing class instead of having it generated by <tt>gsxml2cpp</tt>. For more details, refer to the <a href="Writing Existing CPP Class to Space.html" title="Writing Existing CPP Class to Space">Writing Existing CPP Class to Space</a> section for more details. </p>

<p>A shared library (DLL or SO file) is created from <tt>HelloWorldMessage.h/cpp</tt> files. This shared library is copied into the <tt>&lt;Gigaspaces Root&gt;\lib\ServiceGrid\native</tt> directory, so that it can be loaded at runtime by the space.</p>

<p><img class="emoticon" src="images/icons/emoticons/warning.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> Each entry class name must be unique over GigaSpaces installation.</p>

<h2><a name="CPPAPIHelloWorldExample-ConnectingtoSpace"></a>Connecting to Space</h2>

<p>In order to connect to the remote space, we call the <tt>find()</tt> method (which is a member of <tt>OpenSpaces::SpaceFinder</tt>), and pass a space URL:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">SpaceProxyPtr space ( finder.find(spaceUrl) );</pre>
</div></div>

<p>(The above is copied from the file: <tt>&lt;Example Root&gt;\HelloWorld.cpp</tt>.)</p>

<p><img class="emoticon" src="images/icons/emoticons/warning.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> The space URL in this example is: <tt>jini://localhost/*/mySpace?groups=javaspaces-hellospace</tt>. It is passed to <tt>main</tt> in <tt>run_HelloWorld.sh/.bat)</tt> (see <a href="Space URL.html" title="Space URL">Space URL</a>).</p>

<p><img class="emoticon" src="images/icons/emoticons/information.gif" height="16" width="16" align="absmiddle" alt="" border="0"/> This space URL specifies the network address of the Jini Lookup Service (localhost here), and queries it for <b>a space belonging to the lookup group</b> <tt>javaspaces-hellospace</tt>. There is only one space in this lookup group: the space instance started by <tt>startAll.sh</tt>. The space is purposely started with a switch that registers it to this lookup group (see <a href="http://www.gigaspaces.com/docs/docs/quick_start/Using_the_Examples.htm">Using the Examples, Server Side section</a>).<br/>
The <b>asterisk after localhost</b> represents the space container (a logical unit inside the server); this URL does not refer to a specific container. Note that the protocol used is Jini (other protocols are RMI and Java. Java is used for embedded spaces and to launch spaces on the server side).</p>

<h2><a name="CPPAPIHelloWorldExample-RegisteringCClasstoSpace"></a>Registering C++ Class to Space</h2>

<p>The space must know about the data class that we declared previously. Thus, we need to register it to the space in the following way:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>Message messageTemplate;
space-&gt;snapshot(&amp;messageTemplate);
</pre>
</div></div> 

<h2><a name="CPPAPIHelloWorldExample-WritingObjecttoSpace"></a>Writing Object to Space</h2>

<p>The application constructs an object called <tt>msg</tt> and <b>writes it to the space</b> by passing it as the first argument in the <tt>SpaceProxy::write()</tt> method. The second argument refers to the transaction object &#8211; none in this example, the third defines the lease time.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">Message_ptr msg( <span class="code-keyword">new</span> Message() );
msg-&gt;id = 1;
msg-&gt;content = <span class="code-quote">"Hello World"</span>;
space-&gt;write(msg.get(), NULL_TX, 5000000);</pre>
</div></div>

<p>(The above is copied from the file: <tt>&lt;Example Root&gt;\HelloWorld.cpp</tt>.)</p>

<p>The <tt>msg</tt> object is of type <tt>Message</tt>. This is a class that satisfies the requirements of the space: it implements <tt>OpenSpaces::IEntry</tt>, has a default constructor, and a virtual function that returns the class space name.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">class Message: <span class="code-keyword">public</span> IEntry 
{
<span class="code-keyword">public</span>:
    Message() {
        content = "";
        id = -999;
        uid = "";
    }
    std::string			content;
    <span class="code-object">int</span>			id;
    std::string			uid;
    virtual <span class="code-keyword">const</span> <span class="code-object">char</span>* GetSpaceClassName() <span class="code-keyword">const</span>
    {
        <span class="code-keyword">return</span> <span class="code-quote">"Message"</span>;
    }

};</pre>
</div></div>

<p>(The above is copied from the file: <tt>&lt;Example Root&gt;\serializer\HelloWorldMessage.h</tt> &#8211; the header generated by <tt>gsxml2cpp</tt>.)</p>

<h2><a name="CPPAPIHelloWorldExample-CreatingTemplate"></a>Creating Template</h2>

<p>The application creates an object, referred to as a template. This object is essentially the filter criteria used to query the space for matching objects. The template must be of a registered type, in this case, an object of type <tt>Message</tt>. This template has all attributes as <tt>null</tt>, which tells the space to return an object of type <tt>Message</tt>, regardless of its attribute values (if there are multiple objects matching the template, the space returns one of them).</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">Message messageTemplate;</pre>
</div></div>
<p>(The above is copied from the file: <tt>&lt;Example Root&gt;\HelloWorld.cpp</tt>.)</p>

<p>If you want to perform more specific template matching, assign specific values to the template object's attributes.</p>

<p>If you set <tt>template.attribute1="value"</tt>, the space returns an object of this class for which <tt>attribute</tt> equals to the value. When using a regular template, you can perform equality queries with <tt>AND</tt> conditions. For bigger/less-than queries or ranges, or more complex queries using <tt>OR</tt> conditions; use the <tt>SQLQuery</tt> class.</p>

<p><img src="download/attachments/19890517/referto.gif" align="absmiddle" border="0"/> For more details on SQL queries, refer to the <a href="SQLQuery.html" title="SQLQuery">SQLQuery</a> section.</p>

<p>You can use the inheritance mechanism to match derived object-enabling queries in different level of abstraction.  </p>

<h2><a name="CPPAPIHelloWorldExample-PassingTemplatetoSpace"></a>Passing Template to Space</h2>

<p>The template is passed to the space in the first argument of the <tt>SpaceProxy::read()</tt> method. The second argument defines a transaction.</p>

<p>The third argument defines the wait time (block time) for read operations. This argument is set to <tt>0</tt>, meaning no wait. In this example, since we have written a matching object to the space prior the read operation, the application returns immediately with the desired object data, so the wait time is unimportant. But in real life, applications often read data that was supposed to be written or updated by other applications &#8211; in which case the block time represents the period during which the data is expected to enter the space. If the block time is long, the application might block for a long time, waiting for the object to appear.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">Message_ptr result ( space-&gt;read(&amp;messageTemplate, NULL_TX, 0) );</pre>
</div></div>

<p>(The above is copied from the file: <tt>&lt;Example Root&gt;\HelloWorld.cpp</tt>.)</p>

<h2><a name="CPPAPIHelloWorldExample-ReceivingReturnedMessageObject"></a>Receiving Returned Message Object</h2>

<p>In this example, the <tt>read()</tt> method returns the requested <tt>Message</tt> object (because it is written previously by the same application), and the application displays its content. If the object does not exist, the application returns immediately with a <tt>NULL</tt> value. </p>

<p>Alternatively, you can perform the read operation with a timeout. The application returns <tt>NULL</tt> in case a matching object has not been written to the space during the specified timeout.</p></div>

                     </td>
</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td height="12" background="http://www.gigaspaces.com/wiki/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
</tr>
<tr>
<td align="center"><font color="grey"><a href="http://www.gigaspaces.com">GigaSpaces.com</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xwBmAg" class="smalltext">Legal Notice</a> -
		<a href="http://www.gigaspaces.com/wiki/x/xgBmAg" class="smalltext">3rd Party Licenses</a> -
		<a href="http://www.gigaspaces.com/wiki/x/BQFmAg" class="smalltext">Site Map</a> -
		<a href="http://www.gigaspaces.com/wiki/display/API/API+Documentation+Portal" class="version-link">API Docs</a> -
		<a href="http://forum.openspaces.org/forum.jspa?forumID=175" class="version-link">Forum</a> -
		<a href="http://www.gigaspaces.com/LatestProductVersion" class="version-link">Downloads</a> -
		<a href="http://blog.gigaspaces.com/" class="version-link">Blog</a> -
		<a href="http://www.gigaspaces.com/os_papers.html" class="version-link">White Papers</a> -
		<a href="mailto:techw@gigaspaces.com">Contact Tech Writing</a> -
		<i><a href="http://www.atlassian.com/software/confluence">Gen. by Atlassian Confluence</a></i></font></td>
</tr>
</table>
     </body>
</html>
